import{d as qr,g as Gr,a as Qe}from"./index.EmWCQ-Q3.js";var et={exports:{}},ce={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kt;function Hr(){if(Kt)return ce;Kt=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,s,i){var o=null;if(i!==void 0&&(o=""+i),s.key!==void 0&&(o=""+s.key),"key"in s){i={};for(var u in s)u!=="key"&&(i[u]=s[u])}else i=s;return s=i.ref,{$$typeof:n,type:r,key:o,ref:s!==void 0?s:null,props:i}}return ce.Fragment=e,ce.jsx=t,ce.jsxs=t,ce}var Zt;function Jr(){return Zt||(Zt=1,et.exports=Hr()),et.exports}var pu=Jr(),ft=function(n,e){return ft=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},ft(n,e)};function M(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ft(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Nt=function(){return Nt=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Nt.apply(this,arguments)};function Yr(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function u(l){try{c(r.next(l))}catch(f){o(f)}}function a(l){try{c(r.throw(l))}catch(f){o(f)}}function c(l){l.done?i(l.value):s(l.value).then(u,a)}c((r=r.apply(n,e||[])).next())})}function qn(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=u(0),o.throw=u(1),o.return=u(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(c){return function(l){return a([c,l])}}function a(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,s=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){t.label=c[1];break}if(c[0]===6&&t.label<i[1]){t.label=i[1],i=c;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(c);break}i[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(l){c=[6,l],s=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function ne(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function U(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(u){o={error:u}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return i}function Y(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}function te(n){return this instanceof te?(this.v=n,this):new te(n)}function Xr(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(d){return function(p){return Promise.resolve(p).then(d,f)}}function u(d,p){r[d]&&(s[d]=function(g){return new Promise(function(y,m){i.push([d,g,y,m])>1||a(d,g)})},p&&(s[d]=p(s[d])))}function a(d,p){try{c(r[d](p))}catch(g){h(i[0][3],g)}}function c(d){d.value instanceof te?Promise.resolve(d.value.v).then(l,f):h(i[0][2],d)}function l(d){a("next",d)}function f(d){a("throw",d)}function h(d,p){d(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Kr(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ne=="function"?ne(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(o){return new Promise(function(u,a){o=n[i](o),s(u,a,o.done,o.value)})}}function s(i,o,u,a){Promise.resolve(a).then(function(c){i({value:c,done:u})},o)}}function w(n){return typeof n=="function"}function Gn(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var tt=Gn(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function Ve(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var pe=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,s,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var u=ne(o),a=u.next();!a.done;a=u.next()){var c=a.value;c.remove(this)}}catch(g){e={error:g}}finally{try{a&&!a.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else o.remove(this);var l=this.initialTeardown;if(w(l))try{l()}catch(g){i=g instanceof tt?g.errors:[g]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var h=ne(f),d=h.next();!d.done;d=h.next()){var p=d.value;try{Qt(p)}catch(g){i=i??[],g instanceof tt?i=Y(Y([],U(i)),U(g.errors)):i.push(g)}}}catch(g){r={error:g}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}}if(i)throw new tt(i)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Qt(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ve(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&Ve(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),Hn=pe.EMPTY;function Jn(n){return n instanceof pe||n&&"closed"in n&&w(n.remove)&&w(n.add)&&w(n.unsubscribe)}function Qt(n){w(n)?n():n.unsubscribe()}var Zr={Promise:void 0},Nr={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout.apply(void 0,Y([n,e],U(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function Yn(n){Nr.setTimeout(function(){throw n})}function ht(){}function De(n){n()}var At=function(n){M(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,Jn(t)&&t.add(r)):r.destination=ts,r}return e.create=function(t,r,s){return new fe(t,r,s)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(pe),Qr=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){Pe(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){Pe(r)}else Pe(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){Pe(t)}},n}(),fe=function(n){M(e,n);function e(t,r,s){var i=n.call(this)||this,o;return w(t)||!t?o={next:t??void 0,error:r??void 0,complete:s??void 0}:o=t,i.destination=new Qr(o),i}return e}(At);function Pe(n){Yn(n)}function es(n){throw n}var ts={closed:!0,next:ht,error:es,complete:ht},kt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Xn(n){return n}function gu(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Kn(n)}function Kn(n){return n.length===0?Xn:n.length===1?n[0]:function(t){return n.reduce(function(r,s){return s(r)},t)}}var T=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var s=this,i=rs(e)?e:new fe(e,t,r);return De(function(){var o=s,u=o.operator,a=o.source;i.add(u?u.call(i,a):a?s._subscribe(i):s._trySubscribe(i))}),i},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=en(t),new t(function(s,i){var o=new fe({next:function(u){try{e(u)}catch(a){i(a),o.unsubscribe()}},error:i,complete:s});r.subscribe(o)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[kt]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Kn(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=en(e),new e(function(r,s){var i;t.subscribe(function(o){return i=o},function(o){return s(o)},function(){return r(i)})})},n.create=function(e){return new n(e)},n}();function en(n){var e;return(e=n??Zr.Promise)!==null&&e!==void 0?e:Promise}function ns(n){return n&&w(n.next)&&w(n.error)&&w(n.complete)}function rs(n){return n&&n instanceof At||ns(n)&&Jn(n)}function ss(n){return w(n?.lift)}function z(n){return function(e){if(ss(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function X(n,e,t,r,s){return new is(n,e,t,r,s)}var is=function(n){M(e,n);function e(t,r,s,i,o,u){var a=n.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=u,a._next=r?function(c){try{r(c)}catch(l){t.error(l)}}:n.prototype._next,a._error=i?function(c){try{i(c)}catch(l){t.error(l)}finally{this.unsubscribe()}}:n.prototype._error,a._complete=s?function(){try{s()}catch(c){t.error(c)}finally{this.unsubscribe()}}:n.prototype._complete,a}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(At),os=Gn(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),It=function(n){M(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new tn(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new os},e.prototype.next=function(t){var r=this;De(function(){var s,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=ne(r.currentObservers),u=o.next();!u.done;u=o.next()){var a=u.value;a.next(t)}}catch(c){s={error:c}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}}})},e.prototype.error=function(t){var r=this;De(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var s=r.observers;s.length;)s.shift().error(t)}})},e.prototype.complete=function(){var t=this;De(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,s=this,i=s.hasError,o=s.isStopped,u=s.observers;return i||o?Hn:(this.currentObservers=null,u.push(t),new pe(function(){r.currentObservers=null,Ve(u,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,s=r.hasError,i=r.thrownError,o=r.isStopped;s?t.error(i):o&&t.complete()},e.prototype.asObservable=function(){var t=new T;return t.source=this,t},e.create=function(t,r){return new tn(t,r)},e}(T),tn=function(n){M(e,n);function e(t,r){var s=n.call(this)||this;return s.destination=t,s.source=r,s}return e.prototype.next=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,t)},e.prototype.error=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&s!==void 0?s:Hn},e}(It),Ot={now:function(){return(Ot.delegate||Date).now()},delegate:void 0},us=function(n){M(e,n);function e(t,r,s){t===void 0&&(t=1/0),r===void 0&&(r=1/0),s===void 0&&(s=Ot);var i=n.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=s,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return e.prototype.next=function(t){var r=this,s=r.isStopped,i=r._buffer,o=r._infiniteTimeWindow,u=r._timestampProvider,a=r._windowTime;s||(i.push(t),!o&&i.push(u.now()+a)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(t),s=this,i=s._infiniteTimeWindow,o=s._buffer,u=o.slice(),a=0;a<u.length&&!t.closed;a+=i?1:2)t.next(u[a]);return this._checkFinalizedStatuses(t),r},e.prototype._trimBuffer=function(){var t=this,r=t._bufferSize,s=t._timestampProvider,i=t._buffer,o=t._infiniteTimeWindow,u=(o?1:2)*r;if(r<1/0&&u<i.length&&i.splice(0,i.length-u),!o){for(var a=s.now(),c=0,l=1;l<i.length&&i[l]<=a;l+=2)c=l;c&&i.splice(0,c+1)}},e}(It),as=function(n){M(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(pe),nn={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setInterval.apply(void 0,Y([n,e],U(t)))},clearInterval:function(n){return clearInterval(n)},delegate:void 0},cs=function(n){M(e,n);function e(t,r){var s=n.call(this,t,r)||this;return s.scheduler=t,s.work=r,s.pending=!1,s}return e.prototype.schedule=function(t,r){var s;if(r===void 0&&(r=0),this.closed)return this;this.state=t;var i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,r)),this.pending=!0,this.delay=r,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(o,this.id,r),this},e.prototype.requestAsyncId=function(t,r,s){return s===void 0&&(s=0),nn.setInterval(t.flush.bind(t,this),s)},e.prototype.recycleAsyncId=function(t,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;r!=null&&nn.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(t,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var s=!1,i;try{this.work(t)}catch(o){s=!0,i=o||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,s=t.scheduler,i=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ve(i,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(as),ls=1,nt,dt={};function rn(n){return n in dt?(delete dt[n],!0):!1}var Zn={setImmediate:function(n){var e=ls++;return dt[e]=!0,nt||(nt=Promise.resolve()),nt.then(function(){return rn(e)&&n()}),e},clearImmediate:function(n){rn(n)}},fs=Zn.setImmediate,hs=Zn.clearImmediate,sn={setImmediate:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return fs.apply(void 0,Y([],U(n)))},clearImmediate:function(n){return hs(n)},delegate:void 0},ds=function(n){M(e,n);function e(t,r){var s=n.call(this,t,r)||this;return s.scheduler=t,s.work=r,s}return e.prototype.requestAsyncId=function(t,r,s){return s===void 0&&(s=0),s!==null&&s>0?n.prototype.requestAsyncId.call(this,t,r,s):(t.actions.push(this),t._scheduled||(t._scheduled=sn.setImmediate(t.flush.bind(t,void 0))))},e.prototype.recycleAsyncId=function(t,r,s){var i;if(s===void 0&&(s=0),s!=null?s>0:this.delay>0)return n.prototype.recycleAsyncId.call(this,t,r,s);var o=t.actions;r!=null&&((i=o[o.length-1])===null||i===void 0?void 0:i.id)!==r&&(sn.clearImmediate(r),t._scheduled===r&&(t._scheduled=void 0))},e}(cs),on=function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=Ot.now,n}(),ps=function(n){M(e,n);function e(t,r){r===void 0&&(r=on.now);var s=n.call(this,t,r)||this;return s.actions=[],s._active=!1,s}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var s;this._active=!0;do if(s=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,s){for(;t=r.shift();)t.unsubscribe();throw s}},e}(on),gs=function(n){M(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.flush=function(t){this._active=!0;var r=this._scheduled;this._scheduled=void 0;var s=this.actions,i;t=t||s.shift();do if(i=t.execute(t.state,t.delay))break;while((t=s[0])&&t.id===r&&s.shift());if(this._active=!1,i){for(;(t=s[0])&&t.id===r&&s.shift();)t.unsubscribe();throw i}},e}(ps),yu=new gs(ds),Nn=new T(function(n){return n.complete()});function ys(n){return n&&w(n.schedule)}function Tt(n){return n[n.length-1]}function mu(n){return w(Tt(n))?n.pop():void 0}function ms(n){return ys(Tt(n))?n.pop():void 0}function vs(n,e){return typeof Tt(n)=="number"?n.pop():e}var Pt=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function Qn(n){return w(n?.then)}function er(n){return w(n[kt])}function tr(n){return Symbol.asyncIterator&&w(n?.[Symbol.asyncIterator])}function nr(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function bs(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var rr=bs();function sr(n){return w(n?.[rr])}function ir(n){return Xr(this,arguments,function(){var t,r,s,i;return qn(this,function(o){switch(o.label){case 0:t=n.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,te(t.read())];case 3:return r=o.sent(),s=r.value,i=r.done,i?[4,te(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,te(s)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function or(n){return w(n?.getReader)}function C(n){if(n instanceof T)return n;if(n!=null){if(er(n))return _s(n);if(Pt(n))return Ss(n);if(Qn(n))return ws(n);if(tr(n))return ur(n);if(sr(n))return Es(n);if(or(n))return xs(n)}throw nr(n)}function _s(n){return new T(function(e){var t=n[kt]();if(w(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Ss(n){return new T(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function ws(n){return new T(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Yn)})}function Es(n){return new T(function(e){var t,r;try{for(var s=ne(n),i=s.next();!i.done;i=s.next()){var o=i.value;if(e.next(o),e.closed)return}}catch(u){t={error:u}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}e.complete()})}function ur(n){return new T(function(e){As(n,e).catch(function(t){return e.error(t)})})}function xs(n){return ur(ir(n))}function As(n,e){var t,r,s,i;return Yr(this,void 0,void 0,function(){var o,u;return qn(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),t=Kr(n),a.label=1;case 1:return[4,t.next()];case 2:if(r=a.sent(),!!r.done)return[3,4];if(o=r.value,e.next(o),e.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=a.sent(),s={error:u},[3,11];case 6:return a.trys.push([6,,9,10]),r&&!r.done&&(i=t.return)?[4,i.call(t)]:[3,8];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function J(n,e,t,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var i=e.schedule(function(){t(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function ar(n,e){return e===void 0&&(e=0),z(function(t,r){t.subscribe(X(r,function(s){return J(r,n,function(){return r.next(s)},e)},function(){return J(r,n,function(){return r.complete()},e)},function(s){return J(r,n,function(){return r.error(s)},e)}))})}function cr(n,e){return e===void 0&&(e=0),z(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function ks(n,e){return C(n).pipe(cr(e),ar(e))}function Is(n,e){return C(n).pipe(cr(e),ar(e))}function Os(n,e){return new T(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function Ts(n,e){return new T(function(t){var r;return J(t,e,function(){r=n[rr](),J(t,e,function(){var s,i,o;try{s=r.next(),i=s.value,o=s.done}catch(u){t.error(u);return}o?t.complete():t.next(i)},0,!0)}),function(){return w(r?.return)&&r.return()}})}function lr(n,e){if(!n)throw new Error("Iterable cannot be null");return new T(function(t){J(t,e,function(){var r=n[Symbol.asyncIterator]();J(t,e,function(){r.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function Ps(n,e){return lr(ir(n),e)}function js(n,e){if(n!=null){if(er(n))return ks(n,e);if(Pt(n))return Os(n,e);if(Qn(n))return Is(n,e);if(tr(n))return lr(n,e);if(sr(n))return Ts(n,e);if(or(n))return Ps(n,e)}throw nr(n)}function Ms(n,e){return e?js(n,e):C(n)}function fr(n,e){return z(function(t,r){var s=0;t.subscribe(X(r,function(i){r.next(n.call(e,i,s++))}))})}var Cs=Array.isArray;function Ls(n,e){return Cs(e)?n.apply(void 0,Y([],U(e))):n(e)}function Rs(n){return fr(function(e){return Ls(n,e)})}function $s(n,e,t,r,s,i,o,u){var a=[],c=0,l=0,f=!1,h=function(){f&&!a.length&&!c&&e.complete()},d=function(g){return c<r?p(g):a.push(g)},p=function(g){c++;var y=!1;C(t(g,l++)).subscribe(X(e,function(m){e.next(m)},function(){y=!0},void 0,function(){if(y)try{c--;for(var m=function(){var v=a.shift();o||p(v)};a.length&&c<r;)m();h()}catch(v){e.error(v)}}))};return n.subscribe(X(e,d,function(){f=!0,h()})),function(){}}function he(n,e,t){return t===void 0&&(t=1/0),w(e)?he(function(r,s){return fr(function(i,o){return e(r,i,s,o)})(C(n(r,s)))},t):(typeof e=="number"&&(t=e),z(function(r,s){return $s(r,s,n,t)}))}function Ds(n){return n===void 0&&(n=1/0),he(Xn,n)}function vu(n){return new T(function(e){C(n()).subscribe(e)})}var Fs=["addListener","removeListener"],Vs=["addEventListener","removeEventListener"],Bs=["on","off"];function un(n,e,t,r){if(w(t)&&(r=t,t=void 0),r)return un(n,e,t).pipe(Rs(r));var s=U(zs(n)?Vs.map(function(u){return function(a){return n[u](e,a,t)}}):Us(n)?Fs.map(an(n,e)):Ws(n)?Bs.map(an(n,e)):[],2),i=s[0],o=s[1];if(!i&&Pt(n))return he(function(u){return un(u,e,t)})(C(n));if(!i)throw new TypeError("Invalid event target");return new T(function(u){var a=function(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];return u.next(1<c.length?c:c[0])};return i(a),function(){return o(a)}})}function an(n,e){return function(t){return function(r){return n[t](e,r)}}}function Us(n){return w(n.addListener)&&w(n.removeListener)}function Ws(n){return w(n.on)&&w(n.off)}function zs(n){return w(n.addEventListener)&&w(n.removeEventListener)}function bu(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=ms(n),r=vs(n,1/0),s=n;return s.length?s.length===1?C(s[0]):Ds(r)(Ms(s,t)):Nn}function _u(n,e){return z(function(t,r){var s=0;t.subscribe(X(r,function(i){return n.call(e,i,s++)&&r.next(i)}))})}function Su(n,e){return w(e)?he(n,e,1):he(n,1)}function wu(n){return n<=0?function(){return Nn}:z(function(e,t){var r=0;e.subscribe(X(t,function(s){++r<=n&&(t.next(s),n<=r&&t.complete())}))})}function qs(n){n===void 0&&(n={});var e=n.connector,t=e===void 0?function(){return new It}:e,r=n.resetOnError,s=r===void 0?!0:r,i=n.resetOnComplete,o=i===void 0?!0:i,u=n.resetOnRefCountZero,a=u===void 0?!0:u;return function(c){var l,f,h,d=0,p=!1,g=!1,y=function(){f?.unsubscribe(),f=void 0},m=function(){y(),l=h=void 0,p=g=!1},v=function(){var b=l;m(),b?.unsubscribe()};return z(function(b,S){d++,!g&&!p&&y();var k=h=h??t();S.add(function(){d--,d===0&&!g&&!p&&(f=rt(v,a))}),k.subscribe(S),!l&&d>0&&(l=new fe({next:function(I){return k.next(I)},error:function(I){g=!0,y(),f=rt(m,s,I),k.error(I)},complete:function(){p=!0,y(),f=rt(m,o),k.complete()}}),C(b).subscribe(l))})(c)}}function rt(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(e===!0){n();return}if(e!==!1){var s=new fe({next:function(){s.unsubscribe(),n()}});return C(e.apply(void 0,Y([],U(t)))).subscribe(s)}}function Eu(n,e,t){var r,s,i,o,u=!1;return n&&typeof n=="object"?(r=n.bufferSize,o=r===void 0?1/0:r,s=n.windowTime,e=s===void 0?1/0:s,i=n.refCount,u=i===void 0?!1:i,t=n.scheduler):o=n??1/0,qs({connector:function(){return new us(o,e,t)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:u})}function xu(n){return z(function(e,t){C(n).subscribe(X(t,function(){return t.complete()},ht)),!t.closed&&e.subscribe(t)})}var Gs=qr();const Au=Gr(Gs);function ku(n){const e=Qe.useRef(null);return Qe.useInsertionEffect(()=>{e.current=n},[n]),Qe.useCallback((...t)=>{const r=e.current;return r(...t)},[])}function Iu(n){const e=typeof window<"u"&&"crypto"in window?window.crypto:globalThis.crypto;if(!e||!e.getRandomValues)throw new Error("WebCrypto not available in this environment");return e.getRandomValues(n)}const cn=n=>typeof n=="object"&&n!=null&&n.nodeType===1,ln=(n,e)=>(!e||n!=="hidden")&&n!=="visible"&&n!=="clip",je=(n,e)=>{if(n.clientHeight<n.scrollHeight||n.clientWidth<n.scrollWidth){const t=getComputedStyle(n,null);return ln(t.overflowY,e)||ln(t.overflowX,e)||(r=>{const s=(i=>{if(!i.ownerDocument||!i.ownerDocument.defaultView)return null;try{return i.ownerDocument.defaultView.frameElement}catch{return null}})(r);return!!s&&(s.clientHeight<r.scrollHeight||s.clientWidth<r.scrollWidth)})(n)}return!1},Me=(n,e,t,r,s,i,o,u)=>i<n&&o>e||i>n&&o<e?0:i<=n&&u<=t||o>=e&&u>=t?i-n-r:o>e&&u<t||i<n&&u>t?o-e+s:0,Hs=n=>{const e=n.parentElement;return e??(n.getRootNode().host||null)},fn=(n,e)=>{var t,r,s,i;if(typeof document>"u")return[];const{scrollMode:o,block:u,inline:a,boundary:c,skipOverflowHiddenElements:l}=e,f=typeof c=="function"?c:q=>q!==c;if(!cn(n))throw new TypeError("Invalid target");const h=document.scrollingElement||document.documentElement,d=[];let p=n;for(;cn(p)&&f(p);){if(p=Hs(p),p===h){d.push(p);break}p!=null&&p===document.body&&je(p)&&!je(document.documentElement)||p!=null&&je(p,l)&&d.push(p)}const g=(r=(t=window.visualViewport)==null?void 0:t.width)!=null?r:innerWidth,y=(i=(s=window.visualViewport)==null?void 0:s.height)!=null?i:innerHeight,{scrollX:m,scrollY:v}=window,{height:b,width:S,top:k,right:I,bottom:ae,left:ve}=n.getBoundingClientRect(),{top:qt,right:Gt,bottom:Ht,left:Jt}=(q=>{const E=window.getComputedStyle(q);return{top:parseFloat(E.scrollMarginTop)||0,right:parseFloat(E.scrollMarginRight)||0,bottom:parseFloat(E.scrollMarginBottom)||0,left:parseFloat(E.scrollMarginLeft)||0}})(n);let P=u==="start"||u==="nearest"?k-qt:u==="end"?ae+Ht:k+b/2-qt+Ht,j=a==="center"?ve+S/2-Jt+Gt:a==="end"?I+Gt:ve-Jt;const Ye=[];for(let q=0;q<d.length;q++){const E=d[q],{height:be,width:_e,top:Se,right:Xe,bottom:Ke,left:we}=E.getBoundingClientRect();if(o==="if-needed"&&k>=0&&ve>=0&&ae<=y&&I<=g&&(E===h&&!je(E)||k>=Se&&ae<=Ke&&ve>=we&&I<=Xe))return Ye;const Ee=getComputedStyle(E),xe=parseInt(Ee.borderLeftWidth,10),Ae=parseInt(Ee.borderTopWidth,10),ke=parseInt(Ee.borderRightWidth,10),Ie=parseInt(Ee.borderBottomWidth,10);let D=0,F=0;const Oe="offsetWidth"in E?E.offsetWidth-E.clientWidth-xe-ke:0,Te="offsetHeight"in E?E.offsetHeight-E.clientHeight-Ae-Ie:0,Ze="offsetWidth"in E?E.offsetWidth===0?0:_e/E.offsetWidth:0,Ne="offsetHeight"in E?E.offsetHeight===0?0:be/E.offsetHeight:0;if(h===E)D=u==="start"?P:u==="end"?P-y:u==="nearest"?Me(v,v+y,y,Ae,Ie,v+P,v+P+b,b):P-y/2,F=a==="start"?j:a==="center"?j-g/2:a==="end"?j-g:Me(m,m+g,g,xe,ke,m+j,m+j+S,S),D=Math.max(0,D+v),F=Math.max(0,F+m);else{D=u==="start"?P-Se-Ae:u==="end"?P-Ke+Ie+Te:u==="nearest"?Me(Se,Ke,be,Ae,Ie+Te,P,P+b,b):P-(Se+be/2)+Te/2,F=a==="start"?j-we-xe:a==="center"?j-(we+_e/2)+Oe/2:a==="end"?j-Xe+ke+Oe:Me(we,Xe,_e,xe,ke+Oe,j,j+S,S);const{scrollLeft:Yt,scrollTop:Xt}=E;D=Ne===0?0:Math.max(0,Math.min(Xt+D/Ne,E.scrollHeight-be/Ne+Te)),F=Ze===0?0:Math.max(0,Math.min(Yt+F/Ze,E.scrollWidth-_e/Ze+Oe)),P+=Xt-D,j+=Yt-F}Ye.push({el:E,top:D,left:F})}return Ye},Js=n=>n===!1?{block:"end",inline:"nearest"}:(e=>e===Object(e)&&Object.keys(e).length!==0)(n)?n:{block:"start",inline:"nearest"};function Ou(n,e){if(!n.isConnected||!(s=>{let i=s;for(;i&&i.parentNode;){if(i.parentNode===document)return!0;i=i.parentNode instanceof ShadowRoot?i.parentNode.host:i.parentNode}return!1})(n))return;const t=(s=>{const i=window.getComputedStyle(s);return{top:parseFloat(i.scrollMarginTop)||0,right:parseFloat(i.scrollMarginRight)||0,bottom:parseFloat(i.scrollMarginBottom)||0,left:parseFloat(i.scrollMarginLeft)||0}})(n);if((s=>typeof s=="object"&&typeof s.behavior=="function")(e))return e.behavior(fn(n,e));const r=typeof e=="boolean"||e==null?void 0:e.behavior;for(const{el:s,top:i,left:o}of fn(n,Js(e))){const u=i-t.top+t.bottom,a=o-t.left+t.right;s.scroll({top:u,left:a,behavior:r})}}function Ys(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function Xs(){const n=Ys();if(n.__xstate__)return n.__xstate__}const Ks=n=>{if(typeof window>"u")return;const e=Xs();e&&e.register(n)};class hn{constructor(e){this._process=e,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(e){const t={value:e,next:null};if(this._current){this._last.next=t,this._last=t;return}this._current=t,this._last=t,this._active&&this.flush()}flush(){for(;this._current;){const e=this._current;this._process(e.value),this._current=e.next}this._last=null}}const hr=".",Zs="",dr="",Ns="#",Qs="*",pr="xstate.init",ei="xstate.error",re="xstate.stop";function ti(n,e){return{type:`xstate.after.${n}.${e}`}}function pt(n,e){return{type:`xstate.done.state.${n}`,output:e}}function ni(n,e){return{type:`xstate.done.actor.${n}`,output:e,actorId:n}}function gr(n,e){return{type:`xstate.error.actor.${n}`,error:e,actorId:n}}function yr(n){return{type:pr,input:n}}function L(n){setTimeout(()=>{throw n})}const ri=typeof Symbol=="function"&&Symbol.observable||"@@observable";function mr(n,e){const t=dn(n),r=dn(e);return typeof r=="string"?typeof t=="string"?r===t:!1:typeof t=="string"?t in r:Object.keys(t).every(s=>s in r?mr(t[s],r[s]):!1)}function jt(n){if(br(n))return n;const e=[];let t="";for(let r=0;r<n.length;r++){switch(n.charCodeAt(r)){case 92:t+=n[r+1],r++;continue;case 46:e.push(t),t="";continue}t+=n[r]}return e.push(t),e}function dn(n){if(Ri(n))return n.value;if(typeof n!="string")return n;const e=jt(n);return si(e)}function si(n){if(n.length===1)return n[0];const e={};let t=e;for(let r=0;r<n.length-1;r++)if(r===n.length-2)t[n[r]]=n[r+1];else{const s=t;t={},s[n[r]]=t}return e}function pn(n,e){const t={},r=Object.keys(n);for(let s=0;s<r.length;s++){const i=r[s];t[i]=e(n[i],i,n,s)}return t}function vr(n){return br(n)?n:[n]}function $(n){return n===void 0?[]:vr(n)}function gt(n,e,t,r){return typeof n=="function"?n({context:e,event:t,self:r}):n}function br(n){return Array.isArray(n)}function ii(n){return n.type.startsWith("xstate.error.actor")}function Q(n){return vr(n).map(e=>typeof e>"u"||typeof e=="string"?{target:e}:e)}function _r(n){if(!(n===void 0||n===Zs))return $(n)}function yt(n,e,t){const r=typeof n=="object",s=r?n:void 0;return{next:(r?n.next:n)?.bind(s),error:(r?n.error:e)?.bind(s),complete:(r?n.complete:t)?.bind(s)}}function gn(n,e){return`${e}.${n}`}function Mt(n,e){const t=e.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!t)return n.implementations.actors[e];const[,r,s]=t,o=n.getStateNodeById(s).config.invoke;return(Array.isArray(o)?o[r]:o).src}function yn(n,e){return`${n.sessionId}.${e}`}let oi=0;function ui(n,e){const t=new Map,r=new Map,s=new WeakMap,i=new Set,o={},{clock:u,logger:a}=e,c={schedule:(h,d,p,g,y=Math.random().toString(36).slice(2))=>{const m={source:h,target:d,event:p,delay:g,id:y,startedAt:Date.now()},v=yn(h,y);f._snapshot._scheduledEvents[v]=m;const b=u.setTimeout(()=>{delete o[v],delete f._snapshot._scheduledEvents[v],f._relay(h,d,p)},g);o[v]=b},cancel:(h,d)=>{const p=yn(h,d),g=o[p];delete o[p],delete f._snapshot._scheduledEvents[p],g!==void 0&&u.clearTimeout(g)},cancelAll:h=>{for(const d in f._snapshot._scheduledEvents){const p=f._snapshot._scheduledEvents[d];p.source===h&&c.cancel(h,p.id)}}},l=h=>{if(!i.size)return;const d={...h,rootId:n.sessionId};i.forEach(p=>p.next?.(d))},f={_snapshot:{_scheduledEvents:(e?.snapshot&&e.snapshot.scheduler)??{}},_bookId:()=>`x:${oi++}`,_register:(h,d)=>(t.set(h,d),h),_unregister:h=>{t.delete(h.sessionId);const d=s.get(h);d!==void 0&&(r.delete(d),s.delete(h))},get:h=>r.get(h),_set:(h,d)=>{const p=r.get(h);if(p&&p!==d)throw new Error(`Actor with system ID '${h}' already exists.`);r.set(h,d),s.set(d,h)},inspect:h=>{const d=yt(h);return i.add(d),{unsubscribe(){i.delete(d)}}},_sendInspectionEvent:l,_relay:(h,d,p)=>{f._sendInspectionEvent({type:"@xstate.event",sourceRef:h,actorRef:d,event:p}),d._send(p)},scheduler:c,getSnapshot:()=>({_scheduledEvents:{...f._snapshot._scheduledEvents}}),start:()=>{const h=f._snapshot._scheduledEvents;f._snapshot._scheduledEvents={};for(const d in h){const{source:p,target:g,event:y,delay:m,id:v}=h[d];c.schedule(p,g,y,m,v)}},_clock:u,_logger:a};return f}let st=!1;const Ct=1;let O=function(n){return n[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.Stopped=2]="Stopped",n}({});const ai={clock:{setTimeout:(n,e)=>setTimeout(n,e),clearTimeout:n=>clearTimeout(n)},logger:console.log.bind(console),devTools:!1};class ci{constructor(e,t){this.logic=e,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new hn(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=O.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];const r={...ai,...t},{clock:s,logger:i,parent:o,syncSnapshot:u,id:a,systemId:c,inspect:l}=r;this.system=o?o.system:ui(this,{clock:s,logger:i}),l&&!o&&this.system.inspect(yt(l)),this.sessionId=this.system._bookId(),this.id=a??this.sessionId,this.logger=t?.logger??this.system._logger,this.clock=t?.clock??this.system._clock,this._parent=o,this._syncSnapshot=u,this.options=r,this.src=r.src??e,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:f=>{this._deferred.push(f)},system:this.system,stopChild:f=>{if(f._parent!==this)throw new Error(`Cannot stop child actor ${f.id} of ${this.id} because it is not a child`);f._stop()},emit:f=>{const h=this.eventListeners.get(f.type),d=this.eventListeners.get("*");if(!h&&!d)return;const p=[...h?h.values():[],...d?d.values():[]];for(const g of p)g(f)},actionExecutor:f=>{const h=()=>{if(this._actorScope.system._sendInspectionEvent({type:"@xstate.action",actorRef:this,action:{type:f.type,params:f.params}}),!f.exec)return;const d=st;try{st=!0,f.exec(f.info,f.params)}finally{st=d}};this._processingStatus===O.Running?h():this._deferred.push(h)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),c&&(this._systemId=c,this.system._set(c,this)),this._initState(t?.snapshot??t?.state),c&&this._snapshot.status!=="active"&&this.system._unregister(this)}_initState(e){try{this._snapshot=e?this.logic.restoreSnapshot?this.logic.restoreSnapshot(e,this._actorScope):e:this.logic.getInitialSnapshot(this._actorScope,this.options?.input)}catch(t){this._snapshot={status:"error",output:void 0,error:t}}}update(e,t){this._snapshot=e;let r;for(;r=this._deferred.shift();)try{r()}catch(s){this._deferred.length=0,this._snapshot={...e,status:"error",error:s}}switch(this._snapshot.status){case"active":for(const s of this.observers)try{s.next?.(e)}catch(i){L(i)}break;case"done":for(const s of this.observers)try{s.next?.(e)}catch(i){L(i)}this._stopProcedure(),this._complete(),this._doneEvent=ni(this.id,this._snapshot.output),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error);break}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:t,snapshot:e})}subscribe(e,t,r){const s=yt(e,t,r);if(this._processingStatus!==O.Stopped)this.observers.add(s);else switch(this._snapshot.status){case"done":try{s.complete?.()}catch(i){L(i)}break;case"error":{const i=this._snapshot.error;if(!s.error)L(i);else try{s.error(i)}catch(o){L(o)}break}}return{unsubscribe:()=>{this.observers.delete(s)}}}on(e,t){let r=this.eventListeners.get(e);r||(r=new Set,this.eventListeners.set(e,r));const s=t.bind(void 0);return r.add(s),{unsubscribe:()=>{r.delete(s)}}}start(){if(this._processingStatus===O.Running)return this;this._syncSnapshot&&this.subscribe({next:r=>{r.status==="active"&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:r})},error:()=>{}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=O.Running;const e=yr(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:e}),this._snapshot.status){case"done":return this.update(this._snapshot,e),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(r){return this._snapshot={...this._snapshot,status:"error",error:r},this._error(r),this}return this.update(this._snapshot,e),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(e){let t,r;try{t=this.logic.transition(this._snapshot,e,this._actorScope)}catch(s){r={err:s}}if(r){const{err:s}=r;this._snapshot={...this._snapshot,status:"error",error:s},this._error(s);return}this.update(t,e),e.type===re&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===O.Stopped?this:(this.mailbox.clear(),this._processingStatus===O.NotStarted?(this._processingStatus=O.Stopped,this):(this.mailbox.enqueue({type:re}),this))}stop(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){for(const e of this.observers)try{e.complete?.()}catch(t){L(t)}this.observers.clear()}_reportError(e){if(!this.observers.size){this._parent||L(e);return}let t=!1;for(const r of this.observers){const s=r.error;t||=!s;try{s?.(e)}catch(i){L(i)}}this.observers.clear(),t&&L(e)}_error(e){this._stopProcedure(),this._reportError(e),this._parent&&this.system._relay(this,this._parent,gr(this.id,e))}_stopProcedure(){return this._processingStatus!==O.Running?this:(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new hn(this._process.bind(this)),this._processingStatus=O.Stopped,this.system._unregister(this),this)}_send(e){this._processingStatus!==O.Stopped&&this.mailbox.enqueue(e)}send(e){this.system._relay(void 0,this,e)}attachDevTools(){const{devTools:e}=this.options;e&&(typeof e=="function"?e:Ks)(this)}toJSON(){return{xstate$$type:Ct,id:this.id}}getPersistedSnapshot(e){return this.logic.getPersistedSnapshot(this._snapshot,e)}[ri](){return this}getSnapshot(){return this._snapshot}}function de(n,...[e]){return new ci(n,e)}function li(n,e,t,r,{sendId:s}){const i=typeof s=="function"?s(t,r):s;return[e,{sendId:i},void 0]}function fi(n,e){n.defer(()=>{n.system.scheduler.cancel(n.self,e.sendId)})}function Sr(n){function e(t,r){}return e.type="xstate.cancel",e.sendId=n,e.resolve=li,e.execute=fi,e}function hi(n,e,t,r,{id:s,systemId:i,src:o,input:u,syncSnapshot:a}){const c=typeof o=="string"?Mt(e.machine,o):o,l=typeof s=="function"?s(t):s;let f,h;return c&&(h=typeof u=="function"?u({context:e.context,event:t.event,self:n.self}):u,f=de(c,{id:l,src:o,parent:n.self,syncSnapshot:a,systemId:i,input:h})),[K(e,{children:{...e.children,[l]:f}}),{id:s,systemId:i,actorRef:f,src:o,input:h},void 0]}function di(n,{actorRef:e}){e&&n.defer(()=>{e._processingStatus!==O.Stopped&&e.start()})}function wr(...[n,{id:e,systemId:t,input:r,syncSnapshot:s=!1}={}]){function i(o,u){}return i.type="xstate.spawnChild",i.id=e,i.systemId=t,i.src=n,i.input=r,i.syncSnapshot=s,i.resolve=hi,i.execute=di,i}function pi(n,e,t,r,{actorRef:s}){const i=typeof s=="function"?s(t,r):s,o=typeof i=="string"?e.children[i]:i;let u=e.children;return o&&(u={...u},delete u[o.id]),[K(e,{children:u}),o,void 0]}function gi(n,e){if(e){if(n.system._unregister(e),e._processingStatus!==O.Running){n.stopChild(e);return}n.defer(()=>{n.stopChild(e)})}}function Lt(n){function e(t,r){}return e.type="xstate.stopChild",e.actorRef=n,e.resolve=pi,e.execute=gi,e}function qe(n,e,t,r){const{machine:s}=r,i=typeof n=="function",o=i?n:s.implementations.guards[typeof n=="string"?n:n.type];if(!i&&!o)throw new Error(`Guard '${typeof n=="string"?n:n.type}' is not implemented.'.`);if(typeof o!="function")return qe(o,e,t,r);const u={context:e,event:t},a=i||typeof n=="string"?void 0:"params"in n?typeof n.params=="function"?n.params({context:e,event:t}):n.params:void 0;return"check"in o?o.check(r,u,o):o(u,a)}const Rt=n=>n.type==="atomic"||n.type==="final";function se(n){return Object.values(n.states).filter(e=>e.type!=="history")}function ge(n,e){const t=[];if(e===n)return t;let r=n.parent;for(;r&&r!==e;)t.push(r),r=r.parent;return t}function Be(n){const e=new Set(n),t=xr(e);for(const r of e)if(r.type==="compound"&&(!t.get(r)||!t.get(r).length))mn(r).forEach(s=>e.add(s));else if(r.type==="parallel"){for(const s of se(r))if(s.type!=="history"&&!e.has(s)){const i=mn(s);for(const o of i)e.add(o)}}for(const r of e){let s=r.parent;for(;s;)e.add(s),s=s.parent}return e}function Er(n,e){const t=e.get(n);if(!t)return{};if(n.type==="compound"){const s=t[0];if(s){if(Rt(s))return s.key}else return{}}const r={};for(const s of t)r[s.key]=Er(s,e);return r}function xr(n){const e=new Map;for(const t of n)e.has(t)||e.set(t,[]),t.parent&&(e.has(t.parent)||e.set(t.parent,[]),e.get(t.parent).push(t));return e}function Ar(n,e){const t=Be(e);return Er(n,xr(t))}function $t(n,e){return e.type==="compound"?se(e).some(t=>t.type==="final"&&n.has(t)):e.type==="parallel"?se(e).every(t=>$t(n,t)):e.type==="final"}const Ge=n=>n[0]===Ns;function yi(n,e){return n.transitions.get(e)||[...n.transitions.keys()].filter(r=>{if(r===Qs)return!0;if(!r.endsWith(".*"))return!1;const s=r.split("."),i=e.split(".");for(let o=0;o<s.length;o++){const u=s[o],a=i[o];if(u==="*")return o===s.length-1;if(u!==a)return!1}return!0}).sort((r,s)=>s.length-r.length).flatMap(r=>n.transitions.get(r))}function mi(n){const e=n.config.after;if(!e)return[];const t=s=>{const i=ti(s,n.id),o=i.type;return n.entry.push(Cr(i,{id:o,delay:s})),n.exit.push(Sr(o)),o};return Object.keys(e).flatMap(s=>{const i=e[s],o=typeof i=="string"?{target:i}:i,u=Number.isNaN(+s)?s:+s,a=t(u);return $(o).map(c=>({...c,event:a,delay:u}))}).map(s=>{const{delay:i}=s;return{...G(n,s.event,s),delay:i}})}function G(n,e,t){const r=_r(t.target),s=t.reenter??!1,i=_i(n,r),o={...t,actions:$(t.actions),guard:t.guard,target:i,source:n,reenter:s,eventType:e,toJSON:()=>({...o,source:`#${n.id}`,target:i?i.map(u=>`#${u.id}`):void 0})};return o}function vi(n){const e=new Map;if(n.config.on)for(const t of Object.keys(n.config.on)){if(t===dr)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');const r=n.config.on[t];e.set(t,Q(r).map(s=>G(n,t,s)))}if(n.config.onDone){const t=`xstate.done.state.${n.id}`;e.set(t,Q(n.config.onDone).map(r=>G(n,t,r)))}for(const t of n.invoke){if(t.onDone){const r=`xstate.done.actor.${t.id}`;e.set(r,Q(t.onDone).map(s=>G(n,r,s)))}if(t.onError){const r=`xstate.error.actor.${t.id}`;e.set(r,Q(t.onError).map(s=>G(n,r,s)))}if(t.onSnapshot){const r=`xstate.snapshot.${t.id}`;e.set(r,Q(t.onSnapshot).map(s=>G(n,r,s)))}}for(const t of n.after){let r=e.get(t.eventType);r||(r=[],e.set(t.eventType,r)),r.push(t)}return e}function bi(n,e){const t=typeof e=="string"?n.states[e]:e?n.states[e.target]:void 0;if(!t&&e)throw new Error(`Initial state node "${e}" not found on parent state node #${n.id}`);const r={source:n,actions:!e||typeof e=="string"?[]:$(e.actions),eventType:null,reenter:!1,target:t?[t]:[],toJSON:()=>({...r,source:`#${n.id}`,target:t?[`#${t.id}`]:[]})};return r}function _i(n,e){if(e!==void 0)return e.map(t=>{if(typeof t!="string")return t;if(Ge(t))return n.machine.getStateNodeById(t);const r=t[0]===hr;if(r&&!n.parent)return Ue(n,t.slice(1));const s=r?n.key+t:t;if(n.parent)try{return Ue(n.parent,s)}catch(i){throw new Error(`Invalid transition definition for state node '${n.id}':
${i.message}`)}else throw new Error(`Invalid target: "${t}" is not a valid target from the root node. Did you mean ".${t}"?`)})}function kr(n){const e=_r(n.config.target);return e?{target:e.map(t=>typeof t=="string"?Ue(n.parent,t):t)}:n.parent.initial}function H(n){return n.type==="history"}function mn(n){const e=Ir(n);for(const t of e)for(const r of ge(t,n))e.add(r);return e}function Ir(n){const e=new Set;function t(r){if(!e.has(r)){if(e.add(r),r.type==="compound")t(r.initial.target[0]);else if(r.type==="parallel")for(const s of se(r))t(s)}}return t(n),e}function ie(n,e){if(Ge(e))return n.machine.getStateNodeById(e);if(!n.states)throw new Error(`Unable to retrieve child state '${e}' from '${n.id}'; no child states exist.`);const t=n.states[e];if(!t)throw new Error(`Child state '${e}' does not exist on '${n.id}'`);return t}function Ue(n,e){if(typeof e=="string"&&Ge(e))try{return n.machine.getStateNodeById(e)}catch{}const t=jt(e).slice();let r=n;for(;t.length;){const s=t.shift();if(!s.length)break;r=ie(r,s)}return r}function We(n,e){if(typeof e=="string"){const s=n.states[e];if(!s)throw new Error(`State '${e}' does not exist on '${n.id}'`);return[n,s]}const t=Object.keys(e),r=t.map(s=>ie(n,s)).filter(Boolean);return[n.machine.root,n].concat(r,t.reduce((s,i)=>{const o=ie(n,i);if(!o)return s;const u=We(o,e[i]);return s.concat(u)},[]))}function Si(n,e,t,r){const i=ie(n,e).next(t,r);return!i||!i.length?n.next(t,r):i}function wi(n,e,t,r){const s=Object.keys(e),i=ie(n,s[0]),o=Dt(i,e[s[0]],t,r);return!o||!o.length?n.next(t,r):o}function Ei(n,e,t,r){const s=[];for(const i of Object.keys(e)){const o=e[i];if(!o)continue;const u=ie(n,i),a=Dt(u,o,t,r);a&&s.push(...a)}return s.length?s:n.next(t,r)}function Dt(n,e,t,r){return typeof e=="string"?Si(n,e,t,r):Object.keys(e).length===1?wi(n,e,t,r):Ei(n,e,t,r)}function xi(n){return Object.keys(n.states).map(e=>n.states[e]).filter(e=>e.type==="history")}function W(n,e){let t=n;for(;t.parent&&t.parent!==e;)t=t.parent;return t.parent===e}function Ai(n,e){const t=new Set(n),r=new Set(e);for(const s of t)if(r.has(s))return!0;for(const s of r)if(t.has(s))return!0;return!1}function Or(n,e,t){const r=new Set;for(const s of n){let i=!1;const o=new Set;for(const u of r)if(Ai(mt([s],e,t),mt([u],e,t)))if(W(s.source,u.source))o.add(u);else{i=!0;break}if(!i){for(const u of o)r.delete(u);r.add(s)}}return Array.from(r)}function ki(n){const[e,...t]=n;for(const r of ge(e,void 0))if(t.every(s=>W(s,r)))return r}function Ft(n,e){if(!n.target)return[];const t=new Set;for(const r of n.target)if(H(r))if(e[r.id])for(const s of e[r.id])t.add(s);else for(const s of Ft(kr(r),e))t.add(s);else t.add(r);return[...t]}function Tr(n,e){const t=Ft(n,e);if(!t)return;if(!n.reenter&&t.every(s=>s===n.source||W(s,n.source)))return n.source;const r=ki(t.concat(n.source));if(r)return r;if(!n.reenter)return n.source.machine.root}function mt(n,e,t){const r=new Set;for(const s of n)if(s.target?.length){const i=Tr(s,t);s.reenter&&s.source===i&&r.add(i);for(const o of e)W(o,i)&&r.add(o)}return[...r]}function Ii(n,e){if(n.length!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0}function vt(n,e,t,r,s,i){if(!n.length)return e;const o=new Set(e._nodes);let u=e.historyValue;const a=Or(n,o,u);let c=e;s||([c,u]=ji(c,r,t,a,o,u,i,t.actionExecutor)),c=oe(c,r,t,a.flatMap(f=>f.actions),i,void 0),c=Ti(c,r,t,a,o,i,u,s);const l=[...o];c.status==="done"&&(c=oe(c,r,t,l.sort((f,h)=>h.order-f.order).flatMap(f=>f.exit),i,void 0));try{return u===e.historyValue&&Ii(e._nodes,o)?c:K(c,{_nodes:l,historyValue:u})}catch(f){throw f}}function Oi(n,e,t,r,s){if(r.output===void 0)return;const i=pt(s.id,s.output!==void 0&&s.parent?gt(s.output,n.context,e,t.self):void 0);return gt(r.output,n.context,i,t.self)}function Ti(n,e,t,r,s,i,o,u){let a=n;const c=new Set,l=new Set;Pi(r,o,l,c),u&&l.add(n.machine.root);const f=new Set;for(const h of[...c].sort((d,p)=>d.order-p.order)){s.add(h);const d=[];d.push(...h.entry);for(const p of h.invoke)d.push(wr(p.src,{...p,syncSnapshot:!!p.onSnapshot}));if(l.has(h)){const p=h.initial.actions;d.push(...p)}if(a=oe(a,e,t,d,i,h.invoke.map(p=>p.id)),h.type==="final"){const p=h.parent;let g=p?.type==="parallel"?p:p?.parent,y=g||h;for(p?.type==="compound"&&i.push(pt(p.id,h.output!==void 0?gt(h.output,a.context,e,t.self):void 0));g?.type==="parallel"&&!f.has(g)&&$t(s,g);)f.add(g),i.push(pt(g.id)),y=g,g=g.parent;if(g)continue;a=K(a,{status:"done",output:Oi(a,e,t,a.machine.root,y)})}}return a}function Pi(n,e,t,r){for(const s of n){const i=Tr(s,e);for(const u of s.target||[])!H(u)&&(s.source!==u||s.source!==i||s.reenter)&&(r.add(u),t.add(u)),ee(u,e,t,r);const o=Ft(s,e);for(const u of o){const a=ge(u,i);i?.type==="parallel"&&a.push(i),Pr(r,e,t,a,!s.source.parent&&s.reenter?void 0:i)}}}function ee(n,e,t,r){if(H(n))if(e[n.id]){const s=e[n.id];for(const i of s)r.add(i),ee(i,e,t,r);for(const i of s)it(i,n.parent,r,e,t)}else{const s=kr(n);for(const i of s.target)r.add(i),s===n.parent?.initial&&t.add(n.parent),ee(i,e,t,r);for(const i of s.target)it(i,n.parent,r,e,t)}else if(n.type==="compound"){const[s]=n.initial.target;H(s)||(r.add(s),t.add(s)),ee(s,e,t,r),it(s,n,r,e,t)}else if(n.type==="parallel")for(const s of se(n).filter(i=>!H(i)))[...r].some(i=>W(i,s))||(H(s)||(r.add(s),t.add(s)),ee(s,e,t,r))}function Pr(n,e,t,r,s){for(const i of r)if((!s||W(i,s))&&n.add(i),i.type==="parallel")for(const o of se(i).filter(u=>!H(u)))[...n].some(u=>W(u,o))||(n.add(o),ee(o,e,t,n))}function it(n,e,t,r,s){Pr(t,r,s,ge(n,e))}function ji(n,e,t,r,s,i,o,u){let a=n;const c=mt(r,s,i);c.sort((f,h)=>h.order-f.order);let l;for(const f of c)for(const h of xi(f)){let d;h.history==="deep"?d=p=>Rt(p)&&W(p,f):d=p=>p.parent===f,l??={...i},l[h.id]=Array.from(s).filter(d)}for(const f of c)a=oe(a,e,t,[...f.exit,...f.invoke.map(h=>Lt(h.id))],o,void 0),s.delete(f);return[a,l||i]}function Mi(n,e){return n.implementations.actions[e]}function jr(n,e,t,r,s,i){const{machine:o}=n;let u=n;for(const a of r){const c=typeof a=="function",l=c?a:Mi(o,typeof a=="string"?a:a.type),f={context:u.context,event:e,self:t.self,system:t.system},h=c||typeof a=="string"?void 0:"params"in a?typeof a.params=="function"?a.params({context:u.context,event:e}):a.params:void 0;if(!l||!("resolve"in l)){t.actionExecutor({type:typeof a=="string"?a:typeof a=="object"?a.type:a.name||"(anonymous)",info:f,params:h,exec:l});continue}const d=l,[p,g,y]=d.resolve(t,u,f,h,l,s);u=p,"retryResolve"in d&&i?.push([d,g]),"execute"in d&&t.actionExecutor({type:d.type,info:f,params:g,exec:d.execute.bind(null,t,g)}),y&&(u=jr(u,e,t,y,s,i))}return u}function oe(n,e,t,r,s,i){const o=i?[]:void 0,u=jr(n,e,t,r,{internalQueue:s,deferredActorIds:i},o);return o?.forEach(([a,c])=>{a.retryResolve(t,u,c)}),u}function ot(n,e,t,r){let s=n;const i=[];function o(c,l,f){t.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:t.self,event:l,snapshot:c,_transitions:f}),i.push(c)}if(e.type===re)return s=K(vn(s,e,t),{status:"stopped"}),o(s,e,[]),{snapshot:s,microstates:i};let u=e;if(u.type!==pr){const c=u,l=ii(c),f=bn(c,s);if(l&&!f.length)return s=K(n,{status:"error",error:c.error}),o(s,c,[]),{snapshot:s,microstates:i};s=vt(f,n,t,u,!1,r),o(s,c,f)}let a=!0;for(;s.status==="active";){let c=a?Ci(s,u):[];const l=c.length?s:void 0;if(!c.length){if(!r.length)break;u=r.shift(),c=bn(u,s)}s=vt(c,s,t,u,!1,r),a=s!==l,o(s,u,c)}return s.status!=="active"&&vn(s,u,t),{snapshot:s,microstates:i}}function vn(n,e,t){return oe(n,e,t,Object.values(n.children).map(r=>Lt(r)),[],void 0)}function bn(n,e){return e.machine.getTransitionData(e,n)}function Ci(n,e){const t=new Set,r=n._nodes.filter(Rt);for(const s of r)e:for(const i of[s].concat(ge(s,void 0)))if(i.always){for(const o of i.always)if(o.guard===void 0||qe(o.guard,n.context,e,n)){t.add(o);break e}}return Or(Array.from(t),new Set(n._nodes),n.historyValue)}function Li(n,e){const t=Be(We(n,e));return Ar(n,[...t])}function Ri(n){return!!n&&typeof n=="object"&&"machine"in n&&"value"in n}const $i=function(e){return mr(e,this.value)},Di=function(e){return this.tags.has(e)},Fi=function(e){const t=this.machine.getTransitionData(this,e);return!!t?.length&&t.some(r=>r.target!==void 0||r.actions.length)},Vi=function(){const{_nodes:e,tags:t,machine:r,getMeta:s,toJSON:i,can:o,hasTag:u,matches:a,...c}=this;return{...c,tags:Array.from(t)}},Bi=function(){return this._nodes.reduce((e,t)=>(t.meta!==void 0&&(e[t.id]=t.meta),e),{})};function Fe(n,e){return{status:n.status,output:n.output,error:n.error,machine:e,context:n.context,_nodes:n._nodes,value:Ar(e.root,n._nodes),tags:new Set(n._nodes.flatMap(t=>t.tags)),children:n.children,historyValue:n.historyValue||{},matches:$i,hasTag:Di,can:Fi,getMeta:Bi,toJSON:Vi}}function K(n,e={}){return Fe({...n,...e},n.machine)}function Ui(n,e){const{_nodes:t,tags:r,machine:s,children:i,context:o,can:u,hasTag:a,matches:c,getMeta:l,toJSON:f,...h}=n,d={};for(const g in i){const y=i[g];d[g]={snapshot:y.getPersistedSnapshot(e),src:y.src,systemId:y._systemId,syncSnapshot:y._syncSnapshot}}return{...h,context:Mr(o),children:d}}function Mr(n){let e;for(const t in n){const r=n[t];if(r&&typeof r=="object")if("sessionId"in r&&"send"in r&&"ref"in r)e??=Array.isArray(n)?n.slice():{...n},e[t]={xstate$$type:Ct,id:r.id};else{const s=Mr(r);s!==r&&(e??=Array.isArray(n)?n.slice():{...n},e[t]=s)}}return e??n}function Wi(n,e,t,r,{event:s,id:i,delay:o},{internalQueue:u}){const a=e.machine.implementations.delays;if(typeof s=="string")throw new Error(`Only event objects may be used with raise; use raise({ type: "${s}" }) instead`);const c=typeof s=="function"?s(t,r):s;let l;if(typeof o=="string"){const f=a&&a[o];l=typeof f=="function"?f(t,r):f}else l=typeof o=="function"?o(t,r):o;return typeof l!="number"&&u.push(c),[e,{event:c,id:i,delay:l},void 0]}function zi(n,e){const{event:t,delay:r,id:s}=e;if(typeof r=="number"){n.defer(()=>{const i=n.self;n.system.scheduler.schedule(i,i,t,r,s)});return}}function Cr(n,e){function t(r,s){}return t.type="xstate.raise",t.event=n,t.id=e?.id,t.delay=e?.delay,t.resolve=Wi,t.execute=zi,t}function qi(n,e){return{config:n,transition:(t,r,s)=>({...t,context:n(t.context,r,s)}),getInitialSnapshot:(t,r)=>({status:"active",output:void 0,error:void 0,context:e}),getPersistedSnapshot:t=>t,restoreSnapshot:t=>t}}const _n=new WeakMap;function Tu(n){return{config:n,start:(t,r)=>{const{self:s,system:i,emit:o}=r,u={receivers:void 0,dispose:void 0};_n.set(s,u),u.dispose=n({input:t.input,system:i,self:s,sendBack:a=>{s.getSnapshot().status!=="stopped"&&s._parent&&i._relay(s,s._parent,a)},receive:a=>{u.receivers??=new Set,u.receivers.add(a)},emit:o})},transition:(t,r,s)=>{const i=_n.get(s.self);return r.type===re?(t={...t,status:"stopped",error:void 0},i.dispose?.(),t):(i.receivers?.forEach(o=>o(r)),t)},getInitialSnapshot:(t,r)=>({status:"active",output:void 0,error:void 0,input:r}),getPersistedSnapshot:t=>t,restoreSnapshot:t=>t}}const Sn="xstate.observable.error",wn="xstate.observable.complete";function Pu(n){return{config:n,transition:(t,r)=>{if(t.status!=="active")return t;switch(r.type){case Sn:return{...t,status:"error",error:r.data,input:void 0,_subscription:void 0};case wn:return{...t,status:"done",input:void 0,_subscription:void 0};case re:return t._subscription.unsubscribe(),{...t,status:"stopped",input:void 0,_subscription:void 0};default:return t}},getInitialSnapshot:(t,r)=>({status:"active",output:void 0,error:void 0,context:void 0,input:r,_subscription:void 0}),start:(t,{self:r,system:s,emit:i})=>{t.status!=="done"&&(t._subscription=n({input:t.input,system:s,self:r,emit:i}).subscribe({next:o=>{r._parent&&s._relay(r,r._parent,o)},error:o=>{s._relay(r,r,{type:Sn,data:o})},complete:()=>{s._relay(r,r,{type:wn})}}))},getPersistedSnapshot:({_subscription:t,...r})=>r,restoreSnapshot:t=>({...t,_subscription:void 0})}}const En="xstate.promise.resolve",xn="xstate.promise.reject",Ce=new WeakMap;function ju(n){return{config:n,transition:(t,r,s)=>{if(t.status!=="active")return t;switch(r.type){case En:{const i=r.data;return{...t,status:"done",output:i,input:void 0}}case xn:return{...t,status:"error",error:r.data,input:void 0};case re:return Ce.get(s.self)?.abort(),{...t,status:"stopped",input:void 0};default:return t}},start:(t,{self:r,system:s,emit:i})=>{if(t.status!=="active")return;const o=new AbortController;Ce.set(r,o),Promise.resolve(n({input:t.input,system:s,self:r,signal:o.signal,emit:i})).then(a=>{r.getSnapshot().status==="active"&&(Ce.delete(r),s._relay(r,r,{type:En,data:a}))},a=>{r.getSnapshot().status==="active"&&(Ce.delete(r),s._relay(r,r,{type:xn,data:a}))})},getInitialSnapshot:(t,r)=>({status:"active",output:void 0,error:void 0,input:r}),getPersistedSnapshot:t=>t,restoreSnapshot:t=>t}}const Gi=qi(n=>{},void 0);function Mu(){return de(Gi)}function Hi(n,{machine:e,context:t},r,s){const i=(o,u)=>{if(typeof o=="string"){const a=Mt(e,o);if(!a)throw new Error(`Actor logic '${o}' not implemented in machine '${e.id}'`);const c=de(a,{id:u?.id,parent:n.self,syncSnapshot:u?.syncSnapshot,input:typeof u?.input=="function"?u.input({context:t,event:r,self:n.self}):u?.input,src:o,systemId:u?.systemId});return s[c.id]=c,c}else return de(o,{id:u?.id,parent:n.self,syncSnapshot:u?.syncSnapshot,input:u?.input,src:o,systemId:u?.systemId})};return(o,u)=>{const a=i(o,u);return s[a.id]=a,n.defer(()=>{a._processingStatus!==O.Stopped&&a.start()}),a}}function Ji(n,e,t,r,{assignment:s}){if(!e.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");const i={},o={context:e.context,event:t.event,spawn:Hi(n,e,t.event,i),self:n.self,system:n.system};let u={};if(typeof s=="function")u=s(o,r);else for(const c of Object.keys(s)){const l=s[c];u[c]=typeof l=="function"?l(o,r):l}const a=Object.assign({},e.context,u);return[K(e,{context:a,children:Object.keys(i).length?{...e.children,...i}:e.children}),void 0,void 0]}function Lr(n){function e(t,r){}return e.type="xstate.assign",e.assignment=n,e.resolve=Ji,e}function Yi(n,e,t,r,{event:s}){const i=typeof s=="function"?s(t,r):s;return[e,{event:i},void 0]}function Xi(n,{event:e}){n.defer(()=>n.emit(e))}function Ki(n){function e(t,r){}return e.type="xstate.emit",e.event=n,e.resolve=Yi,e.execute=Xi,e}let bt=function(n){return n.Parent="#_parent",n.Internal="#_internal",n}({});function Zi(n,e,t,r,{to:s,event:i,id:o,delay:u},a){const c=e.machine.implementations.delays;if(typeof i=="string")throw new Error(`Only event objects may be used with sendTo; use sendTo({ type: "${i}" }) instead`);const l=typeof i=="function"?i(t,r):i;let f;if(typeof u=="string"){const p=c&&c[u];f=typeof p=="function"?p(t,r):p}else f=typeof u=="function"?u(t,r):u;const h=typeof s=="function"?s(t,r):s;let d;if(typeof h=="string"){if(h===bt.Parent?d=n.self._parent:h===bt.Internal?d=n.self:h.startsWith("#_")?d=e.children[h.slice(2)]:d=a.deferredActorIds?.includes(h)?h:e.children[h],!d)throw new Error(`Unable to send event to actor '${h}' from machine '${e.machine.id}'.`)}else d=h||n.self;return[e,{to:d,targetId:typeof h=="string"?h:void 0,event:l,id:o,delay:f},void 0]}function Ni(n,e,t){typeof t.to=="string"&&(t.to=e.children[t.to])}function Qi(n,e){n.defer(()=>{const{to:t,event:r,delay:s,id:i}=e;if(typeof s=="number"){n.system.scheduler.schedule(n.self,t,r,s,i);return}n.system._relay(n.self,t,r.type===ei?gr(n.self.id,r.data):r)})}function Rr(n,e,t){function r(s,i){}return r.type="xstate.sendTo",r.to=n,r.event=e,r.id=t?.id,r.delay=t?.delay,r.resolve=Zi,r.retryResolve=Ni,r.execute=Qi,r}function eo(n,e){return Rr(bt.Parent,n,e)}function to(n,e,t,r,{collect:s}){const i=[],o=function(a){i.push(a)};return o.assign=(...u)=>{i.push(Lr(...u))},o.cancel=(...u)=>{i.push(Sr(...u))},o.raise=(...u)=>{i.push(Cr(...u))},o.sendTo=(...u)=>{i.push(Rr(...u))},o.sendParent=(...u)=>{i.push(eo(...u))},o.spawnChild=(...u)=>{i.push(wr(...u))},o.stopChild=(...u)=>{i.push(Lt(...u))},o.emit=(...u)=>{i.push(Ki(...u))},s({context:t.context,event:t.event,enqueue:o,check:u=>qe(u,e.context,t.event,e),self:n.self,system:n.system},r),[e,void 0,i]}function Cu(n){function e(t,r){}return e.type="xstate.enqueueActions",e.collect=n,e.resolve=to,e}function Lu(n,e){const t=$(e);if(!t.includes(n.type)){const r=t.length===1?`type "${t[0]}"`:`one of types "${t.join('", "')}"`;throw new Error(`Expected event ${JSON.stringify(n)} to have ${r}`)}}const An=new WeakMap;function N(n,e,t){let r=An.get(n);return r?e in r||(r[e]=t()):(r={[e]:t()},An.set(n,r)),r[e]}const no={},le=n=>typeof n=="string"?{type:n}:typeof n=="function"?"resolve"in n?{type:n.type}:{type:n.name}:n;class Vt{constructor(e,t){if(this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=t._parent,this.key=t._key,this.machine=t._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id,...this.path].join(hr),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?pn(this.config.states,(r,s)=>new Vt(r,{_parent:this,_key:s,_machine:this.machine})):no,this.type==="compound"&&!this.config.initial)throw new Error(`No initial state specified for compound state node "#${this.id}". Try adding { initial: "${Object.keys(this.states)[0]}" } to the state config.`);this.history=this.config.history===!0?"shallow":this.config.history||!1,this.entry=$(this.config.entry).slice(),this.exit=$(this.config.exit).slice(),this.meta=this.config.meta,this.output=this.type==="final"||!this.parent?this.config.output:void 0,this.tags=$(e.tags).slice()}_initialize(){this.transitions=vi(this),this.config.always&&(this.always=Q(this.config.always).map(e=>G(this,dr,e))),Object.keys(this.states).forEach(e=>{this.states[e]._initialize()})}get definition(){return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(le),eventType:null,reenter:!1,toJSON:()=>({target:this.initial.target.map(e=>`#${e.id}`),source:`#${this.id}`,actions:this.initial.actions.map(le),eventType:null})}:void 0,history:this.history,states:pn(this.states,e=>e.definition),on:this.on,transitions:[...this.transitions.values()].flat().map(e=>({...e,actions:e.actions.map(le)})),entry:this.entry.map(le),exit:this.exit.map(le),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}toJSON(){return this.definition}get invoke(){return N(this,"invoke",()=>$(this.config.invoke).map((e,t)=>{const{src:r,systemId:s}=e,i=e.id??gn(this.id,t),o=typeof r=="string"?r:`xstate.invoke.${gn(this.id,t)}`;return{...e,src:o,id:i,systemId:s,toJSON(){const{onDone:u,onError:a,...c}=e;return{...c,type:"xstate.invoke",src:o,id:i}}}}))}get on(){return N(this,"on",()=>[...this.transitions].flatMap(([t,r])=>r.map(s=>[t,s])).reduce((t,[r,s])=>(t[r]=t[r]||[],t[r].push(s),t),{}))}get after(){return N(this,"delayedTransitions",()=>mi(this))}get initial(){return N(this,"initial",()=>bi(this,this.config.initial))}next(e,t){const r=t.type,s=[];let i;const o=N(this,`candidates-${r}`,()=>yi(this,r));for(const u of o){const{guard:a}=u,c=e.context;let l=!1;try{l=!a||qe(a,c,t,e)}catch(f){const h=typeof a=="string"?a:typeof a=="object"?a.type:void 0;throw new Error(`Unable to evaluate guard ${h?`'${h}' `:""}in transition for event '${r}' in state node '${this.id}':
${f.message}`)}if(l){s.push(...u.actions),i=u;break}}return i?[i]:void 0}get events(){return N(this,"events",()=>{const{states:e}=this,t=new Set(this.ownEvents);if(e)for(const r of Object.keys(e)){const s=e[r];if(s.states)for(const i of s.events)t.add(`${i}`)}return Array.from(t)})}get ownEvents(){const e=new Set([...this.transitions.keys()].filter(t=>this.transitions.get(t).some(r=>!(!r.target&&!r.actions.length&&!r.reenter))));return Array.from(e)}}const ro="#";class Bt{constructor(e,t){this.config=e,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.id=e.id||"(machine)",this.implementations={actors:t?.actors??{},actions:t?.actions??{},delays:t?.delays??{},guards:t?.guards??{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new Vt(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}provide(e){const{actions:t,guards:r,actors:s,delays:i}=this.implementations;return new Bt(this.config,{actions:{...t,...e.actions},guards:{...r,...e.guards},actors:{...s,...e.actors},delays:{...i,...e.delays}})}resolveState(e){const t=Li(this.root,e.value),r=Be(We(this.root,t));return Fe({_nodes:[...r],context:e.context||{},children:{},status:$t(r,this.root)?"done":e.status||"active",output:e.output,error:e.error,historyValue:e.historyValue},this)}transition(e,t,r){return ot(e,t,r,[]).snapshot}microstep(e,t,r){return ot(e,t,r,[]).microstates}getTransitionData(e,t){return Dt(this.root,e.value,e,t)||[]}getPreInitialState(e,t,r){const{context:s}=this.config,i=Fe({context:typeof s!="function"&&s?s:{},_nodes:[this.root],children:{},status:"active"},this);return typeof s=="function"?oe(i,t,e,[Lr(({spawn:u,event:a,self:c})=>s({spawn:u,input:a.input,self:c}))],r,void 0):i}getInitialSnapshot(e,t){const r=yr(t),s=[],i=this.getPreInitialState(e,r,s),o=vt([{target:[...Ir(this.root)],source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],i,e,r,!0,s),{snapshot:u}=ot(o,r,e,s);return u}start(e){Object.values(e.children).forEach(t=>{t.getSnapshot().status==="active"&&t.start()})}getStateNodeById(e){const t=jt(e),r=t.slice(1),s=Ge(t[0])?t[0].slice(ro.length):t[0],i=this.idMap.get(s);if(!i)throw new Error(`Child state node '#${s}' does not exist on machine '${this.id}'`);return Ue(i,r)}get definition(){return this.root.definition}toJSON(){return this.definition}getPersistedSnapshot(e,t){return Ui(e,t)}restoreSnapshot(e,t){const r={},s=e.children;Object.keys(s).forEach(a=>{const c=s[a],l=c.snapshot,f=c.src,h=typeof f=="string"?Mt(this,f):f;if(!h)return;const d=de(h,{id:a,parent:t.self,syncSnapshot:c.syncSnapshot,snapshot:l,src:f,systemId:c.systemId});r[a]=d});const i=Fe({...e,children:r,_nodes:Array.from(Be(We(this.root,e.value)))},this),o=new Set;function u(a,c){if(!o.has(a)){o.add(a);for(const l in a){const f=a[l];if(f&&typeof f=="object"){if("xstate$$type"in f&&f.xstate$$type===Ct){a[l]=c[f.id];continue}u(f,c)}}}}return u(i.context,r),i}}function so(n,e){return new Bt(n,e)}function Ru({schemas:n,actors:e,actions:t,guards:r,delays:s}){return{createMachine:i=>so({...i,schemas:n},{actors:e,actions:t,guards:r,delays:s})}}function ye(n){const[e,t]=n;return[e,t]}function kn(n,e){let t=n,r=e;const s=t.length,i=r.length;if(s===0||i===0)return 0;s>i?t=t.substring(s-i):s<i&&(r=r.substring(0,s));const o=Math.min(s,i);if(t===r)return o;let u=0,a=1;for(let c=0;c!==-1;){const l=t.substring(o-a);if(c=r.indexOf(l),c===-1)return u;a+=c,(c===0||t.substring(o-a)===r.substring(0,a))&&(u=a,a++)}return u}function Ut(n,e){if(!n||!e||n[0]!==e[0])return 0;let t=0,r=Math.min(n.length,e.length),s=r,i=0;for(;t<s;)n.substring(i,s)===e.substring(i,s)?(t=s,i=t):r=s,s=Math.floor((r-t)/2+t);return s}function He(n,e){if(!n||!e||n[n.length-1]!==e[e.length-1])return 0;let t=0,r=Math.min(n.length,e.length),s=r,i=0;for(;t<s;)n.substring(n.length-s,n.length-i)===e.substring(e.length-s,e.length-i)?(t=s,i=t):r=s,s=Math.floor((r-t)/2+t);return s}function io(n){const e=n.charCodeAt(0);return e>=55296&&e<=56319}function _t(n){const e=n.charCodeAt(0);return e>=56320&&e<=57343}function oo(n,e,t){const r=n.length,s=e.length,i=Math.ceil((r+s)/2),o=i,u=2*i,a=new Array(u),c=new Array(u);for(let y=0;y<u;y++)a[y]=-1,c[y]=-1;a[o+1]=0,c[o+1]=0;const l=r-s,f=l%2!==0;let h=0,d=0,p=0,g=0;for(let y=0;y<i&&!(Date.now()>t);y++){for(let m=-y+h;m<=y-d;m+=2){const v=o+m;let b;m===-y||m!==y&&a[v-1]<a[v+1]?b=a[v+1]:b=a[v-1]+1;let S=b-m;for(;b<r&&S<s&&n.charAt(b)===e.charAt(S);)b++,S++;if(a[v]=b,b>r)d+=2;else if(S>s)h+=2;else if(f){const k=o+l-m;if(k>=0&&k<u&&c[k]!==-1){const I=r-c[k];if(b>=I)return In(n,e,b,S,t)}}}for(let m=-y+p;m<=y-g;m+=2){const v=o+m;let b;m===-y||m!==y&&c[v-1]<c[v+1]?b=c[v+1]:b=c[v-1]+1;let S=b-m;for(;b<r&&S<s&&n.charAt(r-b-1)===e.charAt(s-S-1);)b++,S++;if(c[v]=b,b>r)g+=2;else if(S>s)p+=2;else if(!f){const k=o+l-m;if(k>=0&&k<u&&a[k]!==-1){const I=a[k],ae=o+I-k;if(b=r-b,I>=b)return In(n,e,I,ae,t)}}}}return[[x,n],[A,e]]}function In(n,e,t,r,s){const i=n.substring(0,t),o=e.substring(0,r),u=n.substring(t),a=e.substring(r),c=Z(i,o,{checkLines:!1,deadline:s}),l=Z(u,a,{checkLines:!1,deadline:s});return c.concat(l)}function uo(n,e,t=1){if(t<=0)return null;const r=n.length>e.length?n:e,s=n.length>e.length?e:n;if(r.length<4||s.length*2<r.length)return null;const i=On(r,s,Math.ceil(r.length/4)),o=On(r,s,Math.ceil(r.length/2));let u;if(i&&o)u=i[4].length>o[4].length?i:o;else{if(!i&&!o)return null;o?i||(u=o):u=i}if(!u)throw new Error("Unable to find a half match.");let a,c,l,f;n.length>e.length?(a=u[0],c=u[1],l=u[2],f=u[3]):(l=u[0],f=u[1],a=u[2],c=u[3]);const h=u[4];return[a,c,l,f,h]}function On(n,e,t){const r=n.slice(t,t+Math.floor(n.length/4));let s=-1,i="",o,u,a,c;for(;(s=e.indexOf(r,s+1))!==-1;){const l=Ut(n.slice(t),e.slice(s)),f=He(n.slice(0,t),e.slice(0,s));i.length<f+l&&(i=e.slice(s-f,s)+e.slice(s,s+l),o=n.slice(0,t-f),u=n.slice(t+l),a=e.slice(0,s-f),c=e.slice(s+l))}return i.length*2>=n.length?[o||"",u||"",a||"",c||"",i||""]:null}function ao(n,e){for(let t=0;t<n.length;t++){const r=n[t][1],s=[];for(let i=0;i<r.length;i++)s[i]=e[r.charCodeAt(i)];n[t][1]=s.join("")}}function co(n,e){const t=[],r={};t[0]="";function s(a){let c="",l=0,f=-1,h=t.length;for(;f<a.length-1;){f=a.indexOf(`
`,l),f===-1&&(f=a.length-1);let d=a.slice(l,f+1);(r.hasOwnProperty?r.hasOwnProperty(d):r[d]!==void 0)?c+=String.fromCharCode(r[d]):(h===i&&(d=a.slice(l),f=a.length),c+=String.fromCharCode(h),r[d]=h,t[h++]=d),l=f+1}return c}let i=4e4;const o=s(n);i=65535;const u=s(e);return{chars1:o,chars2:u,lineArray:t}}function lo(n,e,t){let r=n,s=e;const i=co(r,s);r=i.chars1,s=i.chars2;const o=i.lineArray;let u=Z(r,s,{checkLines:!1,deadline:t.deadline});ao(u,o),u=Dr(u),u.push([_,""]);let a=0,c=0,l=0,f="",h="";for(;a<u.length;){switch(u[a][0]){case A:l++,h+=u[a][1];break;case x:c++,f+=u[a][1];break;case _:if(c>=1&&l>=1){u.splice(a-c-l,c+l),a=a-c-l;const d=Z(f,h,{checkLines:!1,deadline:t.deadline});for(let p=d.length-1;p>=0;p--)u.splice(a,0,d[p]);a+=d.length}l=0,c=0,f="",h="";break;default:throw new Error("Unknown diff operation.")}a++}return u.pop(),u}function fo(n,e,t){let r;if(!n)return[[A,e]];if(!e)return[[x,n]];const s=n.length>e.length?n:e,i=n.length>e.length?e:n,o=s.indexOf(i);if(o!==-1)return r=[[A,s.substring(0,o)],[_,i],[A,s.substring(o+i.length)]],n.length>e.length&&(r[0][0]=x,r[2][0]=x),r;if(i.length===1)return[[x,n],[A,e]];const u=uo(n,e);if(u){const a=u[0],c=u[1],l=u[2],f=u[3],h=u[4],d=Z(a,l,t),p=Z(c,f,t);return d.concat([[_,h]],p)}return t.checkLines&&n.length>100&&e.length>100?lo(n,e,t):oo(n,e,t.deadline)}var ho=Object.defineProperty,Tn=Object.getOwnPropertySymbols,po=Object.prototype.hasOwnProperty,go=Object.prototype.propertyIsEnumerable,Pn=(n,e,t)=>e in n?ho(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,yo=(n,e)=>{for(var t in e||(e={}))po.call(e,t)&&Pn(n,t,e[t]);if(Tn)for(var t of Tn(e))go.call(e,t)&&Pn(n,t,e[t]);return n};const x=-1,A=1,_=0;function $r(n,e,t){if(n===null||e===null)throw new Error("Null input. (diff)");const r=Z(n,e,vo(t||{}));return _o(r),r}function Z(n,e,t){let r=n,s=e;if(r===s)return r?[[_,r]]:[];let i=Ut(r,s);const o=r.substring(0,i);r=r.substring(i),s=s.substring(i),i=He(r,s);const u=r.substring(r.length-i);r=r.substring(0,r.length-i),s=s.substring(0,s.length-i);let a=fo(r,s,t);return o&&a.unshift([_,o]),u&&a.push([_,u]),a=Je(a),a}function mo(n){let e=1;return typeof n<"u"&&(e=n<=0?Number.MAX_VALUE:n),Date.now()+e*1e3}function vo(n){return yo({checkLines:!0,deadline:mo(n.timeout||1)},n)}function Le(n,e,t){return t===1?n+e:e+n}function Re(n,e){return e===1?[n.substring(0,n.length-1),n[n.length-1]]:[n.substring(1),n[0]]}function bo(n,e,t,r){return r===1?n[e][1][n[e][1].length-1]===n[t][1][n[t][1].length-1]:n[e][1][0]===n[t][1][0]}function jn(n,e,t){const r=t===1?-1:1;let s=null,i=null,o=e+t;for(;o>=0&&o<n.length&&(s===null||i===null);o+=t){const[c,l]=n[o];if(l.length!==0){if(c===A){s===null&&(s=o);continue}else if(c===x){i===null&&(i=o);continue}else if(c===_){if(s===null&&i===null){const[f,h]=Re(n[e][1],t);n[e][1]=f,n[o][1]=Le(n[o][1],h,r);return}break}}}if(s!==null&&i!==null&&bo(n,s,i,t)){const[c,l]=Re(n[s][1],r),[f]=Re(n[i][1],r);n[s][1]=c,n[i][1]=f,n[e][1]=Le(n[e][1],l,t);return}const[u,a]=Re(n[e][1],t);n[e][1]=u,s===null?(n.splice(o,0,[A,a]),i!==null&&i>=o&&i++):n[s][1]=Le(n[s][1],a,r),i===null?n.splice(o,0,[x,a]):n[i][1]=Le(n[i][1],a,r)}function _o(n){for(let e=0;e<n.length;e++){const[t,r]=n[e];if(r.length===0)continue;const s=r[0],i=r[r.length-1];io(i)&&t===_&&jn(n,e,1),_t(s)&&t===_&&jn(n,e,-1)}for(let e=0;e<n.length;e++)n[e][1].length===0&&n.splice(e,1)}function Dr(n){let e=n.map(f=>ye(f)),t=!1;const r=[];let s=0,i=null,o=0,u=0,a=0,c=0,l=0;for(;o<e.length;)e[o][0]===_?(r[s++]=o,u=c,a=l,c=0,l=0,i=e[o][1]):(e[o][0]===A?c+=e[o][1].length:l+=e[o][1].length,i&&i.length<=Math.max(u,a)&&i.length<=Math.max(c,l)&&(e.splice(r[s-1],0,[x,i]),e[r[s-1]+1][0]=A,s--,s--,o=s>0?r[s-1]:-1,u=0,a=0,c=0,l=0,i=null,t=!0)),o++;for(t&&(e=Je(e)),e=Fr(e),o=1;o<e.length;){if(e[o-1][0]===x&&e[o][0]===A){const f=e[o-1][1],h=e[o][1],d=kn(f,h),p=kn(h,f);d>=p?(d>=f.length/2||d>=h.length/2)&&(e.splice(o,0,[_,h.substring(0,d)]),e[o-1][1]=f.substring(0,f.length-d),e[o+1][1]=h.substring(d),o++):(p>=f.length/2||p>=h.length/2)&&(e.splice(o,0,[_,f.substring(0,p)]),e[o-1][0]=A,e[o-1][1]=h.substring(0,h.length-p),e[o+1][0]=x,e[o+1][1]=f.substring(p),o++),o++}o++}return e}const Mn=/[^a-zA-Z0-9]/,Cn=/\s/,Ln=/[\r\n]/,So=/\n\r?\n$/,wo=/^\r?\n\r?\n/;function Fr(n){const e=n.map(s=>ye(s));function t(s,i){if(!s||!i)return 6;const o=s.charAt(s.length-1),u=i.charAt(0),a=o.match(Mn),c=u.match(Mn),l=a&&o.match(Cn),f=c&&u.match(Cn),h=l&&o.match(Ln),d=f&&u.match(Ln),p=h&&s.match(So),g=d&&i.match(wo);return p||g?5:h||d?4:a&&!l&&f?3:l||f?2:a||c?1:0}let r=1;for(;r<e.length-1;){if(e[r-1][0]===_&&e[r+1][0]===_){let s=e[r-1][1],i=e[r][1],o=e[r+1][1];const u=He(s,i);if(u){const h=i.substring(i.length-u);s=s.substring(0,s.length-u),i=h+i.substring(0,i.length-u),o=h+o}let a=s,c=i,l=o,f=t(s,i)+t(i,o);for(;i.charAt(0)===o.charAt(0);){s+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);const h=t(s,i)+t(i,o);h>=f&&(f=h,a=s,c=i,l=o)}e[r-1][1]!==a&&(a?e[r-1][1]=a:(e.splice(r-1,1),r--),e[r][1]=c,l?e[r+1][1]=l:(e.splice(r+1,1),r--))}r++}return e}function Je(n){let e=n.map(c=>ye(c));e.push([_,""]);let t=0,r=0,s=0,i="",o="",u;for(;t<e.length;)switch(e[t][0]){case A:s++,o+=e[t][1],t++;break;case x:r++,i+=e[t][1],t++;break;case _:r+s>1?(r!==0&&s!==0&&(u=Ut(o,i),u!==0&&(t-r-s>0&&e[t-r-s-1][0]===_?e[t-r-s-1][1]+=o.substring(0,u):(e.splice(0,0,[_,o.substring(0,u)]),t++),o=o.substring(u),i=i.substring(u)),u=He(o,i),u!==0&&(e[t][1]=o.substring(o.length-u)+e[t][1],o=o.substring(0,o.length-u),i=i.substring(0,i.length-u))),t-=r+s,e.splice(t,r+s),i.length&&(e.splice(t,0,[x,i]),t++),o.length&&(e.splice(t,0,[A,o]),t++),t++):t!==0&&e[t-1][0]===_?(e[t-1][1]+=e[t][1],e.splice(t,1)):t++,s=0,r=0,i="",o="";break;default:throw new Error("Unknown diff operation")}e[e.length-1][1]===""&&e.pop();let a=!1;for(t=1;t<e.length-1;)e[t-1][0]===_&&e[t+1][0]===_&&(e[t][1].substring(e[t][1].length-e[t-1][1].length)===e[t-1][1]?(e[t][1]=e[t-1][1]+e[t][1].substring(0,e[t][1].length-e[t-1][1].length),e[t+1][1]=e[t-1][1]+e[t+1][1],e.splice(t-1,1),a=!0):e[t][1].substring(0,e[t+1][1].length)===e[t+1][1]&&(e[t-1][1]+=e[t+1][1],e[t][1]=e[t][1].substring(e[t+1][1].length)+e[t+1][1],e.splice(t+1,1),a=!0)),t++;return a&&(e=Je(e)),e}function Eo(...n){return n.reduce((e,t)=>e+(t?1:0),0)}function xo(n,e=4){let t=n.map(h=>ye(h)),r=!1;const s=[];let i=0,o=null,u=0,a=!1,c=!1,l=!1,f=!1;for(;u<t.length;)t[u][0]===_?(t[u][1].length<e&&(l||f)?(s[i++]=u,a=l,c=f,o=t[u][1]):(i=0,o=null),l=!1,f=!1):(t[u][0]===x?f=!0:l=!0,o&&(a&&c&&l&&f||o.length<e/2&&Eo(a,c,l,f)===3)&&(t.splice(s[i-1],0,[x,o]),t[s[i-1]+1][0]=A,i--,o=null,a&&c?(l=!0,f=!0,i=0):(i--,u=i>0?s[i-1]:-1,l=!1,f=!1),r=!0)),u++;return r&&(t=Je(t)),t}var Ao=Object.defineProperty,Rn=Object.getOwnPropertySymbols,ko=Object.prototype.hasOwnProperty,Io=Object.prototype.propertyIsEnumerable,$n=(n,e,t)=>e in n?Ao(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Dn=(n,e)=>{for(var t in e||(e={}))ko.call(e,t)&&$n(n,t,e[t]);if(Rn)for(var t of Rn(e))Io.call(e,t)&&$n(n,t,e[t]);return n};const Oo={threshold:.5,distance:1e3};function To(n){return Dn(Dn({},Oo),n)}const Po=32;function jo(n,e,t,r={}){if(e.length>Po)throw new Error("Pattern too long for this browser.");const s=To(r),i=Mo(e);function o(p,g){const y=p/e.length,m=Math.abs(t-g);return s.distance?y+m/s.distance:m?1:y}let u=s.threshold,a=n.indexOf(e,t);a!==-1&&(u=Math.min(o(0,a),u),a=n.lastIndexOf(e,t+e.length),a!==-1&&(u=Math.min(o(0,a),u)));const c=1<<e.length-1;a=-1;let l,f,h=e.length+n.length,d=[];for(let p=0;p<e.length;p++){for(l=0,f=h;l<f;)o(p,t+f)<=u?l=f:h=f,f=Math.floor((h-l)/2+l);h=f;let g=Math.max(1,t-f+1);const y=Math.min(t+f,n.length)+e.length,m=new Array(y+2);m[y+1]=(1<<p)-1;for(let v=y;v>=g;v--){const b=i[n.charAt(v-1)];if(p===0?m[v]=(m[v+1]<<1|1)&b:m[v]=(m[v+1]<<1|1)&b|((d[v+1]|d[v])<<1|1)|d[v+1],m[v]&c){const S=o(p,v-1);if(S<=u)if(u=S,a=v-1,a>t)g=Math.max(1,2*t-a);else break}}if(o(p+1,t)>u)break;d=m}return a}function Mo(n){const e={};for(let t=0;t<n.length;t++)e[n.charAt(t)]=0;for(let t=0;t<n.length;t++)e[n.charAt(t)]|=1<<n.length-t-1;return e}function ut(n,e,t,r={}){if(n===null||e===null||t===null)throw new Error("Null input. (match())");const s=Math.max(0,Math.min(t,n.length));if(n===e)return 0;if(n.length){if(n.substring(s,s+e.length)===e)return s}else return-1;return jo(n,e,s,r)}function Wt(n){const e=[];for(let t=0;t<n.length;t++)n[t][0]!==A&&(e[t]=n[t][1]);return e.join("")}function Vr(n){const e=[];for(let t=0;t<n.length;t++)n[t][0]!==x&&(e[t]=n[t][1]);return e.join("")}function Co(n){let e=0,t=0,r=0;for(let s=0;s<n.length;s++){const i=n[s][0],o=n[s][1];switch(i){case A:t+=o.length;break;case x:r+=o.length;break;case _:e+=Math.max(t,r),t=0,r=0;break;default:throw new Error("Unknown diff operation.")}}return e+=Math.max(t,r),e}function Fn(n,e){let t=0,r=0,s=0,i=0,o;for(o=0;o<n.length&&(n[o][0]!==A&&(t+=n[o][1].length),n[o][0]!==x&&(r+=n[o][1].length),!(t>e));o++)s=t,i=r;return n.length!==o&&n[o][0]===x?i:i+(e-s)}function B(n){let e=0;for(let t=0;t<n.length;t++){const r=n.codePointAt(t);if(typeof r>"u")throw new Error("Failed to get codepoint");e+=Br(r)}return e}function Lo(n,e,t={}){let r=0,s=0;function i(u){for(;r<u;){const a=e.codePointAt(s);if(typeof a>"u")return s;r+=Br(a),a>65535?s+=2:s+=1}if(!t.allowExceedingIndices&&r!==u)throw new Error("Failed to determine byte offset");return s}const o=[];for(const u of n)o.push({diffs:u.diffs.map(a=>ye(a)),start1:i(u.start1),start2:i(u.start2),utf8Start1:u.utf8Start1,utf8Start2:u.utf8Start2,length1:u.length1,length2:u.length2,utf8Length1:u.utf8Length1,utf8Length2:u.utf8Length2});return o}function Br(n){return n<=127?1:n<=2047?2:n<=65535?3:4}const V=32,zt=4;function Ro(n,e=zt){const t=e;let r="";for(let o=1;o<=t;o++)r+=String.fromCharCode(o);for(const o of n)o.start1+=t,o.start2+=t,o.utf8Start1+=t,o.utf8Start2+=t;let s=n[0],i=s.diffs;if(i.length===0||i[0][0]!==_)i.unshift([_,r]),s.start1-=t,s.start2-=t,s.utf8Start1-=t,s.utf8Start2-=t,s.length1+=t,s.length2+=t,s.utf8Length1+=t,s.utf8Length2+=t;else if(t>i[0][1].length){const o=i[0][1].length,u=t-o;i[0][1]=r.substring(o)+i[0][1],s.start1-=u,s.start2-=u,s.utf8Start1-=u,s.utf8Start2-=u,s.length1+=u,s.length2+=u,s.utf8Length1+=u,s.utf8Length2+=u}if(s=n[n.length-1],i=s.diffs,i.length===0||i[i.length-1][0]!==_)i.push([_,r]),s.length1+=t,s.length2+=t,s.utf8Length1+=t,s.utf8Length2+=t;else if(t>i[i.length-1][1].length){const o=t-i[i.length-1][1].length;i[i.length-1][1]+=r.substring(0,o),s.length1+=o,s.length2+=o,s.utf8Length1+=o,s.utf8Length2+=o}return r}function ze(n,e){return{diffs:[],start1:n,start2:e,utf8Start1:n,utf8Start2:e,length1:0,length2:0,utf8Length1:0,utf8Length2:0}}function $o(n,e=zt){const t=V;for(let r=0;r<n.length;r++){if(n[r].length1<=t)continue;const s=n[r];n.splice(r--,1);let i=s.start1,o=s.start2,u="";for(;s.diffs.length!==0;){const a=ze(i-u.length,o-u.length);let c=!0;if(u!==""){const h=B(u);a.length1=u.length,a.utf8Length1=h,a.length2=u.length,a.utf8Length2=h,a.diffs.push([_,u])}for(;s.diffs.length!==0&&a.length1<t-e;){const h=s.diffs[0][0];let d=s.diffs[0][1],p=B(d);if(h===A){a.length2+=d.length,a.utf8Length2+=p,o+=d.length;const g=s.diffs.shift();g&&a.diffs.push(g),c=!1}else h===x&&a.diffs.length===1&&a.diffs[0][0]===_&&d.length>2*t?(a.length1+=d.length,a.utf8Length1+=p,i+=d.length,c=!1,a.diffs.push([h,d]),s.diffs.shift()):(d=d.substring(0,t-a.length1-e),p=B(d),a.length1+=d.length,a.utf8Length1+=p,i+=d.length,h===_?(a.length2+=d.length,a.utf8Length2+=p,o+=d.length):c=!1,a.diffs.push([h,d]),d===s.diffs[0][1]?s.diffs.shift():s.diffs[0][1]=s.diffs[0][1].substring(d.length))}u=Vr(a.diffs),u=u.substring(u.length-e);const l=Wt(s.diffs).substring(0,e),f=B(l);l!==""&&(a.length1+=l.length,a.length2+=l.length,a.utf8Length1+=f,a.utf8Length2+=f,a.diffs.length!==0&&a.diffs[a.diffs.length-1][0]===_?a.diffs[a.diffs.length-1][1]+=l:a.diffs.push([_,l])),c||n.splice(++r,0,a)}}}function $u(n,e,t={}){if(typeof n=="string")throw new Error("Patches must be an array - pass the patch to `parsePatch()` first");let r=e;if(n.length===0)return[r,[]];const s=Lo(n,r,{allowExceedingIndices:t.allowExceedingIndices}),i=t.margin||zt,o=t.deleteThreshold||.4,u=Ro(s,i);r=u+r+u,$o(s,i);let a=0;const c=[];for(let l=0;l<s.length;l++){const f=s[l].start2+a,h=Wt(s[l].diffs);let d,p=-1;if(h.length>V?(d=ut(r,h.substring(0,V),f),d!==-1&&(p=ut(r,h.substring(h.length-V),f+h.length-V),(p===-1||d>=p)&&(d=-1))):d=ut(r,h,f),d===-1)c[l]=!1,a-=s[l].length2-s[l].length1;else{c[l]=!0,a=d-f;let g;if(p===-1?g=r.substring(d,d+h.length):g=r.substring(d,p+V),h===g)r=r.substring(0,d)+Vr(s[l].diffs)+r.substring(d+h.length);else{let y=$r(h,g,{checkLines:!1});if(h.length>V&&Co(y)/h.length>o)c[l]=!1;else{y=Fr(y);let m=0,v=0;for(let b=0;b<s[l].diffs.length;b++){const S=s[l].diffs[b];S[0]!==_&&(v=Fn(y,m)),S[0]===A?r=r.substring(0,d+v)+S[1]+r.substring(d+v):S[0]===x&&(r=r.substring(0,d+v)+r.substring(d+Fn(y,m+S[1].length))),S[0]!==x&&(m+=S[1].length)}}}}}return r=r.substring(u.length,r.length-u.length),[r,c]}var Do=Object.defineProperty,Vn=Object.getOwnPropertySymbols,Fo=Object.prototype.hasOwnProperty,Vo=Object.prototype.propertyIsEnumerable,Bn=(n,e,t)=>e in n?Do(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Un=(n,e)=>{for(var t in e||(e={}))Fo.call(e,t)&&Bn(n,t,e[t]);if(Vn)for(var t of Vn(e))Vo.call(e,t)&&Bn(n,t,e[t]);return n};const Bo={margin:4};function at(n={}){return Un(Un({},Bo),n)}function Du(n,e,t){if(typeof n=="string"&&typeof e=="string"){let r=$r(n,e,{checkLines:!0});return r.length>2&&(r=Dr(r),r=xo(r)),ct(n,r,at(t))}if(n&&Array.isArray(n)&&typeof e>"u")return ct(Wt(n),n,at(t));if(typeof n=="string"&&e&&Array.isArray(e))return ct(n,e,at(t));throw new Error("Unknown call format to make()")}function ct(n,e,t){if(e.length===0)return[];const r=[];let s=ze(0,0),i=0,o=0,u=0,a=0,c=0,l=n,f=n;for(let h=0;h<e.length;h++){const d=e[h],[p,g]=d,y=g.length,m=B(g);switch(!i&&p!==_&&(s.start1=o,s.start2=u,s.utf8Start1=a,s.utf8Start2=c),p){case A:s.diffs[i++]=d,s.length2+=y,s.utf8Length2+=m,f=f.substring(0,u)+g+f.substring(u);break;case x:s.length1+=y,s.utf8Length1+=m,s.diffs[i++]=d,f=f.substring(0,u)+f.substring(u+y);break;case _:y<=2*t.margin&&i&&e.length!==h+1?(s.diffs[i++]=d,s.length1+=y,s.length2+=y,s.utf8Length1+=m,s.utf8Length2+=m):y>=2*t.margin&&i&&(Wn(s,l,t),r.push(s),s=ze(-1,-1),i=0,l=f,o=u,a=c);break;default:throw new Error("Unknown diff type")}p!==A&&(o+=y,a+=m),p!==x&&(u+=y,c+=m)}return i&&(Wn(s,l,t),r.push(s)),r}function Wn(n,e,t){if(e.length===0)return;let r=e.substring(n.start2,n.start2+n.length1),s=0;for(;e.indexOf(r)!==e.lastIndexOf(r)&&r.length<V-t.margin-t.margin;)s+=t.margin,r=e.substring(n.start2-s,n.start2+n.length1+s);s+=t.margin;let i=n.start2-s;i>=1&&_t(e[i])&&i--;const o=e.substring(i,n.start2);o&&n.diffs.unshift([_,o]);const u=o.length,a=B(o);let c=n.start2+n.length1+s;c<e.length&&_t(e[c])&&c++;const l=e.substring(n.start2+n.length1,c);l&&n.diffs.push([_,l]);const f=l.length,h=B(l);n.start1-=u,n.start2-=u,n.utf8Start1-=a,n.utf8Start2-=a,n.length1+=u+f,n.length2+=u+f,n.utf8Length1+=a+h,n.utf8Length2+=a+h}const Uo=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;function Fu(n){if(!n)return[];const e=[],t=n.split(`
`);let r=0;for(;r<t.length;){const s=t[r].match(Uo);if(!s)throw new Error(`Invalid patch string: ${t[r]}`);const i=ze($e(s[1]),$e(s[3]));for(e.push(i),s[2]===""?(i.start1--,i.utf8Start1--,i.length1=1,i.utf8Length1=1):s[2]==="0"?(i.length1=0,i.utf8Length1=0):(i.start1--,i.utf8Start1--,i.utf8Length1=$e(s[2]),i.length1=i.utf8Length1),s[4]===""?(i.start2--,i.utf8Start2--,i.length2=1,i.utf8Length2=1):s[4]==="0"?(i.length2=0,i.utf8Length2=0):(i.start2--,i.utf8Start2--,i.utf8Length2=$e(s[4]),i.length2=i.utf8Length2),r++;r<t.length;){const o=t[r],u=o.charAt(0);if(u==="@")break;if(u===""){r++;continue}let a;try{a=decodeURI(o.slice(1))}catch{throw new Error(`Illegal escape in parse: ${o}`)}const c=B(a)-a.length;if(u==="-")i.diffs.push([x,a]),i.length1-=c;else if(u==="+")i.diffs.push([A,a]),i.length2-=c;else if(u===" ")i.diffs.push([_,a]),i.length1-=c,i.length2-=c;else throw new Error(`Invalid patch mode "${u}" in: ${a}`);r++}}return e}function $e(n){return parseInt(n,10)}function Vu(n){return n.map(Wo).join("")}function Wo(n){const{utf8Length1:e,utf8Length2:t,utf8Start1:r,utf8Start2:s,diffs:i}=n;let o;e===0?o=`${r},0`:e===1?o=`${r+1}`:o=`${r+1},${e}`;let u;t===0?u=`${s},0`:t===1?u=`${s+1}`:u=`${s+1},${t}`;const a=[`@@ -${o} +${u} @@
`];let c;for(let l=0;l<i.length;l++){switch(i[l][0]){case A:c="+";break;case x:c="-";break;case _:c=" ";break;default:throw new Error("Unknown patch operation.")}a[l+1]=`${c+encodeURI(i[l][1])}
`}return a.join("").replace(/%20/g," ")}const zo=["Value","Copy","Blank","ReturnIntoArray","ReturnIntoObject","ReturnIntoObjectSameKey","PushField","PushElement","PushParent","Pop","PushFieldCopy","PushFieldBlank","PushElementCopy","PushElementBlank","ReturnIntoObjectPop","ReturnIntoObjectSameKeyPop","ReturnIntoArrayPop","ObjectSetFieldValue","ObjectCopyField","ObjectDeleteField","ArrayAppendValue","ArrayAppendSlice","StringAppendString","StringAppendSlice"];class Ur{model;root;patch;i;inputStack;outputStack;constructor(e,t,r){this.model=e,this.root=t,this.patch=r,this.i=0,this.inputStack=[],this.outputStack=[]}read(){return this.patch[this.i++]}process(){for(this.inputStack.push({value:this.root}),this.outputStack.push({value:this.root});this.i<this.patch.length;){let t=this.read(),r=zo[t];if(!r)throw new Error(`Unknown opcode: ${t}`);let s=`process${r}`;this[s].apply(this)}let e=this.outputStack.pop();return this.finalizeOutput(e)}inputEntry(){return this.inputStack[this.inputStack.length-1]}inputKey(e,t){return e.keys||(e.keys=this.model.objectGetKeys(e.value).sort()),e.keys[t]}outputEntry(){return this.outputStack[this.outputStack.length-1]}outputArray(){let e=this.outputEntry();return e.writeValue||(e.writeValue=this.model.copyArray(e.value)),e.writeValue}outputObject(){let e=this.outputEntry();return e.writeValue||(e.writeValue=this.model.copyObject(e.value)),e.writeValue}outputString(){let e=this.outputEntry();return e.writeValue||(e.writeValue=this.model.copyString(e.value)),e.writeValue}finalizeOutput(e){return e.writeValue?this.model.finalize(e.writeValue):e.value}processValue(){let e=this.model.wrap(this.read());this.outputStack.push({value:e})}processCopy(){let e=this.inputEntry();this.outputStack.push({value:e.value})}processBlank(){this.outputStack.push({value:null})}processReturnIntoArray(){let e=this.outputStack.pop(),t=this.finalizeOutput(e),r=this.outputArray();this.model.arrayAppendValue(r,t)}processReturnIntoObject(){let e=this.read(),t=this.outputStack.pop(),r=this.finalizeOutput(t);r=this.model.markChanged(r);let s=this.outputObject();this.model.objectSetField(s,e,r)}processReturnIntoObjectSameKey(){let e=this.inputEntry(),t=this.outputStack.pop(),r=this.finalizeOutput(t),s=this.outputObject();this.model.objectSetField(s,e.key,r)}processPushField(){let e=this.read(),t=this.inputEntry(),r=this.inputKey(t,e),s=this.model.objectGetField(t.value,r);this.inputStack.push({value:s,key:r})}processPushElement(){let e=this.read(),t=this.inputEntry(),r=this.model.arrayGetElement(t.value,e);this.inputStack.push({value:r})}processPop(){this.inputStack.pop()}processPushFieldCopy(){this.processPushField(),this.processCopy()}processPushFieldBlank(){this.processPushField(),this.processBlank()}processPushElementCopy(){this.processPushElement(),this.processCopy()}processPushElementBlank(){this.processPushElement(),this.processBlank()}processReturnIntoObjectPop(){this.processReturnIntoObject(),this.processPop()}processReturnIntoObjectSameKeyPop(){this.processReturnIntoObjectSameKey(),this.processPop()}processReturnIntoArrayPop(){this.processReturnIntoArray(),this.processPop()}processObjectSetFieldValue(){this.processValue(),this.processReturnIntoObject()}processObjectCopyField(){this.processPushField(),this.processCopy(),this.processReturnIntoObjectSameKey(),this.processPop()}processObjectDeleteField(){let e=this.read(),t=this.inputEntry(),r=this.inputKey(t,e),s=this.outputObject();this.model.objectDeleteField(s,r)}processArrayAppendValue(){let e=this.model.wrap(this.read()),t=this.outputArray();this.model.arrayAppendValue(t,e)}processArrayAppendSlice(){let e=this.read(),t=this.read(),r=this.outputArray(),s=this.inputEntry().value;this.model.arrayAppendSlice(r,s,e,t)}processStringAppendString(){let e=this.model.wrap(this.read()),t=this.outputString();this.model.stringAppendValue(t,e)}processStringAppendSlice(){let e=this.read(),t=this.read(),r=this.outputString(),s=this.inputEntry().value;this.model.stringAppendSlice(r,s,e,t)}}function me(n){return n>>16?4:n>>11?3:n>>7?2:1}function St(n){let e=0;for(let t=0;t<n.length;t++){let r=n.codePointAt(t),s=me(r);s==4&&t++,e+=s}return e}function zn(n,e,t=0){let r=t,s=0;for(s=t;r<e;s++){let i=n.codePointAt(s),o=me(i);o===4&&s++,r+=o}return s}function qo(n,e){let t=Math.min(n.length,e.length),r=0;for(let s=0;s<t;){let i=n.codePointAt(s),o=e.codePointAt(s);if(i!==o)return r;let u=me(i);r+=u,s+=u===4?2:1}return r}function Go(n,e,t=0){let r=Math.min(n.length,e.length)-t,s=0;for(let i=0;i<r;){let o=n.codePointAt(n.length-1-i),u=e.codePointAt(e.length-1-i);if(o!==u)return s;let a=me(o);s+=a,i+=a===4?2:1}return s}class wt{meta;constructor(e){this.meta=e}wrap(e){return this.wrapWithMeta(e,this.meta,this.meta)}wrapWithMeta(e,t,r=this.meta){return{data:e,startMeta:t,endMeta:r}}asObject(e){if(!e.content){let t={};for(let[r,s]of Object.entries(e.data))t[r]=this.wrapWithMeta(s,e.startMeta);e.content={type:"object",fields:t}}return e.content}asArray(e){if(!e.content){let t=e.data.map(s=>this.wrapWithMeta(s,e.startMeta)),r=t.map(()=>this.meta);e.content={type:"array",elements:t,metas:r}}return e.content}asString(e){if(!e.content){let t=e.data,r={value:t,utf8size:St(t),uses:[],startMeta:e.startMeta,endMeta:e.endMeta};e.content=this.stringFromParts([r])}return e.content}stringFromParts(e){let t={type:"string",parts:e};for(let r of e)r.uses.push(t);return t}objectGetKeys(e){return e.content?Object.keys(e.content.fields):Object.keys(e.data)}objectGetField(e,t){return this.asObject(e).fields[t]}arrayGetElement(e,t){return this.asArray(e).elements[t]}finalize(e){return this.updateEndMeta(e),{content:e,startMeta:this.meta,endMeta:this.meta}}markChanged(e){return this.wrap(R(e))}updateEndMeta(e){if(e.type=="string")for(let t of e.parts)t.endMeta=this.meta;else if(e.type==="array")for(let t of e.elements)t.content&&t.endMeta!==this.meta&&this.updateEndMeta(t.content),t.endMeta=this.meta;else for(let t of Object.values(e.fields))t.content&&t.endMeta!==this.meta&&this.updateEndMeta(t.content),t.endMeta=this.meta}copyString(e){if(e){let t=this.asString(e);return this.stringFromParts(t.parts.slice())}else return{type:"string",parts:[]}}copyObject(e){let t={type:"object",fields:{}};if(e){let r=this.asObject(e);Object.assign(t.fields,r.fields)}return t}copyArray(e){let t=e?this.asArray(e):null,r=t?t.elements:[],s=t?t.metas:[];return{type:"array",elements:r,metas:s}}objectSetField(e,t,r){e.fields[t]=r}objectDeleteField(e,t){delete e.fields[t]}arrayAppendValue(e,t){e.elements.push(t),e.metas.push(this.meta)}arrayAppendSlice(e,t,r,s){let i=this.asArray(t),o=i.elements.length===r;if(e.elements.push(...i.elements.slice(r,s)),o)e.metas.push(...i.metas.slice(r,s));else for(let u=r;u<s;u++)e.metas.push(this.meta)}stringAppendValue(e,t){let r=this.asString(t);for(let s of r.parts)this.stringAppendPart(e,s)}stringAppendPart(e,t){e.parts.push(t),t.uses.push(e)}resolveStringPart(e,t,r){if(r===0)return t;for(let s=t;s<e.parts.length;s++){let i=e.parts[s];if(r===i.utf8size)return s+1;if(r<i.utf8size)return this.splitString(i,r),s+1;r-=i.utf8size}throw new Error("splitting string out of bounds")}splitString(e,t){let r,s,i=t,o=e.utf8size-i;if(e.utf8size!==e.value.length){let a=0;for(t=0;a<i;t++){let c=e.value.codePointAt(t),l=me(c);l===4&&t++,a+=l}}r=e.value.slice(0,t),s=e.value.slice(t);let u={value:s,utf8size:o,uses:e.uses.slice(),startMeta:e.startMeta,endMeta:e.endMeta};e.value=r,e.utf8size=i;for(let a of e.uses){let c=a.parts.indexOf(e);if(c===-1)throw new Error("bug: mismatch between string parts and use.");a.parts.splice(c+1,0,u)}}stringAppendSlice(e,t,r,s){let i=this.asString(t),o=this.resolveStringPart(i,0,r),u=this.resolveStringPart(i,o,s-r);for(let a=o;a<u;a++){let c=i.parts[a];this.stringAppendPart(e,c)}}}function Ho(n,e){return{data:n,startMeta:e,endMeta:e}}function R(n){if(typeof n.data<"u")return n.data;let e,t=n.content;switch(t.type){case"string":e=t.parts.map(r=>r.value).join("");break;case"array":e=t.elements.map(r=>R(r));break;case"object":{e={};for(let[r,s]of Object.entries(t.fields))e[r]=R(s)}}return n.data=e,e}function Et(n){return n.content?n.content.type:Array.isArray(n.data)?"array":n.data===null?"null":typeof n.data}function xt(n,e){let t=Et(n),r=Et(e);if(t!==r)return e;let s=new wt(n.endMeta),i=new wt(e.endMeta);switch(t){case"object":{let o=s.asObject(n),u=i.asObject(e),a=0,c=Object.keys(o.fields).length,l=Object.keys(u.fields).length;for(let[f,h]of Object.entries(u.fields)){let d=o.fields[f];d&&(u.fields[f]=xt(d,h),u.fields[f]===d&&a++)}return c===l&&c===a?n:e}case"array":{let o=s.asArray(n),u=i.asArray(e);if(o.elements.length!==u.elements.length)break;let a=0;for(let c=0;c<u.elements.length;c++)u.elements[c]=xt(o.elements[c],u.elements[c]),u.elements[c]!==o.elements[c]&&a++;return a===0?n:e}case"null":case"boolean":case"number":{if(R(n)===R(e))return n;break}case"string":{let o=R(n),u=R(e);if(o===u)return n;let a=i.copyString(null),c=qo(o,u),l=Go(o,u,c),f=St(u),h=St(o);0<c&&i.stringAppendSlice(a,n,0,c),c<f-l&&i.stringAppendSlice(a,e,c,f-l),h-l<h&&i.stringAppendSlice(a,n,h-l,h);let d=i.finalize(a);if(R(d)!==u)throw new Error("incorrect string rebase");return d}}return e}function Jo(n,e,t){let r=new wt(t);return new Ur(r,n,e).process()}var Bu=Object.freeze({__proto__:null,applyPatch:Jo,getType:Et,rebaseValue:xt,unwrap:R,wrap:Ho});class Yo{wrap(e){return e}finalize(e){return Array.isArray(e)?e:e.data}markChanged(e){return e}objectGetKeys(e){return Object.keys(e)}objectGetField(e,t){return e[t]}arrayGetElement(e,t){return e[t]}copyObject(e){let t={type:"object",data:{}};if(e!==null)for(let[r,s]of Object.entries(e))t.data[r]=s;return t}copyArray(e){return e===null?[]:e.slice()}copyString(e){return{type:"string",data:e===null?"":e}}objectSetField(e,t,r){e.data[t]=r}objectDeleteField(e,t){delete e.data[t]}arrayAppendValue(e,t){e.push(t)}arrayAppendSlice(e,t,r,s){e.push(...t.slice(r,s))}stringAppendSlice(e,t,r,s){const i=t,o=zn(i,r),u=zn(i,s,o);e.data+=i.slice(o,u)}stringAppendValue(e,t){e.data+=t}}function Uu(n,e){let t=n;return new Ur(new Yo,t,e).process()}var lt;function Wr(n){return{lang:lt?.lang,message:n?.message,abortEarly:lt?.abortEarly,abortPipeEarly:lt?.abortPipeEarly,skipPipe:n?.skipPipe}}var Xo;function Ko(n){return Xo?.get(n)}var Zo;function No(n){return Zo?.get(n)}var Qo;function eu(n,e){return Qo?.get(n)?.get(e)}function zr(n){let e=typeof n;return e==="object"&&(e=(n&&Object.getPrototypeOf(n)?.constructor?.name)??"null"),e==="string"?`"${n}"`:e==="number"||e==="bigint"||e==="boolean"?`${n}`:e}function ue(n,e,t,r,s){const i=s&&"input"in s?s.input:t.value,o=s?.expected??n.expects,u=s?.received??zr(i),a={kind:n.kind,type:n.type,input:i,expected:o,received:u,message:`Invalid ${e}: ${o?`Expected ${o} but r`:"R"}eceived ${u}`,requirement:n.requirement,path:s?.path,issues:s?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly,skipPipe:r.skipPipe},c=n.kind==="schema",l=n.message??eu(n.reference,a.lang)??(c?No(a.lang):null)??r.message??Ko(a.lang);l&&(a.message=typeof l=="function"?l(a):l),c&&(t.typed=!1),t.issues?t.issues.push(a):t.issues=[a]}function tu(n){return n!=="__proto__"&&n!=="prototype"&&n!=="constructor"}var nu=class extends Error{issues;constructor(n){super(n[0].message),this.name="ValiError",this.issues=n}};function ru(n,e){return{kind:"validation",type:"min_length",reference:ru,async:!1,expects:`>=${n}`,requirement:n,message:e,_run(t,r){return t.typed&&t.value.length<this.requirement&&ue(this,"length",t,r,{received:`${t.value.length}`}),t}}}function su(n,e,t){return typeof n.fallback=="function"?n.fallback(e,t):n.fallback}function Wu(n,e){return{...n,fallback:e,_run(t,r){return n._run(t,r),t.issues?{typed:!0,value:su(this,t,r)}:t}}}function iu(n,e,t){return typeof n.default=="function"?n.default(e,t):n.default}function zu(n,e){return!n._run({typed:!1,value:e},{abortEarly:!0}).issues}function ou(n){return{kind:"schema",type:"boolean",reference:ou,expects:"boolean",async:!1,message:n,_run(e,t){return typeof e.value=="boolean"?e.typed=!0:ue(this,"type",e,t),e}}}function uu(n,e){return{kind:"schema",type:"object",reference:uu,expects:"Object",async:!1,entries:n,message:e,_run(t,r){const s=t.value;if(s&&typeof s=="object"){t.typed=!0,t.value={};for(const i in this.entries){const o=s[i],u=this.entries[i]._run({typed:!1,value:o},r);if(u.issues){const a={type:"object",origin:"value",input:s,key:i,value:o};for(const c of u.issues)c.path?c.path.unshift(a):c.path=[a],t.issues?.push(c);if(t.issues||(t.issues=u.issues),r.abortEarly){t.typed=!1;break}}u.typed||(t.typed=!1),(u.value!==void 0||i in s)&&(t.value[i]=u.value)}}else ue(this,"type",t,r);return t}}}function au(n,...e){const t={kind:"schema",type:"optional",reference:au,expects:`${n.expects} | undefined`,async:!1,wrapped:n,_run(r,s){return r.value===void 0&&("default"in this&&(r.value=iu(this,r,s)),r.value===void 0)?(r.typed=!0,r):this.wrapped._run(r,s)}};return 0 in e&&(t.default=e[0]),t}function cu(n,e){return{kind:"schema",type:"picklist",reference:cu,expects:n.map(zr).join(" | ")||"never",async:!1,options:n,message:e,_run(t,r){return this.options.includes(t.value)?t.typed=!0:ue(this,"type",t,r),t}}}function lu(n,e,t){return{kind:"schema",type:"record",reference:lu,expects:"Object",async:!1,key:n,value:e,message:t,_run(r,s){const i=r.value;if(i&&typeof i=="object"){r.typed=!0,r.value={};for(const o in i)if(tu(o)){const u=i[o],a=this.key._run({typed:!1,value:o},s);if(a.issues){const l={type:"record",origin:"key",input:i,key:o,value:u};for(const f of a.issues)f.path=[l],r.issues?.push(f);if(r.issues||(r.issues=a.issues),s.abortEarly){r.typed=!1;break}}const c=this.value._run({typed:!1,value:u},s);if(c.issues){const l={type:"record",origin:"value",input:i,key:o,value:u};for(const f of c.issues)f.path?f.path.unshift(l):f.path=[l],r.issues?.push(f);if(r.issues||(r.issues=c.issues),s.abortEarly){r.typed=!1;break}}(!a.typed||!c.typed)&&(r.typed=!1),a.typed&&(r.value[a.value]=c.value)}}else ue(this,"type",r,s);return r}}}function fu(n){return{kind:"schema",type:"string",reference:fu,expects:"string",async:!1,message:n,_run(e,t){return typeof e.value=="string"?e.typed=!0:ue(this,"type",e,t),e}}}function hu(){return{kind:"schema",type:"unknown",reference:hu,expects:"unknown",async:!1,_run(n){return n.typed=!0,n}}}function qu(n,e,t){const r=n._run({typed:!1,value:e},Wr(t));if(r.issues)throw new nu(r.issues);return r.value}function Gu(...n){return{...n[0],pipe:n,_run(e,t){for(let r=0;r<n.length;r++){e=n[r]._run(e,t);const s=n[r+1];if(t.skipPipe||e.issues&&(t.abortEarly||t.abortPipeEarly||s?.kind==="schema"||s?.kind==="transformation")){e.typed=!1;break}}return e}}}function Hu(n,e,t){const r=n._run({typed:!1,value:e},Wr(t));return{typed:r.typed,success:!r.issues,output:r.value,issues:r.issues}}export{Lr as $,ps as A,is as B,ne as C,pu as D,Nn as E,Gs as F,ku as G,Nt as H,Eu as I,qs as J,yu as K,Iu as L,Au as M,Ou as N,T as O,yt as P,de as Q,us as R,pe as S,Du as T,Vu as U,$u as V,Fu as W,Ru as X,Cu as Y,Lu as Z,M as _,It as a,Ki as a0,Tu as a1,Su as a2,un as a3,bu as a4,xu as a5,js as a6,Dr as a7,$r as a8,A as a9,Ve as aA,Rr as aB,x as aa,_ as ab,xo as ac,Uu as ad,Bu as ae,Wu as af,cu as ag,qu as ah,uu as ai,ou as aj,eo as ak,Lt as al,wr as am,Cr as an,ju as ao,Pu as ap,ar as aq,Mu as ar,Hu as as,zu as at,au,Gu as av,ru as aw,fu as ax,lu as ay,hu as az,cs as b,X as c,Gn as d,fe as e,Ms as f,J as g,ss as h,w as i,C as j,mu as k,Xn as l,Rs as m,Ds as n,z as o,ms as p,vu as q,ys as r,ht as s,_u as t,gu as u,Y as v,U as w,fr as x,he as y,wu as z};
