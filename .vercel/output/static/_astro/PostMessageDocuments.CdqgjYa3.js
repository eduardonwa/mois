import{b as _,aj as E,aw as P,bY as R}from"./studio-component.5JEdvz6o.js";import{a as f}from"./index.EmWCQ-Q3.js";import{t as l,I as D,a4 as I}from"./index.CQkWGOce.js";import"./client.B76MnFfN.js";const x=s=>{const e=_.c(13),{comlink:t}=s;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={apiVersion:P},e[0]=i):i=e[0];const n=E(i);let a,c;e[1]!==n||e[2]!==t?(a=()=>{const o=n.listen('*[!(_id in path("_.**"))]',{},{effectFormat:"mendoza",events:["welcome","mutation","reconnect"],includePreviousRevision:!1,includeResult:!1,tag:"presentation-documents",visibility:"transaction"}).pipe(l(S)),d=o.pipe(l(z),D({bufferSize:1,refCount:!1})),y=t.on("visual-editing/snapshot-welcome",async()=>({event:await new Promise(b=>{d.pipe(R()).subscribe(w=>{b(w)})})})),v=o.pipe(l(C)),g=o.pipe(l(M)),h=I(d,g,v).subscribe(b=>{t.post("presentation/snapshot-event",{event:b})});return()=>{y(),h.unsubscribe()}},c=[n,t],e[1]=n,e[2]=t,e[3]=a,e[4]=c):(a=e[3],c=e[4]),f.useEffect(a,c);let r,u;e[5]!==n||e[6]!==t?(r=()=>t.on("visual-editing/fetch-snapshot",async o=>({snapshot:await n.getDocument(o.documentId,{tag:"document.snapshots"})})),u=[n,t],e[5]=n,e[6]=t,e[7]=r,e[8]=u):(r=e[7],u=e[8]),f.useEffect(r,u);let m,p;return e[9]!==n||e[10]!==t?(m=()=>t.on("visual-editing/mutate",async o=>n.dataRequest("mutate",o,{visibility:"async",returnDocuments:!0})),p=[n,t],e[9]=n,e[10]=t,e[11]=m,e[12]=p):(m=e[11],p=e[12]),f.useEffect(m,p),null};var q=f.memo(x);function S(s){return s.type==="welcome"||s.type==="reconnect"||s.type==="mutation"}function z(s){return s.type==="welcome"}function C(s){return s.type==="reconnect"}function M(s){return s.type==="mutation"}export{q as default};
