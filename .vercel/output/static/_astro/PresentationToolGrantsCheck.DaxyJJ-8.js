const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/QRCodeSVG.DWIRcn2A.js","_astro/index.CQkWGOce.js","_astro/index.EmWCQ-Q3.js","_astro/studio-component.5JEdvz6o.js","_astro/client.B76MnFfN.js","_astro/LoaderQueries.Dc7dvkX7.js","_astro/utils.BIMmukQr.js","_astro/resolveEditInfo.B7J32-hP.js","_astro/LiveQueries.fFwg17p9.js","_astro/DisplayedDocumentBroadcaster.DYfF5bFa.js","_astro/PostMessageDocuments.CdqgjYa3.js","_astro/PostMessageRefreshMutations.BSnOSmsc.js","_astro/PostMessagePerspective.BmX28SxA.js","_astro/PostMessagePreviewSnapshots.DH0MHBFN.js","_astro/PostMessageSchema.DBDp9Pz0.js","_astro/PostMessageTelemetry.xZrYlMsL.js"])))=>i.map(i=>d[i]);
import{ad as Lt,ae as An,af as Mn,M as Yt,b as D,f as we,ag as be,v as Zt,ah as Dn,ai as en,aj as Ye,ak as kn,k as _t,al as tn,am as On,an as Ln,ao as zn,ap as Un,aq as Wn,ar as zt,as as nn,u as Nn,at as Vn,au as Fn,K as Q,av as Bn,aw as lt,ax as rn,ay as ut,az as Kn,aA as Hn,aB as qn,aC as Gn,aD as Qn,j as le,aE as jt,aF as Et,aG as Xn,aH as sn,aI as Ut,aJ as Jn,C as ce,aK as an,aL as Ze,p as ye,aM as st,T as W,S as Se,aN as at,h as ot,_ as _e,Q as Yn,aO as Ct,aP as Zn,aQ as er,aR as tr,aS as nr,aT as rr,B as ee,a as ir,aU as dt,a4 as on,aV as sr,aW as cn,aX as ln,aY as ar,aZ as Qe,a_ as un,a$ as or,b0 as bt,b1 as cr,b2 as lr,b3 as ur,b4 as dr,b5 as pr,b6 as mr,b7 as Wt,b8 as fr,w as hr,b9 as gr,ba as vr,bb as xr,a3 as yr,a2 as wr,bc as br,bd as Pr,A as dn,be as Sr,E as pn,J as _r,bf as jr,bg as Er,bh as Cr,bi as Rr,bj as Tr}from"./studio-component.5JEdvz6o.js";import{D as o,G as Rt,F as Ir,av as mn,aw as fn,ax as Tt,au as hn,ai as $r,ay as Ar,az as Mr}from"./index.CQkWGOce.js";import{a as p}from"./index.EmWCQ-Q3.js";import{h as Dr,j as Nt,e as Vt,s as gn,v as kr}from"./resolveEditInfo.B7J32-hP.js";import{i as Or,D as Lr}from"./DisplayedDocumentBroadcaster.DYfF5bFa.js";import"./client.B76MnFfN.js";function zr({children:n,isValidProp:e,...t}){e&&Mn(e),t={...p.useContext(Lt),...t},t.isStatic=An(()=>t.isStatic);const a=p.useMemo(()=>t,[JSON.stringify(t.transition),t.transformPagePoint,t.reducedMotion]);return o.jsx(Lt.Provider,{value:a,children:n})}const It="sanity.previewUrlSecret",vn="sanity-preview-url-secret",$e=`${vn}.share-access`,He="sanity.previewUrlShareAccess",pt="2023-11-09",$t="sanity-preview-secret",At="sanity-preview-pathname",Je="sanity-preview-perspective",Xe="x-vercel-protection-bypass",Mt="x-vercel-set-bypass-cookie",xn=60*60,Ur=`*[_id == "${$e}" && _type == "${He}"][0].secret`,Wr=`*[_type == "${It}" && dateTime(_updatedAt) <= dateTime(now()) - ${xn}]`,Nr="sanity.vercelProtectionBypass",Vr=`${vn}.vercel-protection-bypass`,Fr=`*[_id == "${Vr}" && _type == "${Nr}"][0].secret`,Dt="sanity.preview-url-secret";function Br(n){const e=new URL(n),{searchParams:t}=e;return t.delete(At),t.delete($t),t.delete(Je),t.delete(Xe),t.delete(Mt),e}function Kr(n,e,t,a){const i=new URL(n),{searchParams:r}=i;return e&&(r.set($t,e),r.set(At,t)),r.set(Je,a),i}function yn(){if(typeof crypto<"u"){const n=new Uint8Array(16);crypto.getRandomValues(n);let e="";for(let t=0;t<n.length;t++)e+=n[t].toString(16).padStart(2,"0");return e=btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),e}return Math.random().toString(36).slice(2)}async function Hr(n,e,t,a){const i=n.withConfig({apiVersion:pt}),r=yn(),s=i.patch($e).set({secret:r,studioUrl:t,userId:a});return await i.transaction().createIfNotExists({_id:$e,_type:He,source:e,studioUrl:t,userId:a}).patch(s).commit({tag:Dt}),{secret:r}}async function qr(n,e,t,a){const i=n.withConfig({apiVersion:pt}),r=i.patch($e).set({secret:null,studioUrl:t,userId:a});await i.transaction().createIfNotExists({_id:$e,_type:He,source:e,studioUrl:t,userId:a}).patch(r).commit({tag:Dt})}function Gr(n){for(var e=[],t=0;t<n.length;){var a=n[t];if(a==="*"||a==="+"||a==="?"){e.push({type:"MODIFIER",index:t,value:n[t++]});continue}if(a==="\\"){e.push({type:"ESCAPED_CHAR",index:t++,value:n[t++]});continue}if(a==="{"){e.push({type:"OPEN",index:t,value:n[t++]});continue}if(a==="}"){e.push({type:"CLOSE",index:t,value:n[t++]});continue}if(a===":"){for(var i="",r=t+1;r<n.length;){var s=n.charCodeAt(r);if(s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122||s===95){i+=n[r++];continue}break}if(!i)throw new TypeError("Missing parameter name at ".concat(t));e.push({type:"NAME",index:t,value:i}),t=r;continue}if(a==="("){var c=1,l="",r=t+1;if(n[r]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(r));for(;r<n.length;){if(n[r]==="\\"){l+=n[r++]+n[r++];continue}if(n[r]===")"){if(c--,c===0){r++;break}}else if(n[r]==="("&&(c++,n[r+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(r));l+=n[r++]}if(c)throw new TypeError("Unbalanced pattern at ".concat(t));if(!l)throw new TypeError("Missing pattern at ".concat(t));e.push({type:"PATTERN",index:t,value:l}),t=r;continue}e.push({type:"CHAR",index:t,value:n[t++]})}return e.push({type:"END",index:t,value:""}),e}function Qr(n,e){e===void 0&&(e={});for(var t=Gr(n),a=e.prefixes,i=a===void 0?"./":a,r=e.delimiter,s=r===void 0?"/#?":r,c=[],l=0,u=0,m="",d=function(w){if(u<t.length&&t[u].type===w)return t[u++].value},h=function(w){var g=d(w);if(g!==void 0)return g;var T=t[u],A=T.type,I=T.index;throw new TypeError("Unexpected ".concat(A," at ").concat(I,", expected ").concat(w))},f=function(){for(var w="",g;g=d("CHAR")||d("ESCAPED_CHAR");)w+=g;return w},y=function(w){for(var g=0,T=s;g<T.length;g++){var A=T[g];if(w.indexOf(A)>-1)return!0}return!1},v=function(w){var g=c[c.length-1],T=w||(g&&typeof g=="string"?g:"");if(g&&!T)throw new TypeError('Must have text between two parameters, missing text after "'.concat(g.name,'"'));return!T||y(T)?"[^".concat(Ie(s),"]+?"):"(?:(?!".concat(Ie(T),")[^").concat(Ie(s),"])+?")};u<t.length;){var b=d("CHAR"),x=d("NAME"),j=d("PATTERN");if(x||j){var _=b||"";i.indexOf(_)===-1&&(m+=_,_=""),m&&(c.push(m),m=""),c.push({name:x||l++,prefix:_,suffix:"",pattern:j||v(_),modifier:d("MODIFIER")||""});continue}var P=b||d("ESCAPED_CHAR");if(P){m+=P;continue}m&&(c.push(m),m="");var S=d("OPEN");if(S){var _=f(),R=d("NAME")||"",E=d("PATTERN")||"",C=f();h("CLOSE"),c.push({name:R||(E?l++:""),pattern:R&&!E?v(_):E,prefix:_,suffix:C,modifier:d("MODIFIER")||""});continue}h("END")}return c}function Xr(n,e){var t=[],a=bn(n,t,e);return Jr(a,t,e)}function Jr(n,e,t){t===void 0&&(t={});var a=t.decode,i=a===void 0?function(r){return r}:a;return function(r){var s=n.exec(r);if(!s)return!1;for(var c=s[0],l=s.index,u=Object.create(null),m=function(h){if(s[h]===void 0)return"continue";var f=e[h-1];f.modifier==="*"||f.modifier==="+"?u[f.name]=s[h].split(f.prefix+f.suffix).map(function(y){return i(y,f)}):u[f.name]=i(s[h],f)},d=1;d<s.length;d++)m(d);return{path:c,index:l,params:u}}}function Ie(n){return n.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function wn(n){return n&&n.sensitive?"":"i"}function Yr(n,e){if(!e)return n;for(var t=/\((?:\?<(.*?)>)?(?!\?)/g,a=0,i=t.exec(n.source);i;)e.push({name:i[1]||a++,prefix:"",suffix:"",modifier:"",pattern:""}),i=t.exec(n.source);return n}function Zr(n,e,t){var a=n.map(function(i){return bn(i,e,t).source});return new RegExp("(?:".concat(a.join("|"),")"),wn(t))}function ei(n,e,t){return ti(Qr(n,t),e,t)}function ti(n,e,t){t===void 0&&(t={});for(var a=t.strict,i=a===void 0?!1:a,r=t.start,s=r===void 0?!0:r,c=t.end,l=c===void 0?!0:c,u=t.encode,m=u===void 0?function(g){return g}:u,d=t.delimiter,h=d===void 0?"/#?":d,f=t.endsWith,y=f===void 0?"":f,v="[".concat(Ie(y),"]|$"),b="[".concat(Ie(h),"]"),x=s?"^":"",j=0,_=n;j<_.length;j++){var P=_[j];if(typeof P=="string")x+=Ie(m(P));else{var S=Ie(m(P.prefix)),R=Ie(m(P.suffix));if(P.pattern)if(e&&e.push(P),S||R)if(P.modifier==="+"||P.modifier==="*"){var E=P.modifier==="*"?"?":"";x+="(?:".concat(S,"((?:").concat(P.pattern,")(?:").concat(R).concat(S,"(?:").concat(P.pattern,"))*)").concat(R,")").concat(E)}else x+="(?:".concat(S,"(").concat(P.pattern,")").concat(R,")").concat(P.modifier);else{if(P.modifier==="+"||P.modifier==="*")throw new TypeError('Can not repeat "'.concat(P.name,'" without a prefix and suffix'));x+="(".concat(P.pattern,")").concat(P.modifier)}else x+="(?:".concat(S).concat(R,")").concat(P.modifier)}}if(l)i||(x+="".concat(b,"?")),x+=t.endsWith?"(?=".concat(v,")"):"$";else{var C=n[n.length-1],w=typeof C=="string"?b.indexOf(C[C.length-1])>-1:C===void 0;i||(x+="(?:".concat(b,"(?=").concat(v,"))?")),w||(x+="(?=".concat(b,"|").concat(v,")"))}return new RegExp(x,wn(t))}function bn(n,e,t){return n instanceof RegExp?Yr(n,e):Array.isArray(n)?Zr(n,e,t):ei(n,e,t)}async function ni(n,e,t,a,i=Yt()){const r=n.withConfig({apiVersion:pt});try{const s=new Date(Date.now()+1e3*xn),c=`drafts.${i}`,l=yn(),u=r.patch(c).set({secret:l,source:e,studioUrl:t,userId:a});return await r.transaction().createOrReplace({_id:c,_type:It}).patch(u).commit({tag:Dt}),{secret:l,expiresAt:s}}finally{try{await r.delete({query:Wr})}catch(s){console.error("Failed to delete expired secrets",s)}}}function ri(n){const{draftMode:e,previewMode:t,origin:a=typeof location>"u"?"https://localhost":location.origin}=n,i=t?.enable||e?.enable;let{preview:r="/"}=n;const s=new URL(r,a),c=i?new URL(i,a):void 0;return async l=>{try{if(l.previewSearchParam){const m=new URL(l.previewSearchParam,s);m.origin===s.origin&&(r=`${m.pathname}${m.search}`)}}catch{}typeof location<"u"&&location.origin===s.origin&&l.studioBasePath&&(r.startsWith(`${l.studioBasePath}/`)||r===l.studioBasePath)&&(r=n.preview||"/");const u=new URL(r,s);if(c){const m=new URL(c),{searchParams:d}=m;return d.set($t,l.previewUrlSecret),d.set(Je,l.studioPreviewPerspective),u.pathname!==m.pathname&&d.set(At,`${u.pathname}${u.search}`),m.toString()}return u.toString()}}const ii=n=>typeof n=="object"&&typeof n.then=="function",rt=[];function si(n,e,t=(a,i)=>a===i){if(n===e)return!0;if(!n||!e)return!1;const a=n.length;if(e.length!==a)return!1;for(let i=0;i<a;i++)if(!t(n[i],e[i]))return!1;return!0}function ai(n,e=null,t=!1,a={}){e===null&&(e=[n]);for(const r of rt)if(si(e,r.keys,r.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return a.lifespan&&a.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,a.lifespan)),r.response;if(!t)throw r.promise}const i={keys:e,equal:a.equal,remove:()=>{const r=rt.indexOf(i);r!==-1&&rt.splice(r,1)},promise:(ii(n)?n:n(...e)).then(r=>{i.response=r,a.lifespan&&a.lifespan>0&&(i.timeout=setTimeout(i.remove,a.lifespan))}).catch(r=>i.error=r)};if(rt.push(i),!t)throw i.promise}const Pn=(n,e,t)=>ai(n,e,!1,t);function oi(n,e){let t=new AbortController,a=[];async function i(s,c){const{result:l,syncTags:u}=await n.fetch(Fr,{},{filterResponse:!1,lastLiveEventId:s,tag:"preview-url-secret.fetch-vercel-bypass-protection-secret"});Array.isArray(u)&&(a=u),c.aborted||e(l)}const r=n.live.events().subscribe({next:s=>{s.type==="message"&&(t.abort(),t=new AbortController,s.tags.some(c=>a.includes(c))&&i(s.id,t.signal))},error:s=>console.error(s)});return i(null,t.signal),()=>{r.unsubscribe(),t.abort()}}const ci=n=>{const e=D.c(3),{comlink:t}=n;let a,i;return e[0]!==t?(a=()=>t.on("visual-editing/features",ui),i=[t],e[0]=t,e[1]=a,e[2]=i):(a=e[1],i=e[2]),p.useEffect(a,i),null};var li=p.memo(ci);function ui(){return{features:{optimistic:!0}}}function Sn(n,e){let t;return(...a)=>{clearTimeout(t),t=setTimeout(()=>{n.apply(n,a)},e)}}const di=function(n){const e=D.c(14),{comlink:t,children:a}=n;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i={},e[0]=i):i=e[0];const r=p.useRef(i);let s,c;e[1]!==t?(s=()=>t?.on("visual-editing/shared-state",()=>({state:r.current})),c=[t],e[1]=t,e[2]=s,e[3]=c):(s=e[2],c=e[3]),p.useEffect(s,c);let l;e[4]!==t?(l=(b,x)=>{r.current[b]=x,t?.post("presentation/shared-state",{key:b,value:x})},e[4]=t,e[5]=l):l=e[5];const u=l;let m;e[6]!==t?(m=b=>{t?.post("presentation/shared-state",{key:b}),delete r.current[b]},e[6]=t,e[7]=m):m=e[7];const d=m;let h,f;e[8]!==d||e[9]!==u?(f={removeValue:d,setValue:u},e[8]=d,e[9]=u,e[10]=f):f=e[10],h=f;const y=h;let v;return e[11]!==a||e[12]!==y?(v=o.jsx(Qn.Provider,{value:y,children:a}),e[11]=a,e[12]=y,e[13]=v):v=e[13],v},pi=le.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,kt=function(n){const e=D.c(15),{children:t,defaultSize:a,id:i,minWidth:r,maxWidth:s,order:c}=n,l=a===void 0?null:a,u=c===void 0?0:c,m=p.useContext(jt);if(m===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:d,registerElement:h,unregisterElement:f}=m;let y;e[0]!==d||e[1]!==i?(y=d(i),e[0]=d,e[1]=i,e[2]=y):y=e[2];const v=y;let b,x;e[3]!==l||e[4]!==i||e[5]!==s||e[6]!==r||e[7]!==u||e[8]!==h||e[9]!==f?(b=()=>(h(i,{id:i,type:"panel",defaultSize:l,maxWidth:s??null,minWidth:r??0,order:u}),()=>{f(i)}),x=[i,l,u,s,r,h,f],e[3]=l,e[4]=i,e[5]=s,e[6]=r,e[7]=u,e[8]=h,e[9]=f,e[10]=b,e[11]=x):(b=e[10],x=e[11]),p.useLayoutEffect(b,x);let j;return e[12]!==t||e[13]!==v?(j=o.jsx(pi,{style:v,children:t}),e[12]=t,e[13]=v,e[14]=j):j=e[14],j},_n="presentation/panels",jn=()=>JSON.parse(localStorage.getItem(_n)||"{}"),mi=n=>{localStorage.setItem(_n,JSON.stringify(n))},En=n=>n.map(e=>[e.id,e.order].join(":")).join(",");function fi(){const n=D.c(1);let e;const t=gi,a=hi;let i;if(n[0]===Symbol.for("react.memo_cache_sentinel")){const r=Sn(a,100);i={get:t,set:a,setDebounced:r},n[0]=i}else i=n[0];return e=i,e}function hi(n,e){const t=jn(),a=En(n),i={...t,[a]:e};mi(i)}function gi(n){const e=jn(),t=En(n);return Array.isArray(e[t])&&e[t].some(vi)?void 0:e[t]}function vi(n){return n===null}function Pt(n,e,t){const{maxWidth:a,minWidth:i}=n,r=a==null?100:a/t*100,s=i/t*100;return Math.min(r,Math.max(s,e))}function xi(n,e,t,a,i,r){const{panels:s,widths:c}=i,{widths:l}=r,u=l||c,m=[...u];{const y=n<0?a:t,v=s.findIndex(j=>j.id===y.id),b=u[v],x=Pt(y,b+Math.abs(n),e);if(b===x)return u;n=n<0?b-x:x-b}let d=0,h=n<0?t:a,f=s.findIndex(y=>y.id===h.id);for(;;){const y=s[f],v=u[f],b=Math.abs(n)-Math.abs(d),x=Pt(y,v-b,e);if(v!==x&&(d+=v-x,m[f]=x,d.toPrecision(10).localeCompare(Math.abs(n).toPrecision(10),void 0,{numeric:!0})>=0))break;if(n<0){if(--f<0)break}else if(++f>=s.length)break}return d===0?u:(h=n<0?a:t,f=s.findIndex(y=>y.id===h.id),m[f]=u[f]+d,m)}function yi(n,e,t){if(n.length===1)return"100";const a=n.findIndex(r=>r.id===e),i=t[a];return i==null?"0":i.toPrecision(10)}function Ft(n,e,t=0,a=null){const i=n.clientX,r=(a||e.getBoundingClientRect()).left;return i-r-t}function gt(n){return n.type==="panel"}function Bt(n){return n.type==="resizer"}function Kt(n){return Array.from(n.values()).sort(({order:e},{order:t})=>e==null&&t==null?0:e==null?-1:t==null?1:e-t)}function Ht(n,e,t){const a=e.reduce((s,c)=>s+c,0),i=[...e].map(s=>s/a*100);let r=0;for(let s=0;s<n.length;s++){const c=n[s],l=i[s],u=Pt(c,l,t);l!=u&&(r+=l-u,i[s]=u)}if(r.toFixed(3)!=="0.000")for(let s=0;s<n.length;s++){const c=n[s];let{maxWidth:l,minWidth:u}=c;u=u/t*100,l!=null&&(l=l/t*100);const m=Math.min(l??100,Math.max(u,i[s]+r));if(m!==i[s]&&(r-=m-i[s],i[s]=m,Math.abs(r).toFixed(3)==="0.000"))break}return i}function wi(n){let e=n.length,t=100;const a=n.map(r=>r.defaultSize?(t-=r.defaultSize,e-=1,r.defaultSize):null),i=t/e;return a.map(r=>r===null?i:r)}const bi=le.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,Pi=function(n){const e=D.c(46),{children:t}=n,a=p.useRef(null);let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=new Map,e[0]=i):i=e[0];const[r,s]=p.useState(i);let c,l;e[1]!==r?(l=Kt(r).filter(gt),e[1]=r,e[2]=l):l=e[2],c=l;const u=c;let m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=[],e[3]=m):m=e[3];const[d,h]=p.useState(m),[f,y]=p.useState(null);let v;e[4]!==r||e[5]!==u||e[6]!==d?(v={elements:r,panels:u,widths:d},e[4]=r,e[5]=u,e[6]=d,e[7]=v):v=e[7];const b=p.useRef(v);let x;e[8]!==f||e[9]!==u||e[10]!==d?(x=B=>({flexGrow:yi(u,B,d),pointerEvents:f===null?void 0:"none"}),e[8]=f,e[9]=u,e[10]=d,e[11]=x):x=e[11];const j=x;let _;e[12]===Symbol.for("react.memo_cache_sentinel")?(_=(B,K)=>{s(N=>{if(N.has(B))return N;const G=new Map(N);return G.set(B,K),G})},e[12]=_):_=e[12];const P=_;let S;e[13]===Symbol.for("react.memo_cache_sentinel")?(S=B=>{s(K=>{if(!K.has(B))return K;const N=new Map(K);return N.delete(B),N})},e[13]=S):S=e[13];const R=S;let E;e[14]===Symbol.for("react.memo_cache_sentinel")?(E={containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]},e[14]=E):E=e[14];const C=p.useRef(E);let w;e[15]!==r?(w=(B,K)=>{const N=Kt(r),G=N.findIndex(X=>X.id===B),oe=r.get(B);if(!oe||!Bt(oe))return;const Y=oe.el.current;Y&&(C.current={resizerIndex:G,panelBefore:N.reduce((X,J,se)=>gt(J)&&se<G?J:X,null),panelAfter:N.reduce((X,J,se)=>X===null&&gt(J)&&se>G?J:X,null),containerWidth:window.innerWidth,startX:K.pageX,dragOffset:Ft(K,Y),resizerRect:Y.getBoundingClientRect(),widths:b.current.widths},y(B))},e[15]=r,e[16]=w):w=e[16];const g=w;let T;e[17]===Symbol.for("react.memo_cache_sentinel")?(T=()=>{y(null)},e[17]=T):T=e[17];const A=T;let I;e[18]!==r?(I=(B,K)=>{K.preventDefault(),K.stopPropagation();const{containerWidth:N,dragOffset:G,panelBefore:oe,panelAfter:Y,resizerRect:X}=C.current;if(oe==null||Y==null)return;const J=r.get(B);if(!J||!Bt(J))return;const se=J.el.current;if(!se)return;const de=Ft(K,se,G,X);if(de===0)return;const{widths:ge}=b.current,pe=a.current.getBoundingClientRect(),ve=de/pe.width*100,me=xi(ve,N,oe,Y,b.current,C.current);ge.some((xe,fe)=>xe!==me[fe])&&h(me)},e[18]=r,e[19]=I):I=e[19];const k=I;let O,z;e[20]!==r||e[21]!==u||e[22]!==d?(O=()=>{b.current.elements=r,b.current.panels=u,b.current.widths=d},z=[r,u,d],e[20]=r,e[21]=u,e[22]=d,e[23]=O,e[24]=z):(O=e[23],z=e[24]),p.useLayoutEffect(O,z);const V=fi();let H,F;e[25]!==u||e[26]!==V?(H=()=>{const{widths:B}=b.current;if(B.length===u.length)return;const K=V.get(u);if(K){const G=Ht(u,K,window.innerWidth);h(G);return}const N=wi(u);h(N)},F=[V,u],e[25]=u,e[26]=V,e[27]=H,e[28]=F):(H=e[27],F=e[28]),p.useLayoutEffect(H,F);let q,Z;e[29]!==u||e[30]!==V||e[31]!==d?(q=()=>{d.length&&V.setDebounced(u,d)},Z=[V,u,d],e[29]=u,e[30]=V,e[31]=d,e[32]=q,e[33]=Z):(q=e[32],Z=e[33]),p.useEffect(q,Z);let te,ne;e[34]===Symbol.for("react.memo_cache_sentinel")?(te=()=>{const B=new ResizeObserver(()=>{const{panels:K,widths:N}=b.current,G=Ht(K,N,window.innerWidth);N.some((oe,Y)=>oe!==G[Y])&&h(G)});return B.observe(a.current),()=>{B.disconnect()}},ne=[],e[34]=te,e[35]=ne):(te=e[34],ne=e[35]),p.useLayoutEffect(te,ne);let ue,M;e[36]!==f||e[37]!==k||e[38]!==j||e[39]!==g?(M={activeResizer:f,drag:k,getPanelStyle:j,registerElement:P,startDragging:g,stopDragging:A,unregisterElement:R},e[36]=f,e[37]=k,e[38]=j,e[39]=g,e[40]=M):M=e[40],ue=M;const re=ue;let ie;e[41]!==t?(ie=o.jsx(bi,{ref:a,children:t}),e[41]=t,e[42]=ie):ie=e[42];let ae;return e[43]!==re||e[44]!==ie?(ae=o.jsx(jt.Provider,{value:re,children:ie}),e[43]=re,e[44]=ie,e[45]=ae):ae=e[45],ae};function Ot(n){const e=D.c(37);let t,a,i,r,s;e[0]!==n?({children:t,message:a,onRetry:r,onContinueAnyway:i,...s}=n,e[0]=n,e[1]=t,e[2]=a,e[3]=i,e[4]=r,e[5]=s):(t=e[1],a=e[2],i=e[3],r=e[4],s=e[5]);const{t:c}=we(be);let l;e[6]!==c?(l=c("error-card.retry-button.text"),e[6]=c,e[7]=l):l=e[7];let u;e[8]!==r||e[9]!==l?(u=o.jsx(ye,{mode:"ghost",onClick:r,text:l}),e[8]=r,e[9]=l,e[10]=u):u=e[10];const m=u;let d;e[11]!==c?(d=c("error-card.continue-button.text"),e[11]=c,e[12]=d):d=e[12];let h;e[13]!==i||e[14]!==d?(h=o.jsx(ye,{mode:"ghost",tone:"critical",onClick:i,text:d}),e[13]=i,e[14]=d,e[15]=h):h=e[15];const f=h;let y;e[16]!==c?(y=c("error-card.title"),e[16]=c,e[17]=y):y=e[17];let v;e[18]!==y?(v=o.jsx(W,{size:1,weight:"semibold",children:y}),e[18]=y,e[19]=v):v=e[19];let b;e[20]!==a?(b=o.jsx(W,{muted:!0,size:1,children:a}),e[20]=a,e[21]=b):b=e[21];let x;e[22]!==v||e[23]!==b?(x=o.jsxs(Se,{space:3,children:[v,b]}),e[22]=v,e[23]=b,e[24]=x):x=e[24];let j;e[25]!==f||e[26]!==i||e[27]!==r||e[28]!==m?(j=r&&i?o.jsxs(rr,{space:2,children:[m,f]}):r?o.jsx(ee,{children:m}):i?o.jsx(ee,{children:f}):null,e[25]=f,e[26]=i,e[27]=r,e[28]=m,e[29]=j):j=e[29];let _;e[30]!==t||e[31]!==x||e[32]!==j?(_=o.jsx(Q,{align:"center",height:"fill",justify:"center",children:o.jsx(ir,{padding:4,sizing:"border",width:0,children:o.jsxs(Se,{space:4,children:[x,t,j]})})}),e[30]=t,e[31]=x,e[32]=j,e[33]=_):_=e[33];let P;return e[34]!==s||e[35]!==_?(P=o.jsx(ce,{height:"fill",...s,children:_}),e[34]=s,e[35]=_,e[36]=P):P=e[36],P}function Si(n={}){const e=Object.entries(n).map(([t,a])=>`${t}=${a}`).join("&");return e.length?`?${e}`:""}function _i(n){const e=["comment","inspect","instruction","pathKey","rev","since","template","view"],t=Object.entries(n).filter(([a])=>e.includes(a)).reduce((a,[i,r])=>r==null?a:{...a,[i]:r},{});return Si(t)}const ji=p.forwardRef(function(n,e){const t=D.c(11);let a,i;t[0]!==n?({searchParams:i,...a}=n,t[0]=n,t[1]=a,t[2]=i):(a=t[1],i=t[2]);let r;t[3]!==i?(r=Object.entries(i),t[3]=i,t[4]=r):r=t[4];let s;t[5]!==r?(s={type:void 0,_searchParams:r},t[5]=r,t[6]=s):s=t[6];let c;return t[7]!==e||t[8]!==a||t[9]!==s?(c=o.jsx(dt,{...a,ref:e,state:s,title:void 0}),t[7]=e,t[8]=a,t[9]=s,t[10]=c):c=t[10],c}),Ei=p.forwardRef(function(n,e){const t=D.c(15);let a,i,r,s;if(t[0]!==n){const{documentId:m,documentType:d,parentRefPath:h,template:f,searchParams:y,...v}=n;a=m,i=d,s=y,r=v,t[0]=n,t[1]=a,t[2]=i,t[3]=r,t[4]=s}else a=t[1],i=t[2],r=t[3],s=t[4];let c;t[5]!==s?(c=Object.entries(s),t[5]=s,t[6]=c):c=t[6];let l;t[7]!==a||t[8]!==i||t[9]!==c?(l={id:a,type:i,_searchParams:c},t[7]=a,t[8]=i,t[9]=c,t[10]=l):l=t[10];let u;return t[11]!==e||t[12]!==r||t[13]!==l?(u=o.jsx(dt,{...r,ref:e,state:l,title:void 0}),t[11]=e,t[12]=r,t[13]=l,t[14]=u):u=t[14],u});function Cn(n){const e=D.c(26),{children:t,onStructureParams:a,structureParams:i,searchParams:r,refs:s}=n,{state:c,resolvePathFromState:l}=_t();let u;e[0]!==c._searchParams?(u=Object.fromEntries(c._searchParams||[]),e[0]=c._searchParams,e[1]=u):u=e[1];const m=tn(u);let d;e[2]!==l||e[3]!==m||e[4]!==c?(d=C=>{const w=l(c),g=_i({...m,...C});return`${w}${g}`},e[2]=l,e[3]=m,e[4]=c,e[5]=d):d=e[5];const h=d;let f,y;e[6]===Symbol.for("react.memo_cache_sentinel")?(y={},e[6]=y):y=e[6];const v=i;let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=[],e[7]=b):b=e[7];let x;e[8]!==s||e[9]!==r?(x=C=>{const{childId:w,...g}=C,T=s?.find(A=>A._id===w||ut(A._id)===w);return T?o.jsx(dt,{...g,state:{id:w,type:T._type,_searchParams:Object.entries(r)}}):o.jsx("div",{...g})},e[8]=s,e[9]=r,e[10]=x):x=e[10];let j,_;e[11]!==r?(j=C=>o.jsx(ji,{...C,searchParams:r}),_=C=>o.jsx(Ei,{...C,searchParams:r}),e[11]=r,e[12]=j,e[13]=_):(j=e[12],_=e[13]);let P;e[14]!==a?(P=C=>{a({...C,inspect:C.inspect??void 0})},e[14]=a,e[15]=P):P=e[15];let S;e[16]!==h||e[17]!==v||e[18]!==x||e[19]!==j||e[20]!==_||e[21]!==P?(S={index:0,groupIndex:0,siblingIndex:0,payload:y,params:v,hasGroupSiblings:!1,groupLength:1,routerPanesState:b,ChildLink:x,BackLink:j,ReferenceChildLink:_,ParameterizedLink:ki,closeCurrentAndAfter:Di,handleEditReference:Mi,replaceCurrent:Ai,closeCurrent:$i,duplicateCurrent:Ii,setView:Ti,setParams:P,setPayload:Ri,navigateIntent:Ci,createPathWithParams:h},e[16]=h,e[17]=v,e[18]=x,e[19]=j,e[20]=_,e[21]=P,e[22]=S):S=e[22],f=S;const R=f;let E;return e[23]!==t||e[24]!==R?(E=o.jsx(_r.Provider,{value:R,children:t}),e[23]=t,e[24]=R,e[25]=E):E=e[25],E}function Ci(n,e,t){console.warn("navigateIntent",n,e,t)}function Ri(n){console.warn("setPayload",n)}function Ti(n){console.warn("setView",n)}function Ii(n){console.warn("duplicateCurrent",n)}function $i(){console.warn("closeCurrent")}function Ai(n){console.warn("replaceCurrent",n)}function Mi(n){console.warn("handleEditReference",n)}function Di(){console.warn("closeCurrentAndAfter")}function ki(){throw new Error("ParameterizedLink not implemented")}const Oi=le(on)`
  height: 100%;
`,Li=le(Q)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,zi=le(ot)`
  white-space: pre-wrap;
`;function Ui(n){const e=D.c(33),{mainDocumentState:t,onStructureParams:a,searchParams:i,refs:r}=n,{t:s}=we(be),{devMode:c}=Et();let l,u;if(e[0]!==t?.document?._id||e[1]!==r){let w;e[3]!==t?.document?._id?(w=g=>ut(g._id)!==t?.document?._id,e[3]=t?.document?._id,e[4]=w):w=e[4],u=r.filter(w).map(Ni),e[0]=t?.document?._id,e[1]=r,e[2]=u}else u=e[2];l=u;const m=l;let d,h;e[5]!==m?(h={filter:"_id in $ids",params:{ids:m}},e[5]=m,e[6]=h):h=e[6];let f;e[7]!==s?(f=s("document-list-pane.document-list.title"),e[7]=s,e[8]=f):f=e[8];let y;e[9]!==h||e[10]!==f?(y={id:"$root",options:h,schemaTypeName:"",title:f,type:"documentList"},e[9]=h,e[10]=f,e[11]=y):y=e[11],d=y;const v=d,[b,x]=p.useState(null);let j;e[12]===Symbol.for("react.memo_cache_sentinel")?(j=()=>x(null),e[12]=j):j=e[12];const _=j,[P]=p.useState(Wi);let S;e[13]===Symbol.for("react.memo_cache_sentinel")?(S=()=>x(null),e[13]=S):S=e[13];let R;if(e[14]!==r?(R=[r],e[14]=r,e[15]=R):R=e[15],p.useEffect(S,R),b){let w;e[16]!==s?(w=s("document-list-pane.error.text"),e[16]=s,e[17]=w):w=e[17];let g;e[18]!==c||e[19]!==b||e[20]!==s?(g=c&&o.jsx(ce,{overflow:"auto",padding:3,radius:2,tone:"critical",children:o.jsxs(Se,{space:3,children:[o.jsx(at,{muted:!0,size:0,children:s("presentation-error.label")}),o.jsx(zi,{size:1,children:b.error.message})]})}),e[18]=c,e[19]=b,e[20]=s,e[21]=g):g=e[21];let T;return e[22]!==g||e[23]!==w?(T=o.jsx(Ot,{flex:1,message:w,onRetry:_,children:g}),e[22]=g,e[23]=w,e[24]=T):T=e[24],T}let E;e[25]!==v?(E=o.jsx(Li,{direction:"column",flex:1,children:o.jsx(Tr,{index:0,itemId:"$root",pane:v,paneKey:"$root"})}),e[25]=v,e[26]=E):E=e[26];let C;return e[27]!==a||e[28]!==r||e[29]!==i||e[30]!==P||e[31]!==E?(C=o.jsx(pn,{onCatch:x,children:o.jsx(Oi,{children:o.jsx(dn,{children:o.jsx(Cn,{onStructureParams:a,structureParams:P,searchParams:i,refs:r,children:E})})})}),e[27]=a,e[28]=r,e[29]=i,e[30]=P,e[31]=E,e[32]=C):C=e[32],C}function Wi(){return{}}function Ni(n){return ut(n._id)}const Vi=le(ot)`
  white-space: pre-wrap;
`;function Fi(n){const e=D.c(35),{documentId:t,documentType:a,onFocusPath:i,onStructureParams:r,searchParams:s,structureParams:c}=n,{template:l,templateParams:u}=c,{t:m}=we(be),{devMode:d}=Et();let h,f;e[0]!==u?(f=Sr(u),e[0]=u,e[1]=f):f=e[1];let y;e[2]!==t||e[3]!==a||e[4]!==f||e[5]!==l?(y={id:t,type:a,template:l,templateParameters:f},e[2]=t,e[3]=a,e[4]=f,e[5]=l,e[6]=y):y=e[6];let v;e[7]!==t||e[8]!==y?(v={id:t,options:y,title:"",type:"document"},e[7]=t,e[8]=y,e[9]=v):v=e[9],h=v;const b=h,[x,j]=p.useState(null);let _;e[10]===Symbol.for("react.memo_cache_sentinel")?(_=()=>j(null),e[10]=_):_=e[10];const P=_;let S;e[11]===Symbol.for("react.memo_cache_sentinel")?(S=()=>{j(null)},e[11]=S):S=e[11];let R;if(e[12]!==t||e[13]!==a||e[14]!==c?(R=[t,a,c],e[12]=t,e[13]=a,e[14]=c,e[15]=R):R=e[15],p.useEffect(S,R),x){let T;e[16]!==m?(T=m("document-pane.error.text"),e[16]=m,e[17]=T):T=e[17];let A;e[18]!==d||e[19]!==x||e[20]!==m?(A=d&&o.jsx(ce,{overflow:"auto",padding:3,radius:2,tone:"critical",children:o.jsxs(Se,{space:3,children:[o.jsx(at,{muted:!0,size:0,children:m("presentation-error.label")}),o.jsx(Vi,{size:1,children:x.error.message})]})}),e[18]=d,e[19]=x,e[20]=m,e[21]=A):A=e[21];let I;return e[22]!==T||e[23]!==A?(I=o.jsx(Ot,{flex:1,message:T,onRetry:P,children:A}),e[22]=T,e[23]=A,e[24]=I):I=e[24],I}let E;e[25]===Symbol.for("react.memo_cache_sentinel")?(E={height:"100%"},e[25]=E):E=e[25];let C;e[26]===Symbol.for("react.memo_cache_sentinel")?(C=o.jsx(en,{}),e[26]=C):C=e[26];let w;e[27]!==i||e[28]!==b?(w=o.jsx(p.Suspense,{fallback:C,children:o.jsx(jr,{paneKey:"document",index:1,itemId:"document",pane:b,onFocusPath:i})}),e[27]=i,e[28]=b,e[29]=w):w=e[29];let g;return e[30]!==r||e[31]!==s||e[32]!==c||e[33]!==w?(g=o.jsx(pn,{onCatch:j,children:o.jsx(on,{style:E,children:o.jsx(Cn,{searchParams:s,onStructureParams:r,structureParams:c,children:w})})}),e[30]=r,e[31]=s,e[32]=c,e[33]=w,e[34]=g):g=e[34],g}function Bi(n){const e=D.c(7),{documentId:t,documentType:a,onFocusPath:i,onStructureParams:r,searchParams:s,structureParams:c}=n;let l;return e[0]!==t||e[1]!==a||e[2]!==i||e[3]!==r||e[4]!==s||e[5]!==c?(l=o.jsx(dn,{children:o.jsx(Fi,{documentId:t,documentType:a,onFocusPath:i,onStructureParams:r,searchParams:s,structureParams:c})}),e[0]=t,e[1]=a,e[2]=i,e[3]=r,e[4]=s,e[5]=c,e[6]=l):l=e[6],l}function Ki(n,e){const t=D.c(6),a=Pr();let i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i={},t[0]=i):i=t[0];const[r,s]=p.useState(i);let c,l;return t[1]!==n||t[2]!==a||t[3]!==e?(c=()=>{if(!e)return;const u=Er(a,e,n,"").subscribe(m=>{s(m)});return()=>{u?.unsubscribe()}},l=[a,e,n],t[1]=n,t[2]=a,t[3]=e,t[4]=c,t[5]=l):(c=t[4],l=t[5]),p.useEffect(c,l),r}function Hi(n){const e=D.c(39),{documentId:t,documentType:a,mainDocumentState:i,onFocusPath:r,onStructureParams:s,refs:c,searchParams:l,structureParams:u}=n,{t:m}=we(be),d=hr();let h;e[0]!==i?.document?._id||e[1]!==i?.document?._type||e[2]!==l?(h=E=>o.jsx(dt,{...E,state:{id:i?.document?._id,type:i?.document?._type,_searchParams:Object.entries(l)}}),e[0]=i?.document?._id,e[1]=i?.document?._type,e[2]=l,e[3]=h):h=e[3];const f=h;let y,v;e[4]!==i?.document?._type||e[5]!==d?(v=d.get(i?.document?._type||"shoe"),e[4]=i?.document?._type,e[5]=d,e[6]=v):v=e[6],y=v;const b=y,x=Ki(i?.document?._id||"",b);let j;e:{if(!i?.document){j=null;break e}const E=i.document;let C;e[7]!==x.draft||e[8]!==x.published||e[9]!==E?(C=gr({value:E,published:x.published,draft:x.draft}),e[7]=x.draft,e[8]=x.published,e[9]=E,e[10]=C):C=e[10];let w;e[11]!==m?(w=m("main-document.label"),e[11]=m,e[12]=w):w=e[12];let g;e[13]!==w?(g=o.jsx(ce,{padding:1,radius:2,shadow:1,children:o.jsx(W,{muted:!0,size:0,weight:"medium",children:w})}),e[13]=w,e[14]=g):g=e[14];let T;e[15]!==b||e[16]!==C||e[17]!==g?(T=o.jsx(vr,{...C,schemaType:b,status:g}),e[15]=b,e[16]=C,e[17]=g,e[18]=T):T=e[18],j=T}const _=j;if(t&&a){let E;return e[19]!==t||e[20]!==a||e[21]!==r||e[22]!==s||e[23]!==l||e[24]!==u?(E=o.jsx(Bi,{documentId:t,documentType:a,onFocusPath:r,onStructureParams:s,searchParams:l,structureParams:u}),e[19]=t,e[20]=a,e[21]=r,e[22]=s,e[23]=l,e[24]=u,e[25]=E):E=e[25],E}let P;e[26]!==f||e[27]!==i||e[28]!==_||e[29]!==m?(P=i&&o.jsx(ce,{padding:3,tone:i.document?"inherit":"caution",children:i.document?o.jsx(xr,{__unstable_focusRing:!0,as:f,"data-as":"a",radius:2,sizing:"border",tone:"inherit",children:_}):o.jsx(ce,{padding:2,radius:2,tone:"inherit",children:o.jsxs(Q,{gap:3,children:[o.jsx(ee,{flex:"none",children:o.jsx(W,{size:1,children:o.jsx(yr,{})})}),o.jsx(ee,{flex:1,children:o.jsx(W,{size:1,children:o.jsx(wr,{t:m,i18nKey:"main-document.missing.text",components:{Code:"code"},values:{path:i.path}})})})]})})}),e[26]=f,e[27]=i,e[28]=_,e[29]=m,e[30]=P):P=e[30];let S;e[31]!==i||e[32]!==s||e[33]!==c||e[34]!==l?(S=o.jsx(Ui,{mainDocumentState:i,onStructureParams:s,searchParams:l,refs:c}),e[31]=i,e[32]=s,e[33]=c,e[34]=l,e[35]=S):S=e[35];let R;return e[36]!==P||e[37]!==S?(R=o.jsxs(Q,{direction:"column",flex:1,height:"fill",children:[P,S]}),e[36]=P,e[37]=S,e[38]=R):R=e[38],R}function qi(n){const e=D.c(2);let t;e[0]!==n?(t=()=>n||kr(),e[0]=n,e[1]=t):t=e[1];const[a]=p.useState(t);return a}const Gi=le.div`
  position: relative;
`,Qi=le.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:n})=>n?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:n})=>!n&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,Rn=function(n){const e=D.c(27),{id:t,order:a,disabled:i}=n,r=i===void 0?!1:i,s=p.useRef(null),c=p.useContext(jt);if(c===null)throw Error("Panel components must be rendered within a PanelGroup container");const l=qi(t),{activeResizer:u,drag:m,startDragging:d,stopDragging:h,registerElement:f,unregisterElement:y}=c,v=u===l;if(c===null)throw Error("Panel components must be rendered within a PanelGroup container");let b;e[0]!==l||e[1]!==d?(b=k=>{d(l,k.nativeEvent)},e[0]=l,e[1]=d,e[2]=b):b=e[2];const x=b;let j;e[3]!==m||e[4]!==l?(j=k=>{m(l,k)},e[3]=m,e[4]=l,e[5]=j):j=e[5];const _=j;let P;e[6]!==h?(P=()=>{s.current.blur(),h()},e[6]=h,e[7]=P):P=e[7];const S=P;let R,E;e[8]!==r||e[9]!==v||e[10]!==_||e[11]!==S?(R=()=>{if(!v||r)return;const k=function(){const O=document.body.style,z=document.documentElement.style,{cursor:V}=z,{userSelect:H}=O;return z.cursor="ew-resize",O.userSelect="none",()=>{V?z.cursor=V:z.removeProperty("cursor"),H?O.userSelect=H:O.removeProperty("user-select")}}();return window.addEventListener("mousemove",_),window.addEventListener("mouseup",S),window.addEventListener("contextmenu",S),()=>{k(),window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",S),window.removeEventListener("contextmenu",S)}},E=[r,v,_,S],e[8]=r,e[9]=v,e[10]=_,e[11]=S,e[12]=R,e[13]=E):(R=e[12],E=e[13]),p.useEffect(R,E);let C,w;e[14]!==l||e[15]!==a||e[16]!==f||e[17]!==y?(C=()=>(f(l,{id:l,order:a,type:"resizer",el:s}),()=>{y(l)}),w=[l,a,f,y],e[14]=l,e[15]=a,e[16]=f,e[17]=y,e[18]=C,e[19]=w):(C=e[18],w=e[19]),p.useLayoutEffect(C,w);let g,T;e[20]===Symbol.for("react.memo_cache_sentinel")?(T=o.jsx("span",{}),g=o.jsx("span",{}),e[20]=g,e[21]=T):(g=e[20],T=e[21]);let A;e[22]!==r?(A=o.jsxs(Qi,{$disabled:r,children:[T,g]}),e[22]=r,e[23]=A):A=e[23];let I;return e[24]!==x||e[25]!==A?(I=o.jsx(Gi,{onMouseDown:x,ref:s,children:A}),e[24]=x,e[25]=A,e[26]=I):I=e[26],I},Xi=n=>{const e=D.c(8),{documentId:t,setDisplayedDocument:a,getCommentIntent:i}=n;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=o.jsx(Rn,{order:4}),e[0]=r):r=e[0];let s;e[1]!==i||e[2]!==n.children?(s=o.jsx(Zn,{getIntent:i,children:n.children}),e[1]=i,e[2]=n.children,e[3]=s):s=e[3];let c;return e[4]!==t||e[5]!==a||e[6]!==s?(c=o.jsxs(o.Fragment,{children:[r,o.jsx(kt,{id:"content",minWidth:325,order:5,children:o.jsx(Lr,{documentId:t,setDisplayedDocument:a,children:s})})]}),e[4]=t,e[5]=a,e[6]=s,e[7]=c):c=e[7],c},Ji=n=>{const e=D.c(14),{documentId:t,documentsOnPage:a,documentType:i,getCommentIntent:r,mainDocumentState:s,onFocusPath:c,onStructureParams:l,searchParams:u,setDisplayedDocument:m,structureParams:d}=n;let h;e[0]!==t||e[1]!==i||e[2]!==a||e[3]!==s||e[4]!==c||e[5]!==l||e[6]!==u||e[7]!==d?(h=o.jsx(Hi,{documentId:t,documentType:i,mainDocumentState:s,onFocusPath:c,onStructureParams:l,refs:a,searchParams:u,structureParams:d}),e[0]=t,e[1]=i,e[2]=a,e[3]=s,e[4]=c,e[5]=l,e[6]=u,e[7]=d,e[8]=h):h=e[8];let f;return e[9]!==t||e[10]!==r||e[11]!==m||e[12]!==h?(f=o.jsx(Xi,{documentId:t,getCommentIntent:r,setDisplayedDocument:m,children:h}),e[9]=t,e[10]=r,e[11]=m,e[12]=h,e[13]=f):f=e[13],f},Yi=function(n){const e=D.c(5),{children:t,navigate:a}=n;let i;e[0]!==a?(i=(c,l)=>{a((l===void 0?void 0:l)||{},c?{preview:c}:{})},e[0]=a,e[1]=i):i=e[1];const r=i;let s;return e[2]!==t||e[3]!==r?(s=o.jsx(qn.Provider,{value:r,children:t}),e[2]=t,e[3]=r,e[4]=s):s=e[4],s};function Zi(n,e){const t=D.c(9);let a;t[0]!==e||t[1]!==n?(a=()=>JSON.parse(localStorage.getItem(n)??JSON.stringify(e)),t[0]=e,t[1]=n,t[2]=a):a=t[2];const[i,r]=p.useState(a);let s,c;t[3]!==n||t[4]!==i?(s=()=>{localStorage.setItem(n,JSON.stringify(i))},c=[n,i],t[3]=n,t[4]=i,t[5]=s,t[6]=c):(s=t[5],c=t[6]),p.useEffect(s,c);let l;return t[7]!==i?(l=[i,r],t[7]=i,t[8]=l):l=t[8],l}function es(n){const e=D.c(11),{unstable_navigator:t}=n,a=!!t?.component,[i,r]=Zi("presentation/navigator",a),s=a?i:!1;let c;e:{if(!a){c=void 0;break e}let f;e[0]!==r?(f=()=>r(ts),e[0]=r,e[1]=f):f=e[1],c=f}const l=c;let u;e[2]!==s||e[3]!==t?(u=function(){return o.jsx(o.Fragment,{children:s&&o.jsx(rs,{...t})})},e[2]=s,e[3]=t,e[4]=u):u=e[4];const m=u;let d;e[5]!==s||e[6]!==l?(d={navigatorEnabled:s,toggleNavigator:l},e[5]=s,e[6]=l,e[7]=d):d=e[7];let h;return e[8]!==m||e[9]!==d?(h=[d,m],e[8]=m,e[9]=d,e[10]=h):h=e[10],h}function ts(n){return!n}function ns(n){const e=D.c(11),{minWidth:t,maxWidth:a,component:i}=n,r=t!=null&&a!=null&&t===a;let s;e[0]!==i?(s=o.jsx(i,{}),e[0]=i,e[1]=s):s=e[1];let c;e[2]!==a||e[3]!==t||e[4]!==s?(c=o.jsx(kt,{id:"navigator",minWidth:t,maxWidth:a,order:1,children:s}),e[2]=a,e[3]=t,e[4]=s,e[5]=c):c=e[5];let l;e[6]!==r?(l=o.jsx(Rn,{order:2,disabled:r}),e[6]=r,e[7]=l):l=e[7];let u;return e[8]!==c||e[9]!==l?(u=o.jsxs(o.Fragment,{children:[c,l]}),e[8]=c,e[9]=l,e[10]=u):u=e[10],u}const rs=p.memo(ns),is=function(n){const e=D.c(3),{children:t,params:a}=n;let i;i=a;const r=i;let s;return e[0]!==t||e[1]!==r?(s=o.jsx(Gn.Provider,{value:r,children:t}),e[0]=t,e[1]=r,e[2]=s):s=e[2],s},ss=function(n){const e=D.c(10),{children:t,devMode:a,name:i,navigate:r,params:s,searchParams:c,structureParams:l}=n;let u,m;e[0]!==a||e[1]!==i||e[2]!==r||e[3]!==s||e[4]!==c||e[5]!==l?(m={devMode:a,name:i,navigate:r,params:s,searchParams:c,structureParams:l},e[0]=a,e[1]=i,e[2]=r,e[3]=s,e[4]=c,e[5]=l,e[6]=m):m=e[6],u=m;const d=u;let h;return e[7]!==t||e[8]!==d?(h=o.jsx(Hn.Provider,{value:d,children:t}),e[7]=t,e[8]=d,e[9]=h):h=e[9],h},as=Ze.create(le.iframe`
  box-shadow: 0 0 0 1px var(--card-border-color);
  border: 0;
  max-height: 100%;
  width: 100%;
  view-transition-class: presentation-tool-iframe;
`),os=le(ee)`
  position: absolute;
  inset: 0;
  background: transparent;
`,cs=p.forwardRef(function(n,e){const t=D.c(16),{animate:a,initial:i,onLoad:r,preventClick:s,src:c,variants:l,style:u}=n,m=`presentation-tool-iframe-${p.useId().replace(/[^a-zA-Z0-9-_]/g,"_")}`;let d;t[0]!==u||t[1]!==m?(d={...u,viewTransitionName:m},t[0]=u,t[1]=m,t[2]=d):d=t[2];let h;t[3]!==a||t[4]!==i||t[5]!==r||t[6]!==e||t[7]!==c||t[8]!==d||t[9]!==l?(h=o.jsx(as,{style:d,animate:a,initial:i,onLoad:r,ref:e,src:c,variants:l}),t[3]=a,t[4]=i,t[5]=r,t[6]=e,t[7]=c,t[8]=d,t[9]=l,t[10]=h):h=t[10];let f;t[11]!==s?(f=s&&o.jsx(os,{}),t[11]=s,t[12]=f):f=t[12];let y;return t[13]!==h||t[14]!==f?(y=o.jsxs(o.Fragment,{children:[h,f]}),t[13]=h,t[14]=f,t[15]=y):y=t[15],y});function ls(n){const e=D.c(16),{openPopup:t,previewLocationOrigin:a,previewLocationRoute:i}=n,{t:r}=we(be);let s;e[0]!==t?(s=v=>{v.preventDefault(),t(v.currentTarget.href)},e[0]=t,e[1]=s):s=e[1];const c=s;let l;e[2]!==r?(l=r("share-url.menu-item.open.text"),e[2]=r,e[3]=l):l=e[3];let u;e[4]!==l?(u=o.jsx(W,{size:1,children:l}),e[4]=l,e[5]=u):u=e[5];let m;e[6]===Symbol.for("react.memo_cache_sentinel")?(m=["bottom-start"],e[6]=m):m=e[6];let d;e[7]!==r?(d=r("share-url.menu-item.open.text"),e[7]=r,e[8]=d):d=e[8];const h=`${a}${i}`;let f;e[9]!==c||e[10]!==d||e[11]!==h?(f=o.jsx(ye,{as:"a","aria-label":d,icon:Cr,mode:"bleed",href:h,rel:"opener",target:"_blank",tooltipProps:null,onClick:c}),e[9]=c,e[10]=d,e[11]=h,e[12]=f):f=e[12];let y;return e[13]!==u||e[14]!==f?(y=o.jsx(Qe,{animate:!0,content:u,fallbackPlacements:m,placement:"bottom",portal:!0,children:f}),e[13]=u,e[14]=f,e[15]=y):y=e[15],y}const us=function(n){const e=D.c(27),{fontSize:t,onChange:a,origin:i,padding:r,prefix:s,suffix:c,value:l}=n,u=t===void 0?1:t,m=r===void 0?3:r,{t:d}=we(be),{basePath:h}=rn()?.activeWorkspace||{},f=h===void 0?"/":h,y=p.useRef(null),[v,b]=p.useState(void 0),[x,j]=p.useState(void 0);let _;e[0]===Symbol.for("react.memo_cache_sentinel")?(_=H=>{b(H.currentTarget.value)},e[0]=_):_=e[0];const P=_;let S;e[1]!==f||e[2]!==a||e[3]!==i||e[4]!==v||e[5]!==d?(S=H=>{if(H.key==="Enter"){if(v===void 0)return;const F=v.startsWith("/")||v===""?`${i}${v}`:v;if(!F.startsWith(`${i}/`)&&F!==i){j(d("preview-location-input.error",{origin:i,context:"missing-origin"}));return}if(!i&&(F.startsWith(`${f}/`)||F===f)){j(d("preview-location-input.error",{basePath:f,context:"same-base-path"}));return}const q=F===i?`${i}/`:F;j(void 0),b(void 0),a(q.slice(i.length)),y.current?.blur()}H.key==="Escape"&&(j(void 0),b(void 0))},e[1]=f,e[2]=a,e[3]=i,e[4]=v,e[5]=d,e[6]=S):S=e[6];const R=S;let E;e[7]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{j(void 0),b(void 0)},e[7]=E):E=e[7];const C=E;let w;e[8]===Symbol.for("react.memo_cache_sentinel")?(w=()=>{j(void 0),b(void 0)},e[8]=w):w=e[8];let g;e[9]!==i||e[10]!==l?(g=[i,l],e[9]=i,e[10]=l,e[11]=g):g=e[11],p.useEffect(w,g);let T,A;e[12]===Symbol.for("react.memo_cache_sentinel")?(A={icon:Rr},e[12]=A):A=e[12],T=A;const I=x?T:void 0;let k;e[13]!==i||e[14]!==l?(k=()=>{j(void 0),b(i+l)},e[13]=i,e[14]=l,e[15]=k):k=e[15];let O;e[16]===Symbol.for("react.memo_cache_sentinel")?(O={zIndex:1},e[16]=O):O=e[16];const z=v===void 0?`${i}${l}`:v;let V;return e[17]!==x||e[18]!==u||e[19]!==R||e[20]!==m||e[21]!==s||e[22]!==c||e[23]!==I||e[24]!==k||e[25]!==z?(V=o.jsx(o.Fragment,{children:o.jsx(br,{clearButton:I,customValidity:x,fontSize:u,onBlur:C,onClear:k,onChange:P,onKeyDownCapture:R,padding:m,prefix:s,style:O,radius:2,ref:y,space:m,suffix:c,value:z})}),e[17]=x,e[18]=u,e[19]=R,e[20]=m,e[21]=s,e[22]=c,e[23]=I,e[24]=k,e[25]=z,e[26]=V):V=e[26],V},ds=p.lazy(()=>_e(()=>import("./QRCodeSVG.DWIRcn2A.js"),__vite__mapDeps([0,1,2,3,4]))),St=24,ps=16,ms=224,fs=le(sr)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: ${St}px;
  width: ${St}px;
`,hs=Ze.create(st),gs=Ze.create(W),vs=Ze.create(fs),Tn=p.memo(function(n){const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:t,initialUrl:a,previewLocationRoute:i,perspective:r}=n,{t:s}=we(be),{push:c}=Zt(),l=Ye({apiVersion:lt}),u=Ct(),[m,d]=p.useState(!0),[h,f]=p.useState(!1),[y,v]=p.useState(!1),[b,x]=p.useState(null),j=h||y||m,_=p.useMemo(()=>b?Kr(a,b,i,r):null,[a,r,i,b]),[P,S]=p.useState(null);if(P)throw P;const R=p.useCallback(()=>{c({closable:!0,status:"warning",title:s("share-preview-menu.error_toggle-sharing",{context:"toggle-sharing"})})},[c,s]),E=p.useCallback(async()=>{try{v(!0),await qr(l,"@sanity/presentation",typeof window>"u"?"":location.href,u?.id),x(null)}catch(g){S(g)}finally{v(!1)}},[l,u?.id]),C=p.useCallback(async()=>{try{f(!0);const g=await Hr(l,"@sanity/presentation",typeof window>"u"?"":location.href,u?.id);x(g.secret)}catch(g){S(g)}finally{f(!1)}},[l,u?.id]),w=p.useCallback(()=>{try{if(!_)throw new Error("No URL to copy");navigator.clipboard.writeText(_.toString()),c({closable:!0,status:"success",title:s("share-url.clipboard.status",{context:"success"})})}catch(g){S(g)}},[c,s,_]);return p.useEffect(()=>{let g=new AbortController,T=[];async function A(k,O){const{result:z,syncTags:V}=await l.fetch(Ur,{},{filterResponse:!1,lastLiveEventId:k,tag:"presentation.fetch-shared-access-secret"});Array.isArray(V)&&(T=V),O.aborted||x(z)}const I=l.live.events().subscribe({next:k=>{k.type==="message"&&(g.abort(),g=new AbortController,k.tags.some(O=>T.includes(O))&&A(k.id,g.signal))},error:S});return A(null,g.signal).finally(()=>d(!1)),()=>{I.unsubscribe(),g.abort()}},[l]),o.jsx(cn,{button:o.jsx(ye,{"aria-label":s("preview-frame.share-button.aria-label"),icon:lr,mode:"bleed",tooltipProps:null}),id:"share-menu",menu:o.jsx(ln,{style:{maxWidth:248},padding:t?void 0:0,children:t?o.jsxs(o.Fragment,{children:[o.jsx("label",{style:{cursor:"pointer"},children:o.jsxs(ar,{columns:2,rows:2,gapX:3,gapY:1,style:{justifyContent:"center",alignItems:"center",gridTemplateColumns:"min-content 1fr",gridTemplateRows:"min-content"},paddingTop:3,paddingX:3,children:[o.jsx(Qe,{animate:!0,content:o.jsx(W,{size:1,children:s("share-preview-menu.toggle-button.tooltip",{context:_?"disable":"enable"})}),fallbackPlacements:["bottom-start"],placement:"bottom",portal:!0,children:o.jsx(un,{checked:h||_!==null&&!y,readOnly:h||y,indeterminate:m,onChange:e?_?E:C:R})}),o.jsx(W,{size:1,weight:"medium",children:s("share-preview-menu.toggle-button.label",{context:"first-line"})}),o.jsx("span",{}),o.jsx(W,{muted:!0,size:1,children:s("share-preview-menu.toggle-button.label",{context:"second-line"})})]})}),o.jsx(ee,{padding:3,paddingTop:2,children:o.jsxs(Se,{space:3,children:[o.jsx(ce,{tone:j||!_?"transparent":void 0,style:{position:"relative",aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:o.jsx(an,{children:j?o.jsx(hs,{muted:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}):_?o.jsx(o.Fragment,{children:o.jsxs(p.Suspense,{fallback:o.jsx(st,{}),children:[o.jsx(ds,{title:s("share-preview-menu.qr-code.title",{url:_.toString()}),value:_.toString(),size:ms,color:"var(--card-fg-color)",logoSize:St+ps}),o.jsx(vs,{initial:{opacity:-.5},animate:{opacity:1.5},exit:{opacity:0}})]})}):o.jsx(gs,{muted:!0,size:1,style:{maxWidth:"100px",textWrap:"pretty",textAlign:"center"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:s("share-preview-menu.qr-code.placeholder")})})}),o.jsx(W,{muted:!0,size:1,children:s("share-preview-menu.qr-code.instructions")})]})}),o.jsx(or,{}),o.jsx(bt,{disabled:!_||y,icon:cr,onClick:w,text:s("share-preview-menu.copy-url.text")})]}):o.jsx(ce,{padding:2,tone:"caution",radius:3,children:o.jsx(W,{style:{textWrap:"pretty"},children:s("share-preview-menu.error",{context:"missing-grants"})})})}),popover:{constrainSize:!0,placement:"bottom",portal:!0}})});Tn.displayName="Memo(SharePreviewMenu)";const vt={previewDrafts:"preview-frame.perspective.previewDrafts.title",published:"preview-frame.perspective.published.title"},qt={previewDrafts:"caution",published:"positive"},xs=n=>{const e=D.c(131),{canSharePreviewAccess:t,canToggleSharePreviewAccess:a,canUseSharedPreviewAccess:i,dispatch:r,iframe:s,iframeRef:c,initialUrl:l,loadersConnection:u,navigatorEnabled:m,onPathChange:d,onRefresh:h,openPopup:f,overlaysConnection:y,perspective:v,previewUrl:b,setPerspective:x,setViewport:j,targetOrigin:_,toggleNavigator:P,toggleOverlay:S,viewport:R,visualEditing:E}=n,{overlaysEnabled:C}=E,{t:w}=we(be);let g;e[0]!==j||e[1]!==R?(g=()=>j(R==="desktop"?"mobile":"desktop"),e[0]=j,e[1]=R,e[2]=g):g=e[2];const T=g;let A;A=_===location.origin?"":_;const I=A;let k;e[3]!==r||e[4]!==c.current||e[5]!==h||e[6]!==b||e[7]!==_?(k=()=>{h(()=>{c.current&&(r({type:sn}),Object.assign(c.current,{src:`${_}${b||"/"}`}))})},e[3]=r,e[4]=c.current,e[5]=h,e[6]=b,e[7]=_,e[8]=k):k=e[8];const O=k;let z;const V=new URL(b||"/",_),{pathname:H,search:F}=Br(V);z=`${H}${F}`;const q=z;let Z;e[9]===Symbol.for("react.memo_cache_sentinel")?(Z={width:"100%"},e[9]=Z):Z=e[9];let te;e[10]!==m||e[11]!==w||e[12]!==P?(te=P&&o.jsx(ye,{"aria-label":w("preview-frame.navigator.toggle-button.aria-label"),icon:er,mode:"bleed",onClick:P,selected:m,tooltipProps:{content:o.jsx(W,{size:1,children:w("preview-frame.navigator.toggle-button.tooltip")}),fallbackPlacements:["bottom-start"],placement:"bottom"}}),e[10]=m,e[11]=w,e[12]=P,e[13]=te):te=e[13];let ne;e[14]===Symbol.for("react.memo_cache_sentinel")?(ne={whiteSpace:"nowrap"},e[14]=ne):ne=e[14];const ue=C?"disable":"enable";let M;e[15]!==w||e[16]!==ue?(M=w("preview-frame.overlay.toggle-button.tooltip",{context:ue}),e[15]=w,e[16]=ue,e[17]=M):M=e[17];let re;e[18]!==M?(re=o.jsx(ee,{padding:1,children:o.jsx(W,{size:1,children:M})}),e[18]=M,e[19]=re):re=e[19];let ie;e[20]===Symbol.for("react.memo_cache_sentinel")?(ie=o.jsx(ee,{paddingY:1,children:o.jsx(ur,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})}),e[20]=ie):ie=e[20];let ae;e[21]!==re?(ae=o.jsxs(Q,{align:"center",style:ne,children:[re,ie]}),e[21]=re,e[22]=ae):ae=e[22];let B;e[23]===Symbol.for("react.memo_cache_sentinel")?(B=["bottom-start"],e[23]=B):B=e[23];let K;e[24]===Symbol.for("react.memo_cache_sentinel")?(K={lineHeight:0,borderRadius:999,userSelect:"none"},e[24]=K):K=e[24];const N=C?"transparent":void 0;let G;e[25]===Symbol.for("react.memo_cache_sentinel")?(G={margin:-4},e[25]=G):G=e[25];const oe=s.status==="loading"||y!=="connected";let Y;e[26]!==C||e[27]!==oe||e[28]!==S?(Y=o.jsx("div",{style:G,children:o.jsx(un,{checked:C,onChange:S,disabled:oe})}),e[26]=C,e[27]=oe,e[28]=S,e[29]=Y):Y=e[29];const X=!C;let J;e[30]!==w?(J=w("preview-frame.overlay.toggle-button.text"),e[30]=w,e[31]=J):J=e[31];let se;e[32]!==X||e[33]!==J?(se=o.jsx(ee,{children:o.jsx(W,{muted:X,size:1,weight:"medium",children:J})}),e[32]=X,e[33]=J,e[34]=se):se=e[34];let de;e[35]!==Y||e[36]!==se?(de=o.jsxs(Q,{align:"center",gap:3,children:[Y,se]}),e[35]=Y,e[36]=se,e[37]=de):de=e[37];let ge;e[38]!==N||e[39]!==de?(ge=o.jsx(ce,{as:"label",flex:"none",padding:3,marginX:1,style:K,tone:N,children:de}),e[38]=N,e[39]=de,e[40]=ge):ge=e[40];let pe;e[41]!==ae||e[42]!==ge?(pe=o.jsx(Qe,{animate:!0,content:ae,fallbackPlacements:B,placement:"bottom",portal:!0,children:ge}),e[41]=ae,e[42]=ge,e[43]=pe):pe=e[43];let ve;e[44]!==s.status||e[45]!==w?(ve=s.status==="loaded"?w("preview-frame.refresh-button.tooltip"):w("preview-frame.status",{context:s.status}),e[44]=s.status,e[45]=w,e[46]=ve):ve=e[46];let me;e[47]!==ve?(me=o.jsx(W,{size:1,children:ve}),e[47]=ve,e[48]=me):me=e[48];let xe;e[49]===Symbol.for("react.memo_cache_sentinel")?(xe=["bottom-end"],e[49]=xe):xe=e[49];let fe;e[50]!==w?(fe=w("preview-frame.refresh-button.aria-label"),e[50]=w,e[51]=fe):fe=e[51];const qe=s.status==="reloading"||s.status==="refreshing";let Pe;e[52]!==O||e[53]!==fe||e[54]!==qe?(Pe=o.jsx(ye,{"aria-label":fe,icon:dr,mode:"bleed",loading:qe,onClick:O,tooltipProps:null}),e[52]=O,e[53]=fe,e[54]=qe,e[55]=Pe):Pe=e[55];let je;e[56]!==me||e[57]!==Pe?(je=o.jsx(ee,{padding:1,children:o.jsx(Qe,{animate:!0,content:me,fallbackPlacements:xe,placement:"bottom",portal:!0,children:Pe})}),e[56]=me,e[57]=Pe,e[58]=je):je=e[58];let Ee;e[59]!==f||e[60]!==I||e[61]!==q?(Ee=o.jsx(ee,{padding:1,children:o.jsx(ls,{openPopup:f,previewLocationOrigin:I,previewLocationRoute:q})}),e[59]=f,e[60]=I,e[61]=q,e[62]=Ee):Ee=e[62];let Ce;e[63]!==d||e[64]!==I||e[65]!==q||e[66]!==je||e[67]!==Ee?(Ce=o.jsx(ee,{flex:1,children:o.jsx(us,{prefix:je,onChange:d,origin:I,suffix:Ee,value:q})}),e[63]=d,e[64]=I,e[65]=q,e[66]=je,e[67]=Ee,e[68]=Ce):Ce=e[68];const $=vt[u==="connected"?v:"previewDrafts"];let U;e[69]!==w||e[70]!==$?(U=w($),e[69]=w,e[70]=$,e[71]=U):U=e[71];const L=u==="reconnecting"&&s.status!=="loaded",Ge=u!=="connected";let he;e[72]!==U||e[73]!==L||e[74]!==Ge?(he=o.jsx(ye,{iconRight:pr,mode:"bleed",text:U,loading:L,disabled:Ge}),e[72]=U,e[73]=L,e[74]=Ge,e[75]=he):he=e[75];let Ae;e[76]===Symbol.for("react.memo_cache_sentinel")?(Ae={maxWidth:240},e[76]=Ae):Ae=e[76];let Re;e[77]!==x?(Re=()=>x("previewDrafts"),e[77]=x,e[78]=Re):Re=e[78];const Te=v==="previewDrafts";let Me;e[79]!==v||e[80]!==w?(Me=()=>o.jsxs(Q,{align:"flex-start",gap:3,children:[o.jsx(ee,{flex:"none",children:o.jsx(W,{size:1,children:o.jsx(mr,{})})}),o.jsxs(Se,{flex:1,space:2,children:[o.jsx(W,{size:1,weight:"medium",children:w(vt.previewDrafts)}),o.jsx(W,{muted:!0,size:1,children:w("preview-frame.perspective.previewDrafts.text")})]}),o.jsx(ee,{flex:"none",children:o.jsx(W,{muted:!0,size:1,style:{opacity:v==="previewDrafts"?1:0},children:o.jsx(Wt,{})})})]}),e[79]=v,e[80]=w,e[81]=Me):Me=e[81];let De;e[82]!==Re||e[83]!==Te||e[84]!==Me?(De=o.jsx(bt,{onClick:Re,pressed:Te,tone:qt.previewDrafts,renderMenuItem:Me}),e[82]=Re,e[83]=Te,e[84]=Me,e[85]=De):De=e[85];let ke;e[86]!==x?(ke=()=>x("published"),e[86]=x,e[87]=ke):ke=e[87];const mt=v==="published";let Oe;e[88]!==v||e[89]!==w?(Oe=()=>o.jsxs(Q,{align:"flex-start",gap:3,children:[o.jsx(ee,{flex:"none",children:o.jsx(W,{size:1,children:o.jsx(fr,{})})}),o.jsxs(Se,{flex:1,space:2,children:[o.jsx(W,{size:1,weight:"medium",children:w(vt.published)}),o.jsx(W,{muted:!0,size:1,children:w("preview-frame.perspective.published.text")})]}),o.jsx(ee,{flex:"none",children:o.jsx(W,{muted:!0,size:1,style:{opacity:v==="published"?1:0},children:o.jsx(Wt,{})})})]}),e[88]=v,e[89]=w,e[90]=Oe):Oe=e[90];let Le;e[91]!==ke||e[92]!==mt||e[93]!==Oe?(Le=o.jsx(bt,{onClick:ke,pressed:mt,tone:qt.published,renderMenuItem:Oe}),e[91]=ke,e[92]=mt,e[93]=Oe,e[94]=Le):Le=e[94];let ze;e[95]!==De||e[96]!==Le?(ze=o.jsxs(ln,{style:Ae,children:[De,Le]}),e[95]=De,e[96]=Le,e[97]=ze):ze=e[97];let et;e[98]===Symbol.for("react.memo_cache_sentinel")?(et={constrainSize:!0,placement:"bottom",portal:!0},e[98]=et):et=e[98];let Ue;e[99]!==he||e[100]!==ze?(Ue=o.jsx(Q,{align:"center",flex:"none",gap:1,children:o.jsx(cn,{button:he,id:"perspective-menu",menu:ze,popover:et})}),e[99]=he,e[100]=ze,e[101]=Ue):Ue=e[101];const ft=R==="desktop"?"narrow":"full";let We;e[102]!==w||e[103]!==ft?(We=w("preview-frame.viewport-button.tooltip",{context:ft}),e[102]=w,e[103]=ft,e[104]=We):We=e[104];let Ne;e[105]!==We?(Ne=o.jsx(W,{size:1,children:We}),e[105]=We,e[106]=Ne):Ne=e[106];let tt;e[107]===Symbol.for("react.memo_cache_sentinel")?(tt=["bottom-start"],e[107]=tt):tt=e[107];let Ve;e[108]!==w?(Ve=w("preview-frame.viewport-button.aria-label"),e[108]=w,e[109]=Ve):Ve=e[109];const ht=R==="desktop"?tr:nr;let Fe;e[110]!==Ve||e[111]!==ht||e[112]!==T?(Fe=o.jsx(ye,{"aria-label":Ve,icon:ht,mode:"bleed",onClick:T,tooltipProps:null}),e[110]=Ve,e[111]=ht,e[112]=T,e[113]=Fe):Fe=e[113];let Be;e[114]!==Ne||e[115]!==Fe?(Be=o.jsx(Q,{align:"center",flex:"none",gap:1,children:o.jsx(Qe,{animate:!0,content:Ne,fallbackPlacements:tt,placement:"bottom",portal:!0,children:Fe})}),e[114]=Ne,e[115]=Fe,e[116]=Be):Be=e[116];let Ke;e[117]!==t||e[118]!==a||e[119]!==i||e[120]!==l||e[121]!==v||e[122]!==q?(Ke=t&&o.jsx(Q,{align:"center",flex:"none",gap:1,children:o.jsx(Tn,{canToggleSharePreviewAccess:a,canUseSharedPreviewAccess:i,previewLocationRoute:q,initialUrl:l,perspective:v})}),e[117]=t,e[118]=a,e[119]=i,e[120]=l,e[121]=v,e[122]=q,e[123]=Ke):Ke=e[123];let nt;return e[124]!==pe||e[125]!==Ce||e[126]!==Ue||e[127]!==Be||e[128]!==Ke||e[129]!==te?(nt=o.jsxs(Q,{align:"center",gap:1,paddingX:1,style:Z,children:[te,pe,Ce,Ue,Be,Ke]}),e[124]=pe,e[125]=Ce,e[126]=Ue,e[127]=Be,e[128]=Ke,e[129]=te,e[130]=nt):nt=e[130],nt};function ys(n){const e=D.c(7),t=ws,a=n.options?.component;let i;e[0]!==a||e[1]!==n?(i=a?o.jsx(a,{...n,renderDefault:t}):t(n),e[0]=a,e[1]=n,e[2]=i):i=e[2];const r=i;let s;e[3]===Symbol.for("react.memo_cache_sentinel")?(s={position:"relative"},e[3]=s):s=e[3];let c;e[4]===Symbol.for("react.memo_cache_sentinel")?(c={minHeight:0},e[4]=c):c=e[4];let l;return e[5]!==r?(l=o.jsx(ce,{flex:"none",padding:2,borderBottom:!0,style:s,children:o.jsx(Q,{align:"center",style:c,children:r})}),e[5]=r,e[6]=l):l=e[6],l}function ws(n){return o.jsx(xs,{...n})}function bs(n){const e=D.c(2);let t;return e[0]!==n?(t=()=>o.jsx(ys,{...n}),e[0]=n,e[1]=t):t=e[1],t}const xt=Ze.create(Q),In=p.memo(p.forwardRef(function(n,e){const{dispatch:t,iframe:a,header:i,initialUrl:r,loadersConnection:s,overlaysConnection:c,perspective:l,viewport:u,vercelProtectionBypass:m}=n,[d,h]=p.useState(null),f=d===null?l:d,y=p.useMemo(()=>{const M=new URL(r);return M.searchParams.get(Je)||M.searchParams.set(Je,f),(m||M.searchParams.get(Xe))&&M.searchParams.set(Mt,"samesitenone"),m&&!M.searchParams.get(Xe)&&M.searchParams.set(Xe,m),M},[r,f,m]);p.useEffect(()=>{s==="connected"&&h(M=>M===null?l:M)},[s,l]);const{t:v}=we(be),{devMode:b}=Et(),x=Xn(),j=p.useRef(null),_=bs({...n,iframeRef:j,options:i});p.useImperativeHandle(e,()=>j.current);const P=a.status==="loading"||a.status==="reloading",[S,R]=p.useState(!1),E=a.status==="refreshing",[C,w]=p.useState(!1),g=P||E||c==="connecting",T=p.useCallback(()=>{j.current&&(j.current.src=y.toString(),t({type:sn}))},[t,y]),A=p.useCallback(()=>{k(!0)},[]),[I,k]=p.useState(!1),[O,z]=p.useState(!1);p.useEffect(()=>{if(!(P||E)&&(c==="connecting"||c==="reconnecting")){const M=setTimeout(()=>{z(!0)},5e3);return()=>clearTimeout(M)}},[c,P,E]),p.useEffect(()=>{if(!(P||E||!O)){if(c==="connected"&&(w(!1),z(!1),R(!1),k(!1)),c==="connecting"){const M=setTimeout(()=>{R(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},Ut);return()=>clearTimeout(M)}if(c==="reconnecting"){const M=setTimeout(()=>{R(!0),w(!0)},Ut);return()=>clearTimeout(M)}}},[P,c,E,O]);const V=p.useCallback(()=>{t({type:nn})},[t]);p.useEffect(()=>{if(!j.current)return;const M=j.current;function re(){M===document.activeElement&&M.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))}return window.addEventListener("blur",re),()=>{window.removeEventListener("blur",re)}},[]);const H=p.useMemo(()=>(P||c==="connecting"&&a.status!=="refreshing")&&!I,[I,a.status,P,c]),F=p.useSyncExternalStore(p.useCallback(()=>()=>{},[]),()=>CSS.supports("(view-transition-name: test)")),q=p.useMemo(()=>[H?"background":"active",P?"reloading":"idle",F?"":u,O&&!I?"timedOut":""],[F,I,P,H,O,u]),[Z,te]=p.useState(u),[ne,ue]=p.useState(yt[u]);return p.useEffect(()=>{if(F&&u!==Z){const M=()=>{te(u),ue(yt[u])};!x&&"startViewTransition"in document&&typeof document.startViewTransition=="function"?document.startViewTransition(()=>Ir.flushSync(()=>M())):M()}},[F,x,Z,u]),o.jsx(zr,{transition:x?{duration:0}:void 0,children:o.jsxs(Jn,{children:[o.jsx(_,{}),o.jsx(ce,{flex:1,tone:"transparent",children:o.jsxs(Q,{align:"center",height:"fill",justify:"center",padding:(F?Z:u)==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:g?"wait":void 0},children:[o.jsx(an,{children:!C&&!P&&!E&&O&&!I?o.jsx(xt,{initial:"initial",animate:"animate",exit:"exit",variants:Gt,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:S?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:S?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:o.jsxs(Q,{style:{...ct[u]},justify:"center",align:"center",direction:"column",gap:4,children:[S&&o.jsx(ye,{disabled:!0,mode:"ghost",text:v("preview-frame.continue-button.text"),style:{opacity:0}}),o.jsx(ce,{radius:2,tone:S?"caution":"inherit",padding:4,shadow:1,children:o.jsxs(Q,{justify:"center",align:"center",direction:"column",gap:4,children:[o.jsx(st,{muted:!0}),o.jsx(W,{muted:!0,size:1,children:S?v("preview-frame.status",{context:"timeout"}):v("preview-frame.status",{context:"connecting"})})]})}),S&&o.jsx(ye,{tone:"critical",onClick:A,text:v("preview-frame.continue-button.text")})]})}):(P||c==="connecting"&&a.status!=="refreshing")&&!I?o.jsx(xt,{initial:"initial",animate:"animate",exit:"exit",variants:Gt,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:o.jsxs(Q,{style:{...ct[u]},justify:"center",align:"center",direction:"column",gap:4,children:[o.jsx(st,{muted:!0}),o.jsx(W,{muted:!0,size:1,children:v("preview-frame.status",{context:"loading"})})]})}):C&&!I?o.jsx(xt,{initial:"initial",animate:"animate",exit:"exit",variants:Ps,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute"},children:o.jsx(Ot,{flex:1,message:v("preview-frame.connection.error.text"),onRetry:T,onContinueAnyway:A,children:b&&o.jsxs(o.Fragment,{children:[c!=="connected"&&o.jsx(ce,{padding:3,radius:2,tone:"critical",children:o.jsxs(Se,{space:3,children:[o.jsx(at,{muted:!0,size:0,children:v("preview-frame.overlay.connection-status.label")}),o.jsx(ot,{size:1,children:v("channel.status",{context:c})})]})}),s!=="connected"&&o.jsx(ce,{padding:3,radius:2,tone:"critical",children:o.jsxs(Se,{space:3,children:[o.jsx(at,{muted:!0,size:0,children:v("preview-frame.loader.connection-status.label")}),o.jsx(ot,{size:1,children:v("channel.status",{context:s})})]})})]})})}):null}),o.jsx(cs,{animate:q,initial:["background"],onLoad:V,preventClick:H,ref:j,src:y.toString(),style:ne,variants:yt})]})})]})})}));In.displayName="Memo(ForwardRef(Preview))";const ct={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},Gt={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},Ps={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},yt={desktop:{...ct.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...ct.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};function Ss(n,e,t,a){const i=D.c(5),r=p.useRef(t),s=Rt(e);let c,l;i[0]!==s||i[1]!==a||i[2]!==n?(c=()=>{const u=r.current;if(r.current=n,n!==u)return s(n,u)},l=[s,a,n],i[0]=s,i[1]=a,i[2]=n,i[3]=c,i[4]=l):(c=i[3],l=i[4]),p.useEffect(c,l)}const _s=function(n){const e=D.c(4),{documentId:t,documentType:a,navigate:i,perspective:r,documentRevision:s}=n,c=Yn(t,a);let l;return e[0]!==s||e[1]!==c||e[2]!==i?(l=u=>{let m;if(u==="published"&&c.published){const{_updatedAt:d,_rev:h}=c.published;m=`${d}/${h}`}s!==m&&i({},{rev:m},!0)},e[0]=s,e[1]=c,e[2]=i,e[3]=l):l=e[3],Ss(r,l),null};function js(){let n=!1;return(...e)=>{n||(console.warn(...e),n=!0)}}const Es=js();function Cs(n,e){if(n!=="published"&&n!=="previewDrafts")throw new Error(`Invalid perspective: ${n}`);const[t,a]=p.useState({}),[i,r]=p.useState({}),s=p.useRef(""),c=p.useCallback((l,u,m=[])=>{const d=m.filter(h=>"_projectId"in h&&h._projectId?(Es("Cross dataset references are not supported yet, ignoring source document",h),!1):h);(u==="published"?a:r)(h=>{const f={};for(const v of d)f[v._id]=v;if(s.current!==e.current.url)return s.current=e.current.url,{[l]:f};const y=h[l];return Or(y,f)?h:{...h,[l]:f}})},[e]);return[p.useMemo(()=>{const l=Object.values(n==="published"?t:i).reduce((u,m)=>(Object.values(m).forEach(d=>{u[d._id]=d}),u),{});return Object.values(l)},[n,i,t]),c]}function $n(n,e){return n instanceof Function?n(e):n}function Rs(n,e){if(n.resolve){const t=n.resolve(e)?.filter;return t?`// groq
*[${t}][0]{_id, _type}`:void 0}return"type"in n?`// groq
*[_type == "${n.type}"][0]{_id, _type}`:`// groq
*[${$n(n.filter,e)}][0]{_id, _type}`}function Ts(n,e){return n.resolve?n.resolve(e)?.params??e.params:"type"in n?{}:$n(n.params,e)??e.params}function Is(n,e){const t=Array.isArray(n)?n:[n];for(n of t){let a,i=n;if(typeof n=="string")try{const r=new URL(n);a=r.origin,i=r.pathname}catch{}if(!(a&&e.origin!==a))try{const r=Xr(i,{decode:decodeURIComponent})(e.pathname);if(r){const{params:s,path:c}=r;return{origin:a,params:s,path:c}}}catch{throw new Error(`"${n}" is not a valid route pattern`)}}}function $s(n){const{navigate:e,navigationHistory:t,path:a,previewUrl:i,resolvers:r=[]}=n,{state:s}=_t(),c=Ye({apiVersion:lt}),l=a||s._searchParams?.find(([f])=>f==="preview")?.[1]||"",[u,m]=p.useState(void 0),d=p.useRef(void 0),h=Rt((f,y)=>{(!f||d.current!==f._id)&&(m({document:f,path:y.pathname}),d.current=f?._id,t.at(-1)?.id===t.at(-2)?.id&&e?.({id:f?._id,type:f?._type}))});return p.useEffect(()=>{const f=typeof i=="string"?i:typeof i=="object"&&i?.origin||location.origin,y=new URL(l,f);if(r.length){let v;for(const b of r){const x=Is(b.route,y);if(x){v={context:x,resolver:b};break}}if(v){const b=Rs(v.resolver,v.context),x=Ts(v.resolver,v.context);if(b){const j=new AbortController,_={perspective:"previewDrafts",signal:j.signal};return c.fetch(b,x,_).then(P=>h(P,y)).catch(P=>{P instanceof Error&&P.name==="AbortError"||(m({document:void 0,path:y.pathname}),d.current=void 0)}),()=>{j.abort()}}}}m(void 0),d.current=void 0},[c,h,i,l,r]),u}const As=mn(Tt(),fn(1));hn(As);const Ms=/^([\w-]+):(0|[1-9][0-9]*)$/,Ds=/^([\w-]+):([0-9]+),([0-9]+)$/,ks=/^([\w-]+):([\w-]+)$/;function Os(n){const e=[];for(const t of n.split(".")){const a=Ms.exec(t);if(a){e.push(a[1],Number(a[2]));continue}const i=Ds.exec(t);if(i){e.push(i[1],[Number(i[2]),Number(i[3])]);continue}const r=ks.exec(t);if(r){e.push(r[1],{_key:r[2]});continue}e.push(t)}return e}const Qt=mn(Tt(),fn(1));$r({origin:Qt,href:Qt,data:hn(Ar(Tt(),Mr()))});function Ls(n){if(n===void 0)return;const e=decodeURIComponent(n)?.split(".");return e[0]==="drafts"&&e.shift(),e.join(".")}function zs(n){if(n!==void 0)return gn.toString(Os(decodeURIComponent(n)))}function Us(n){return{id:Ls(n.id),path:zs(n.path),type:n.type}}function it(n){return Object.fromEntries(Object.entries(n).filter(([,e])=>e!==void 0&&e!==""&&e!==null))}function Ws({initialPreviewUrl:n,routerNavigate:e,routerState:t,routerSearchParams:a,frameStateRef:i}){const r=p.useMemo(()=>{const{id:d,path:h,type:f}=Us(t);return{id:d,type:f,path:h,preview:a.preview||`${n.pathname}${n.search}`,perspective:a.perspective,viewport:a.viewport,inspect:a.inspect,rev:a.rev,since:a.since,template:a.template,templateParams:a.templateParams,view:a.view,pathKey:a.pathKey,instruction:a.instruction,comment:a.comment,changesInspectorTab:a.changesInspectorTab}},[t,a,n]),s=p.useMemo(()=>it({inspect:r.inspect,path:r.path,rev:r.rev,since:r.since,template:r.template,templateParams:r.templateParams,view:r.view,pathKey:r.pathKey,instruction:r.instruction,comment:r.comment,changesInspectorTab:r.changesInspectorTab}),[r.changesInspectorTab,r.comment,r.inspect,r.instruction,r.path,r.pathKey,r.rev,r.since,r.template,r.templateParams,r.view]),c=p.useMemo(()=>it({perspective:r.perspective,preview:r.preview,viewport:r.viewport}),[r.perspective,r.preview,r.viewport]),l=p.useRef(t);p.useEffect(()=>{l.current=t},[t]);const[u,m]=p.useState([t]);return{navigate:p.useCallback((d,h={},f)=>{d.id&&(d.id=ut(d.id));const{_searchParams:y,...v}=l.current,b=(y||[]).reduce((P,[S,R])=>(P[S]=R,P),{}),x=it({...v,...d}),j=it({...b,...h});v.id!==x.id&&(delete j.template,delete j.templateParams),x._searchParams=Object.entries(j).reduce((P,[S,R])=>[...P,[S,R]],[]);const _=f??j.preview===i.current.url;m(P=>[...P,x]),e(x,{replace:_})},[e,i]),navigationHistory:u,params:r,searchParams:c,structureParams:s}}const Ns=n=>{const[e,t]=p.useState(()=>new Set),a=p.useCallback(i=>{const r=window.open(i,"_blank");r&&t(s=>new Set(s).add(r))},[]);return p.useEffect(()=>{const i=[];if(e.size&&n)for(const r of e)r&&"closed"in r&&!r.closed&&i.push(n.addTarget(r));return()=>{i.forEach(r=>r())}},[n,e]),p.useEffect(()=>{if(e.size){const i=setInterval(()=>{const r=new Set;for(const s of e)s&&"closed"in s&&s.closed&&r.add(s);r.size&&t(s=>{const c=new Set(s);for(const l of r)c.delete(l);return c})},Kn);return()=>{clearInterval(i)}}},[e]),{popups:e,open:a}};function Vs(n,e,t,a,i){const r=Ye({apiVersion:lt}),s=rn(),c=s?.activeWorkspace?.basePath||"/",l=s?.activeWorkspace?.name||"default",u=Bs(e,c,l,a),m=Ks(i&&typeof n=="object"||typeof n=="function",u);return Pn(async()=>{if(typeof n=="string"){const h=new URL(n,location.origin);let f=h;try{if(a){const y=new URL(a,h);y.origin===h.origin&&(f=y)}}catch{}return location.origin===f.origin&&(f.pathname.startsWith(`${c}/`)||f.pathname===c)?h:f}const d=await(typeof n=="object"?ri(n):n)({client:r,previewUrlSecret:m,studioPreviewPerspective:t,previewSearchParam:a,studioBasePath:c});return new URL(d,location.origin)},[...u,m])}const Fs=Symbol("sanity/presentation/resolveUUID");function Bs(n,e,t,a){const i=D.c(12);let r;i[0]!==a?(r=()=>a||"",i[0]=a,i[1]=r):r=i[1];const[s,c]=p.useState(r),l=p.useRef(0);let u,m;i[2]!==s||i[3]!==a?(u=()=>{if(s&&a)return window.clearTimeout(l.current),()=>{l.current=window.setTimeout(()=>{c("")},100)}},m=[s,a],i[2]=s,i[3]=a,i[4]=u,i[5]=m):(u=i[4],m=i[5]),p.useEffect(u,m);const d=Ct();let h;const f=d?.id;let y;return i[6]!==e||i[7]!==s||i[8]!==f||i[9]!==n||i[10]!==t?(y=["sanity/presentation",e,t,n,f,Fs,s],i[6]=e,i[7]=s,i[8]=f,i[9]=n,i[10]=t,i[11]=y):y=i[11],h=y,h}function Ks(n,e){const t=D.c(10);let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a={apiVersion:lt},t[0]=a):a=t[0];const i=Ye(a),r=Ct(),[s,c]=p.useState("");let l;t[1]!==i||t[2]!==r?.id||t[3]!==e||t[4]!==n||t[5]!==s?(l=n?Pn(async()=>await ni(i,"@sanity/presentation",typeof window>"u"?"":location.href,r?.id),[...e,s]):null,t[1]=i,t[2]=r?.id,t[3]=e,t[4]=n,t[5]=s,t[6]=l):l=t[6];const u=l;let m,d;return t[7]!==u?(m=()=>{if(!u)return;const h=setTimeout(()=>{p.startTransition(()=>c(u.expiresAt.toString()))},u.expiresAt.getTime()-Date.now());return()=>clearTimeout(h)},d=[u],t[7]=u,t[8]=m,t[9]=d):(m=t[8],d=t[9]),p.useEffect(m,d),u?.secret||null}function wt(){const n=D.c(4);let e;n[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,n[0]=e):e=n[0];const[t,a]=p.useState(e);let i;e:{const u=Array.from(t.values());if(u.find(Gs)){i="connected";break e}const m=u.filter(qs);if(m.length){i=m.some(Hs)?"connecting":"reconnecting";break e}i="idle"}const r=i;let s;n[1]===Symbol.for("react.memo_cache_sentinel")?(s=u=>{a(m=>{const d=new Map(m);if(u.status==="disconnected")d.delete(u.connection);else{const h=d.get(u.connection)?.hasConnected||u.status==="connected",f=u.status==="handshaking"?"connecting":u.status;d.set(u.connection,{status:f,hasConnected:h})}return d})},n[1]=s):s=n[1];const c=s;let l;return n[2]!==r?(l=[r,c],n[2]=r,n[3]=l):l=n[3],l}function Hs(n){const{hasConnected:e}=n;return!e}function qs(n){const{status:e}=n;return e==="connecting"}function Gs(n){const{status:e}=n;return e==="connected"}const Qs=p.lazy(()=>_e(()=>import("./LoaderQueries.Dc7dvkX7.js"),__vite__mapDeps([5,1,2,3,4,6,7])));p.lazy(()=>_e(()=>import("./LiveQueries.fFwg17p9.js"),__vite__mapDeps([8,1,2,3,4,6,7,9])));const Xs=p.lazy(()=>_e(()=>import("./PostMessageDocuments.CdqgjYa3.js"),__vite__mapDeps([10,3,1,2,4]))),Js=p.lazy(()=>_e(()=>import("./PostMessageRefreshMutations.BSnOSmsc.js"),__vite__mapDeps([11,1,2,3,4]))),Ys=p.lazy(()=>_e(()=>import("./PostMessagePerspective.BmX28SxA.js"),__vite__mapDeps([12,3,1,2,4]))),Zs=p.lazy(()=>_e(()=>import("./PostMessagePreviewSnapshots.DH0MHBFN.js"),__vite__mapDeps([13,2,3,1,4]))),ea=p.lazy(()=>_e(()=>import("./PostMessageSchema.DBDp9Pz0.js"),__vite__mapDeps([14,3,1,2,4]))),ta=p.lazy(()=>_e(()=>import("./PostMessageTelemetry.xZrYlMsL.js"),__vite__mapDeps([15,3,1,2,4]))),na=le(Q)`
  overflow-x: auto;
`;function ra(n){const{canCreateUrlPreviewSecrets:e,canToggleSharePreviewAccess:t,canUseSharedPreviewAccess:a,tool:i,vercelProtectionBypass:r}=n,s=i.options?.components,c=i.options?.previewUrl,l=i.name||kn,{unstable_navigator:u,unstable_header:m}=s||{},{navigate:d,state:h}=_t(),f=tn(Object.fromEntries(h._searchParams||[])),y=Vs(c||"/",l,f.perspective==="published"?"published":"previewDrafts",f.preview||null,e),v=p.useMemo(()=>c&&typeof c=="object"&&"draftMode"in c&&c.draftMode?(console.warn("previewUrl.draftMode is deprecated, use previewUrl.previewMode instead"),c.draftMode.shareAccess!==!1):c&&typeof c=="object"&&"previewMode"in c&&c.previewMode?c.previewMode.shareAccess!==!1:!1,[c]),[b]=p.useState(()=>{const $=i.options?.devMode;return typeof $=="function"?$():typeof $=="boolean"?$:typeof window<"u"&&window.location.hostname==="localhost"}),x=p.useMemo(()=>y.origin,[y.origin]),j=p.useRef(null),[_,P]=p.useState(),[S,R]=p.useState(null),E=p.useRef({title:void 0,url:void 0}),{navigate:C,navigationHistory:w,params:g,searchParams:T,structureParams:A}=Ws({initialPreviewUrl:y,routerNavigate:d,routerState:h,routerSearchParams:f,frameStateRef:E}),I=p.useMemo(()=>Sn(C,50),[C]),[k,O]=p.useReducer(On,{},Ln),z=p.useMemo(()=>g.perspective?"published":"previewDrafts",[g.perspective]),V=p.useMemo(()=>g.viewport?"mobile":"desktop",[g.viewport]),[H,F]=Cs(z,E),q=zn(),Z=Un(),te=$s({navigate:C,navigationHistory:w,path:g.preview,previewUrl:i.options?.previewUrl,resolvers:i.options?.resolve?.mainDocuments}),[ne,ue]=wt(),[M,re]=wt(),[ie,ae]=wt(),{open:B}=Ns(_),K=k.iframe.status==="loading";p.useEffect(()=>{const $=j.current?.contentWindow;if(!$||K)return;const U=Dr({targetOrigin:x});return U.addTarget($),P(U),()=>{U.destroy(),P(void 0)}},[x,K]);const N=Rt(($,U,L)=>I($,U,L));p.useEffect(()=>{if(!_)return;const $=_.createChannel({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},Nt().provide({actors:Vt()}));$.on("visual-editing/focus",L=>{"id"in L&&N({type:L.type,id:L.id,path:L.path})}),$.on("visual-editing/navigate",L=>{const{title:Ge,url:he}=L;if(E.current.url!==he)try{const[Ae,Re]=he.split("?"),Te=new URLSearchParams(Re);Te.delete(Xe),Te.delete(Mt),N({},{preview:`${Ae}${Te.size>0?"?":""}${Te}`})}catch{N({},{preview:he})}E.current={title:Ge,url:he}}),$.on("visual-editing/meta",L=>{E.current.title=L.title}),$.on("visual-editing/toggle",L=>{O({type:Wn,enabled:L.enabled})}),$.on("visual-editing/documents",L=>{F("visual-editing",L.perspective,L.documents)}),$.on("visual-editing/refreshing",L=>{L.source==="manual"?clearTimeout(fe.current):L.source==="mutation"&&O({type:zt})}),$.on("visual-editing/refreshed",()=>{O({type:nn})}),$.onStatus(ue);const U=$.start();return R($),()=>{U(),R(null)}},[_,N,F,ue,x]),p.useEffect(()=>{if(!_)return;const $=_.createChannel({name:"presentation",connectTo:"preview-kit",heartbeat:!0},Nt().provide({actors:Vt()}));return $.onStatus(ae),$.on("preview-kit/documents",U=>{U.projectId===q&&U.dataset===Z&&F("preview-kit",U.perspective,U.documents)}),$.start()},[_,Z,q,F,ae,x]);const G=p.useCallback($=>{I({path:gn.toString($)},{},!0)},[I]),oe=p.useCallback($=>{const U=new URL($,y.origin),L=U.pathname+U.search;U.origin===y.origin&&L!==g.preview&&I({},{preview:L})},[y,g,I]),Y=p.useCallback($=>{I({},$)},[I]);p.useEffect(()=>{g.id&&g.path?S?.post("presentation/focus",{id:g.id,path:g.path}):S?.post("presentation/blur")},[g.id,g.path,S]),p.useEffect(()=>{E.current.url&&g.preview&&E.current.url!==g.preview&&(E.current.url=g.preview,ne!=="connected"&&j.current?j.current.src=`${x}${g.preview}`:S?.post("presentation/navigate",{url:g.preview,type:"replace"}))},[ne,x,g.preview,S]);const X=p.useCallback(()=>S?.post("presentation/toggle-overlay"),[S]),[J,se]=p.useState(null);p.useEffect(()=>{const $=L=>{Xt(L)&&X()},U=L=>{Xt(L)&&X(),sa(["mod","\\"],L)&&X()};return window.addEventListener("keydown",U),window.addEventListener("keyup",$),()=>{window.removeEventListener("keydown",U),window.removeEventListener("keyup",$)}},[X]);const[de,ge]=p.useState(null),[{navigatorEnabled:pe,toggleNavigator:ve},me]=es({unstable_navigator:u}),xe=p.useRef(g.id);p.useEffect(()=>{g.rev&&xe.current&&g.id!==xe.current&&I({},{rev:void 0}),xe.current=g.id});const fe=p.useRef(void 0),qe=p.useCallback($=>{if(O({type:zt}),S){fe.current=window.setTimeout($,300),S.post("presentation/refresh",{source:"manual",livePreviewEnabled:ie==="connected"||M==="connected"});return}$()},[M,ie,S]),Pe=Nn(),je=p.useCallback(({id:$,type:U,path:L})=>{if(E.current.url)return{title:E.current.title||E.current.url,name:"edit",params:{id:$,path:L,type:U,inspect:Fn,workspace:Pe.name,mode:Vn,preview:g.preview}}},[g.preview,Pe.name]),Ee=p.useCallback($=>{I({},{viewport:$==="desktop"?void 0:"mobile"},!0)},[I]),Ce=p.useCallback($=>{I({},{perspective:$==="previewDrafts"?void 0:$})},[I]);return o.jsxs(o.Fragment,{children:[o.jsx(ss,{devMode:b,name:l,navigate:I,params:g,searchParams:T,structureParams:A,children:o.jsx(Yi,{navigate:I,children:o.jsx(is,{params:g,children:o.jsx(di,{comlink:S,children:o.jsx(na,{height:"fill",children:o.jsxs(Pi,{children:[o.jsx(me,{}),o.jsx(kt,{id:"preview",minWidth:325,defaultSize:pe?50:75,order:3,children:o.jsx(Q,{direction:"column",flex:1,height:"fill",ref:ge,children:o.jsx(Bn,{element:de,children:o.jsx(In,{canSharePreviewAccess:v,canToggleSharePreviewAccess:t,canUseSharedPreviewAccess:a,dispatch:O,header:m,iframe:k.iframe,initialUrl:y,loadersConnection:M,navigatorEnabled:pe,onPathChange:oe,onRefresh:qe,openPopup:B,overlaysConnection:ne,previewUrl:g.preview,perspective:z,ref:j,setPerspective:Ce,setViewport:Ee,targetOrigin:x,toggleNavigator:ve,toggleOverlay:X,viewport:V,visualEditing:k.visualEditing,vercelProtectionBypass:r},x)})})}),o.jsx(Ji,{documentId:g.id,documentsOnPage:H,documentType:g.type,getCommentIntent:je,mainDocumentState:te,onFocusPath:G,onStructureParams:Y,searchParams:T,setDisplayedDocument:se,structureParams:A})]})})})})})}),o.jsxs(p.Suspense,{children:[_&&o.jsx(Qs,{controller:_,perspective:z,liveDocument:J,onDocumentsOnPage:F,onLoadersConnection:re,documentsOnPage:H}),S&&g.id&&g.type&&o.jsx(Js,{comlink:S,id:g.id,type:g.type,loadersConnection:M,previewKitConnection:ie}),S&&o.jsx(ea,{comlink:S,perspective:z}),S&&H.length>0&&o.jsx(Zs,{comlink:S,perspective:z,refs:H}),S&&o.jsx(Xs,{comlink:S}),S&&o.jsx(li,{comlink:S}),S&&o.jsx(Ys,{comlink:S,perspective:z}),S&&o.jsx(ta,{comlink:S}),g.id&&g.type&&o.jsx(_s,{documentId:g.id,documentRevision:g.rev,documentType:g.type,navigate:I,perspective:z})]})]})}function Xt(n){return n.key==="Alt"}const ia=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Jt={alt:"altKey",ctrl:"ctrlKey",mod:ia?"metaKey":"ctrlKey",shift:"shiftKey"};function sa(n,e){return n.every(t=>Jt[t]?e[Jt[t]]:e.key===t.toUpperCase())}function aa(){const n=D.c(7);let e;n[0]===Symbol.for("react.memo_cache_sentinel")?(e={apiVersion:pt},n[0]=e):e=n[0];const t=Ye(e),[a,i]=p.useReducer(oa,"loading"),[r,s]=p.useState(null);let c,l;n[1]!==t?(c=()=>{const m=oi(t,d=>{s(d),i()});return()=>m()},l=[t],n[1]=t,n[2]=c,n[3]=l):(c=n[2],l=n[3]),p.useEffect(c,l);let u;return n[4]!==a||n[5]!==r?(u=[r,a],n[4]=a,n[5]=r,n[6]=u):u=n[6],u}function oa(){return"ready"}function fa(n){const e=D.c(17),{t}=we(be),{previewUrl:a}=n.tool.options??{},{push:i}=Zt(),r=typeof a=="object"||typeof a=="function",s=Dn(),[c,l]=p.useState(null),[u,m]=p.useState(null),[d,h]=p.useState(null),[f,y]=p.useState(null);let v,b;e[0]!==s||e[1]!==r?(v=()=>{if(!r)return;const g=s.checkDocumentPermission("create",{_id:$e,_type:He}).subscribe(l),T=s.checkDocumentPermission("update",{_id:$e,_type:He}).subscribe(m),A=s.checkDocumentPermission("read",{_id:$e,_type:He}).subscribe(h),I=s.checkDocumentPermission("create",{_id:`drafts.${Yt()}`,_type:It}).subscribe(y);return()=>{g.unsubscribe(),T.unsubscribe(),A.unsubscribe(),I.unsubscribe()}},b=[s,r],e[0]=s,e[1]=r,e[2]=v,e[3]=b):(v=e[2],b=e[3]),p.useEffect(v,b);const x=f?.granted;let j,_;e[4]!==x||e[5]!==i||e[6]!==t||e[7]!==r?(j=()=>{if(!r||x!==!1)return;const g=requestAnimationFrame(()=>i({closable:!0,status:"error",duration:3e4,title:t("preview-url-secret.missing-grants")}));return()=>cancelAnimationFrame(g)},_=[x,i,t,r],e[4]=x,e[5]=i,e[6]=t,e[7]=r,e[8]=j,e[9]=_):(j=e[8],_=e[9]),p.useEffect(j,_);const[P,S]=aa();if(S==="loading"||r&&(!c||typeof c.granted>"u"||!u||typeof u.granted>"u"||!f||!d||typeof d.granted>"u"||typeof f.granted>"u")){let g;return e[10]===Symbol.for("react.memo_cache_sentinel")?(g=o.jsx(en,{}),e[10]=g):g=e[10],g}const R=x===!0,E=c?.granted===!0&&u?.granted===!0,C=d?.granted===!0;let w;return e[11]!==n||e[12]!==R||e[13]!==E||e[14]!==C||e[15]!==P?(w=o.jsx(ra,{...n,vercelProtectionBypass:P,canCreateUrlPreviewSecrets:R,canToggleSharePreviewAccess:E,canUseSharedPreviewAccess:C}),e[11]=n,e[12]=R,e[13]=E,e[14]=C,e[15]=P,e[16]=w):w=e[16],w}export{fa as default};
